<!DOCTYPE html>
<html class=" js csstransforms3d csstransitions" style="min-height: 100%;" lang="en-US"><head>
<meta charset="UTF-8">
<title>Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)</title><link rel="stylesheet" href="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a4a07bcc56c2e555d78654a8d8e6f5f0.css" media="all" data-minify="1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">
<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">



<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

	<!-- This site is optimized with the Yoast SEO plugin v17.1 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)</title>
	<link rel="canonical" href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)">
	<meta property="og:description" content="Develop a Deep Learning Model to Automatically Classify Movie Reviews as Positive or Negative in Python with Keras, Step-by-Step. Word […]">
	<meta property="og:url" content="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/">
	<meta property="og:site_name" content="Machine Learning Mastery">
	<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:author" content="https://www.facebook.com/MachineLearningMastery/">
	<meta property="article:published_time" content="2017-10-29T18:00:39+00:00">
	<meta property="article:modified_time" content="2020-09-02T23:13:45+00:00">
	<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/10/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-Review-Sentiment.jpg">
	<meta property="og:image:width" content="800">
	<meta property="og:image:height" content="537">
	<meta name="twitter:label1" content="Written by">
	<meta name="twitter:data1" content="Jason Brownlee">
	<meta name="twitter:label2" content="Est. reading time">
	<meta name="twitter:data2" content="41 minutes">
	<script id="twitter-wjs" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/widgets.js"></script><script id="twitcount_plugins" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/twitcount.js"></script><script src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/fbpix-config-834324500844861-2.js" async=""></script><script async="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/fbpix-events-en_US-2.js"></script><script type="text/javascript" async="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/client.js"></script><script type="text/javascript" async="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9556588.js"></script><script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://machinelearningmastery.com/?s={search_term_string}"},"query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#primaryimage","inLanguage":"en-US","url":"https://machinelearningmastery.com/wp-content/uploads/2017/10/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-Review-Sentiment.jpg","contentUrl":"https://machinelearningmastery.com/wp-content/uploads/2017/10/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-Review-Sentiment.jpg","width":800,"height":537,"caption":"How to Develop a Word Embedding Model for Predicting Movie Review Sentiment Photo by Katrina Br*?#*!@nd, some rights reserved."},{"@type":"WebPage","@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#webpage","url":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/","name":"Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#primaryimage"},"datePublished":"2017-10-29T18:00:39+00:00","dateModified":"2020-09-02T23:13:45+00:00","breadcrumb":{"@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/"]}]},{"@type":"BreadcrumbList","@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https://machinelearningmastery.com/"},{"@type":"ListItem","position":2,"name":"Blog","item":"https://machinelearningmastery.com/blog/"},{"@type":"ListItem","position":3,"name":"Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)"}]},{"@type":"Article","@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#article","isPartOf":{"@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)","datePublished":"2017-10-29T18:00:39+00:00","dateModified":"2020-09-02T23:13:45+00:00","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#webpage"},"wordCount":4261,"commentCount":248,"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#primaryimage"},"thumbnailUrl":"https://machinelearningmastery.com/wp-content/uploads/2017/10/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-Review-Sentiment.jpg","articleSection":["Deep Learning for Natural Language Processing"],"inLanguage":"en-US","potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#respond"]}]},{"@type":"Person","@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/a0942b56b07831ac15d4a168a750e34a?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["http://MachineLearningMastery.com","https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/teachthemachine"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://cdn.jsdelivr.net/">
<link rel="dns-prefetch" href="https://ads.adthrive.com/">
<link rel="dns-prefetch" href="https://www.google-analytics.com/">
<link rel="dns-prefetch" href="https://loadeu.exelator.com/">
<link rel="dns-prefetch" href="https://sync.crwdcntrl.net/">
<link rel="dns-prefetch" href="https://gdpr-wrapper.privacymanager.io/">
<link rel="dns-prefetch" href="https://securepubads.g.doubleclick.net/">
<link rel="dns-prefetch" href="https://gdpr.privacymanager.io/">
<link rel="dns-prefetch" href="https://sb.scorecardresearch.com/">
<link rel="dns-prefetch" href="https://confiant-integrations.global.ssl.fastly.net/">

<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Deep Convolutional Neural Network for Sentiment Analysis (Text Classification) Comments Feed" href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/feed/">
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	











<!--[if lt IE 9]>
<link href="https://machinelearningmastery.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/jquery.js" id="jquery-core-js" defer="defer"></script>



<script type="text/javascript" id="ssb-front-js-js-extra">
/* <![CDATA[ */
var SSB = {"ajax_url":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","fb_share_nonce":"aceb8047ef"};
/* ]]> */
</script>




<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/"><link rel="alternate" type="application/json" href="https://machinelearningmastery.com/wp-json/wp/v2/posts/4401"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://machinelearningmastery.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=4401">
<style type="text/css">.crp_title {
    font-size: medium;
}
.group.portfolio-img img {
    height: auto;
    padding: 3px;
	  border: 0px solid #fff;
    background: rgba(255,255,255,.7);
}
.crp_related ul li {
    background: #fff;
    padding: 3px;
    margin: 0 0 1em;
    width: 100%;
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    box-shadow: 0 0px 0px 0 rgb(0 0 0 / 18%);
    border-radius: 3px;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border: 0px solid #fff;
    animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -webkit-animation: wzslideup .8s ease-out,wzfadein 1s ease-out;
    -moz-animation: wzslideup .8s ease-out,wzfadein 1s ease;
    font-size: 1em;
    text-align: center;
    display: inline-block;
}</style>    <style type="text/css">

      .mpcs-classroom .nav-back i,
      .mpcs-classroom .navbar-section a.btn,
      .mpcs-classroom .navbar-section a,
      .mpcs-classroom .navbar-section button {
        color: rgba(255, 255, 255) !important;
      }

      .mpcs-classroom .navbar-section .dropdown .menu a {
        color: rgba(44, 54, 55) !important;
      }

      .mpcs-classroom .mpcs-progress-ring {
        background-color: rgba(29, 166, 154) !important;
      }

      .mpcs-classroom .mpcs-course-filter .dropdown .btn span,
      .mpcs-classroom .mpcs-course-filter .dropdown .btn i,
      .mpcs-classroom .mpcs-course-filter .input-group .input-group-btn,
      .mpcs-classroom .mpcs-course-filter .input-group .mpcs-search,
      .mpcs-classroom .mpcs-course-filter .input-group input[type=text],
      .mpcs-classroom .mpcs-course-filter .dropdown a,
      .mpcs-classroom .pagination,
      .mpcs-classroom .pagination i,
      .mpcs-classroom .pagination a {
        color: rgba(44, 54, 55) !important;
        border-color: rgba(44, 54, 55) !important;
      }

      /* body.mpcs-classroom a{
        color: rgba();
      } */

      #mpcs-navbar,
      #mpcs-navbar button#previous_lesson_link,
      #mpcs-navbar button#previous_lesson_link:hover {
        background: rgba(44, 54, 55);
      }

      .course-progress .user-progress,
      .btn-green,
      #mpcs-navbar button:not(#previous_lesson_link){
        background: rgba(29, 166, 154, 0.9);
      }

      .btn-green:hover,
      #mpcs-navbar button:not(#previous_lesson_link):focus,
      #mpcs-navbar button:not(#previous_lesson_link):hover{
        background: rgba(29, 166, 154);
      }

      .btn-green{border: rgba(29, 166, 154)}

      .course-progress .progress-text,
      .mpcs-lesson i.mpcs-circle-regular {
        color: rgba(29, 166, 154)
      }

      #mpcs-main #bookmark, .mpcs-lesson.current{background: rgba(29, 166, 154, 0.3)}

      .mpcs-instructor .tile-subtitle{
        color: rgba(29, 166, 154, 1)
      }

    </style>
     <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>

<!-- Open Graph Meta Tags generated by Simple Social Buttons 3.2.3 -->
<meta property="og:title" content="Deep Convolutional Neural Network for Sentiment Analysis (Text Classification) - Machine Learning Mastery">
<meta property="og:description" content="Develop a Deep Learning Model to Automatically Classify Movie Reviews
as Positive or Negative in Python with Keras, Step-by-Step.
Word embeddings are a technique for representing text where different words with similar meaning have a similar real-valued vector representation.

They are a key breakthrough that has led to great performance of neural network models on a suite of challenging natural language processing problems.

In">
<meta property="og:url" content="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="og:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/10/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-Review-Sentiment.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:description" content="Develop a Deep Learning Model to Automatically Classify Movie Reviews
as Positive or Negative in Python with Keras, Step-by-Step.
Word embeddings are a technique for representing text where different words with similar meaning have a similar real-valued vector representation.

They are a key breakthrough that has led to great performance of neural network models on a suite of challenging natural language processing problems.

In">
<meta name="twitter:title" content="Deep Convolutional Neural Network for Sentiment Analysis (Text Classification) - Machine Learning Mastery">
<meta property="twitter:image" content="https://machinelearningmastery.com/wp-content/uploads/2017/10/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-Review-Sentiment.jpg">
    
<style id="wplmi-inline-css" type="text/css"> span.wplmi-user-avatar { width: 16px;display: inline-block !important;flex-shrink: 0; } img.wplmi-elementor-avatar { border-radius: 100%;margin-right: 3px; } 

</style>

<link rel="preload" as="font" href="https://machinelearningmastery.com/wp-content/themes/canvas-new/includes/fonts/fontawesome-webfont.woff2?v=4.5.0" crossorigin="">
<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://machinelearningmastery.com/wp-content/uploads/2019/09/icon-16x16.png">
<!-- Options Panel Custom CSS -->
<style type="text/css">
#logo img {
   max-width: 100%;
   height: auto;
}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->


<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">



<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://machinelearningmastery.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<noscript><style id="rocket-lazyload-nojs-css">.rll-youtube-player, [data-lazy-src]{display:none !important;}</style></noscript>	<!-- Facebook Pixel Code -->
<script type="text/javascript">
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://machinelearningmastery.com/wp-content/cache/busting/facebook-tracking/fbpix-events-en_US-2.9.5.js');
fbq('init', '834324500844861');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=834324500844861&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->
	
	
	
	
<style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 .drip-submit-button:disabled {
    background-color: #808080 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field,
  #drip-2211 .drip-radio-buttons,
  #drip-2211 .drip-dropdown-select {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt.label-for-type-text,
  .drip-tab dl.no-labels dt.label-for-type-dropdown,
  .drip-tab dl.no-labels dt.label-for-type-email {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-lightbox input {
    box-sizing: border-box;
  }

  .drip-tab .drip-date-field,
  .drip-tab .drip-text-field {
    margin: 0 !important;
    height: 34px !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field,
  .drip-tab .drip-dropdown-select select {
    padding: 6px !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors:not(:empty) {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  /* RADIOS */

  .drip-tab .drip-radio-buttons,
  .drip-tab .drip-radio-buttons * {
    box-sizing: border-box;
  }
  .drip-tab .drip-radio-buttons h4 {
    font-family: inherit;
    font-weight: bold;
    font-size: 15px;
    margin: 0 0 3px;
    padding: 0;
  }

  .drip-tab .drip-radio-button {
    width: 100%;
    display: block;
    position: relative;
    margin-bottom: 6px;
  }

  .drip-tab .drip-radio-button input[type="radio"] {
    height: 0;
    width: 0;
    opacity: 0;
    position: absolute;
    top: 0;
    left: 0;
    display: inline-block;
    border: none;
    padding: 0;
    margin: 0;
  }

  .drip-tab .drip-radio-button label {
    font-size: 15px;
    padding-left: 30px;
    color: #262626;
    white-space: normal;
    word-break: normal;
    cursor: pointer;
  }

  .drip-tab .drip-radio-button label:before {
    content: "";
    display: block;
    background: #f5f5f5;
    width: 18px;
    height: 18px;
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
    border-radius: 9px;
    border: 1px solid #cccccc;
    box-sizing: border-box;
    padding: 1px;
    transition: background 300ms ease-out, border-color 300ms, border-width 300ms ease-in;
  }
  .drip-tab .drip-radio-button label:hover:before {
    border-color: #000000;
  }

  .drip-tab .drip-radio-button input[type="radio"]:checked ~ label:before {
    background-color: #ffffff;
    border: 5px solid #000000;
  }

  /* DROPDOWNS */

  /* stylelint-disable */

.drip-tab .drip-dropdown-select h4 {
  font-family: inherit;
  font-weight: bold;
  font-size: 15px;
  margin: 0 0 3px;
  padding: 0;
}

.drip-tab .drip-dropdown-select select {
  display: block;
  box-shadow: none;
  position: relative;
  border: 1px solid #A8ACB9;
  outline: none;
  border-radius: 3px;
  line-height: inherit;
  font-family: inherit;
  color: #262626;
  transition: border-color 300ms;
  width: 100%;
  max-width: 100%; /* useful when width is set to anything other than 100% */
  box-sizing: border-box;

  -moz-appearance: none;
  -webkit-appearance: none;
  appearance: none;
  background-color: #fff;
  /* note: bg image below uses 2 urls. The first is an svg data uri for the arrow
    icon, and the second is the gradient. for the icon, if you want to change the
    color, be sure to use `%23` instead of `#`, since it's a url. You can also
    swap in a different svg icon or an external image reference
  */
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23262626%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%, #ffffff 100%);
  background-repeat: no-repeat, repeat;
  /* arrow icon position (1em from the right, 50% vertical) , then gradient position*/
  background-position: right 12px top 50%, 0 0;
  /* icon size, then gradient */
  background-size: 12px auto, 100%;
}

/* Hide arrow icon in IE browsers */
.drip-tab .drip-dropdown-select select::-ms-expand {
  display: none;
}

/* Hover style */
.drip-tab .drip-dropdown-select select:hover {
  border-color: #888;
}

/* Focus style */
.drip-tab .drip-dropdown-select select:focus {
  border-color: #A8ACB9;
  /* It'd be nice to use -webkit-focus-ring-color here but it doesn't work on box-shadow */
  /* box-shadow: 0 0 1px 3px rgba(59, 153, 252, .7);
  box-shadow: 0 0 0 3px -moz-mac-focusring;
  color: #222; */
  outline: none;
}

/* Set options to normal weight */
.drip-tab .drip-dropdown-select select option {
  font-weight:normal;
}

/* Support for rtl text, explicit support for Arabic and Hebrew */
*[dir="rtl"] .drip-tab .drip-dropdown-select select,
:root:lang(ar) .drip-tab .drip-dropdown-select select,
:root:lang(iw) .drip-tab .drip-dropdown-select select {
  background-position: left 12px top 50%, 0 0;
  padding: .6em .8em .5em 1.4em;
}

/* Disabled styles */
.drip-tab .drip-dropdown-select select:disabled,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  color: graytext;
  background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22graytext%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'),
    linear-gradient(to bottom, #ffffff 0%,#e5e5e5 100%);
}
.drip-tab .drip-dropdown-select select:disabled:hover,
.drip-tab .drip-dropdown-select select[aria-disabled=true] {
  border-color: #aaa;
}

/* stylelint-enable */


  /* SUBMIT BUTTON */

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* telephone input */
  /* stylelint-disable */

.drip-tab .iti + .zenput--checkbox {
  margin-top: 10px;
}

.drip-tab .iti {
  position: relative;
  display: block;
}

.drip-tab .iti * {
  box-sizing: border-box;
  -moz-box-sizing: border-box;
}

.drip-tab .iti__hide {
  display: none;
}

.drip-tab .iti__v-hide {
  visibility: hidden;
}

.drip-tab .iti input,
.drip-tab .iti input[type=text],
.drip-tab .iti input[type=tel] {
  position: relative;
  z-index: 0;
  width: 100%;
  padding: 0 0 0 36px;
  margin: 0 !important;
}

  .drip-tab .iti input,
  .drip-tab .iti input[type=text],
  .drip-tab .iti input[type=tel] {
    height: 34px;
    border: 1px solid #c4c4c4 !important;
    border-radius: 4px !important;
    box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.18) !important;
  }

.drip-tab .iti__flag-container {
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  padding: 1px;
}

.drip-tab .iti__selected-flag {
  z-index: 1;
  position: relative;
  display: flex;
  align-items: center;
  height: 100%;
  padding: 0 6px 0 8px;
}

.drip-tab .iti__arrow {
  margin-left: 6px;
  width: 0;
  height: 0;
  border-left: 3px solid transparent;
  border-right: 3px solid transparent;
  border-top: 4px solid #555;
}

.drip-tab .iti__arrow--up {
  border-top: none;
  border-bottom: 4px solid #555;
}

.drip-tab .iti__country-list {
  position: absolute;
  z-index: 2;
  list-style: none;
  text-align: left;
  padding: 0;
  margin: 0 0 0 -1px;
  box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.2);
  background-color: white;
  border: 1px solid #CCC;
  white-space: nowrap;
  max-height: 200px;
  width: 320px;
  overflow-y: scroll;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}

.drip-tab .iti__country-list--dropup {
  bottom: 100%;
  margin-bottom: -1px;
}

@media (max-width: 500px) {
  .drip-tab .iti__country-list {
    white-space: normal;
  }
}

.drip-tab .iti__flag-box {
  display: inline-block;
  width: 20px;
}

.drip-tab .iti__divider {
  padding-bottom: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid #CCC;
}

.drip-tab .iti__country {
  padding: 5px 10px;
  outline: none;
}

.drip-tab .iti__dial-code {
  color: #999;
}

.drip-tab .iti__country.iti__highlight {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name,
.drip-tab .iti__dial-code {
  vertical-align: middle;
}

.drip-tab .iti__flag-box,
.drip-tab .iti__country-name {
  margin-right: 6px;
}

.drip-tab .iti--allow-dropdown input,
.drip-tab .iti--allow-dropdown input[type=text],
.drip-tab .iti--allow-dropdown input[type=tel],
.drip-tab .iti--separate-dial-code input,
.drip-tab .iti--separate-dial-code input[type=text],
.drip-tab .iti--separate-dial-code input[type=tel] {
  padding-right: 6px;
  padding-left: 52px;
  margin-left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container,
.drip-tab .iti--separate-dial-code .iti__flag-container {
  right: auto;
  left: 0;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover {
  cursor: pointer;
}

.drip-tab .iti--allow-dropdown .iti__flag-container:hover .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover {
  cursor: default;
}

.drip-tab .iti--allow-dropdown input[disabled]+.iti__flag-container:hover .iti__selected-flag,
.drip-tab .iti--allow-dropdown input[readonly]+.iti__flag-container:hover .iti__selected-flag {
  background-color: transparent;
}

.drip-tab .iti--separate-dial-code .iti__selected-flag {
  background-color: rgba(0, 0, 0, 0.05);
}

.drip-tab .iti--separate-dial-code .iti__selected-dial-code {
  margin-left: 6px;
}

.drip-tab .iti--container {
  position: absolute;
  top: -1000px;
  left: -1000px;
  z-index: 1060;
  padding: 1px;
}

.drip-tab .iti--container:hover {
  cursor: pointer;
}

.iti-mobile .drip-tab  .iti--container {
  top: 30px;
  bottom: 30px;
  left: 30px;
  right: 30px;
  position: fixed;
}

.iti-mobile .drip-tab .iti__country-list {
  max-height: 100%;
  width: 100%;
}

.iti-mobile .drip-tab .iti__country {
  padding: 10px 10px;
  line-height: 1.5em;
}

.drip-tab .sms-subtext {
  margin-top: .75em;
  font-size: .75em;
  line-height: 1.4;
  display: inline-block;
}

.drip-tab .sms-subtext a {
  text-decoration: underline;
  cursor: pointer;
}

.drip-tab .iti__flag {
  width: 20px;
}

.drip-tab .iti__flag.iti__be {
  width: 18px;
}

.drip-tab .iti__flag.iti__ch {
  width: 15px;
}

.drip-tab .iti__flag.iti__mc {
  width: 19px;
}

.drip-tab .iti__flag.iti__ne {
  width: 18px;
}

.drip-tab .iti__flag.iti__np {
  width: 13px;
}

.drip-tab .iti__flag.iti__va {
  width: 15px;
}

@media (-webkit-min-device-pixel-ratio: 2),
(min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-size: 5652px 15px;
  }
}

.drip-tab .iti__flag.iti__ac {
    height: 10px;
    background-position: 0px 0px;
  }

.drip-tab .iti__flag.iti__ad {
    height: 14px;
    background-position: -22px 0px;
  }

.drip-tab .iti__flag.iti__ae {
    height: 10px;
    background-position: -44px 0px;
  }

.drip-tab .iti__flag.iti__af {
    height: 14px;
    background-position: -66px 0px;
  }

.drip-tab .iti__flag.iti__ag {
    height: 14px;
    background-position: -88px 0px;
  }

.drip-tab .iti__flag.iti__ai {
    height: 10px;
    background-position: -110px 0px;
  }

.drip-tab .iti__flag.iti__al {
    height: 15px;
    background-position: -132px 0px;
  }

.drip-tab .iti__flag.iti__am {
    height: 10px;
    background-position: -154px 0px;
  }

.drip-tab .iti__flag.iti__ao {
    height: 14px;
    background-position: -176px 0px;
  }

.drip-tab .iti__flag.iti__aq {
    height: 14px;
    background-position: -198px 0px;
  }

.drip-tab .iti__flag.iti__ar {
    height: 13px;
    background-position: -220px 0px;
  }

.drip-tab .iti__flag.iti__as {
    height: 10px;
    background-position: -242px 0px;
  }

.drip-tab .iti__flag.iti__at {
    height: 14px;
    background-position: -264px 0px;
  }

.drip-tab .iti__flag.iti__au {
    height: 10px;
    background-position: -286px 0px;
  }

.drip-tab .iti__flag.iti__aw {
    height: 14px;
    background-position: -308px 0px;
  }

.drip-tab .iti__flag.iti__ax {
    height: 13px;
    background-position: -330px 0px;
  }

.drip-tab .iti__flag.iti__az {
    height: 10px;
    background-position: -352px 0px;
  }

.drip-tab .iti__flag.iti__ba {
    height: 10px;
    background-position: -374px 0px;
  }

.drip-tab .iti__flag.iti__bb {
    height: 14px;
    background-position: -396px 0px;
  }

.drip-tab .iti__flag.iti__bd {
    height: 12px;
    background-position: -418px 0px;
  }

.drip-tab .iti__flag.iti__be {
    height: 15px;
    background-position: -440px 0px;
  }

.drip-tab .iti__flag.iti__bf {
    height: 14px;
    background-position: -460px 0px;
  }

.drip-tab .iti__flag.iti__bg {
    height: 12px;
    background-position: -482px 0px;
  }

.drip-tab .iti__flag.iti__bh {
    height: 12px;
    background-position: -504px 0px;
  }

.drip-tab .iti__flag.iti__bi {
    height: 12px;
    background-position: -526px 0px;
  }

.drip-tab .iti__flag.iti__bj {
    height: 14px;
    background-position: -548px 0px;
  }

.drip-tab .iti__flag.iti__bl {
    height: 14px;
    background-position: -570px 0px;
  }

.drip-tab .iti__flag.iti__bm {
    height: 10px;
    background-position: -592px 0px;
  }

.drip-tab .iti__flag.iti__bn {
    height: 10px;
    background-position: -614px 0px;
  }

.drip-tab .iti__flag.iti__bo {
    height: 14px;
    background-position: -636px 0px;
  }

.drip-tab .iti__flag.iti__bq {
    height: 14px;
    background-position: -658px 0px;
  }

.drip-tab .iti__flag.iti__br {
    height: 14px;
    background-position: -680px 0px;
  }

.drip-tab .iti__flag.iti__bs {
    height: 10px;
    background-position: -702px 0px;
  }

.drip-tab .iti__flag.iti__bt {
    height: 14px;
    background-position: -724px 0px;
  }

.drip-tab .iti__flag.iti__bv {
    height: 15px;
    background-position: -746px 0px;
  }

.drip-tab .iti__flag.iti__bw {
    height: 14px;
    background-position: -768px 0px;
  }

.drip-tab .iti__flag.iti__by {
    height: 10px;
    background-position: -790px 0px;
  }

.drip-tab .iti__flag.iti__bz {
    height: 14px;
    background-position: -812px 0px;
  }

.drip-tab .iti__flag.iti__ca {
    height: 10px;
    background-position: -834px 0px;
  }

.drip-tab .iti__flag.iti__cc {
    height: 10px;
    background-position: -856px 0px;
  }

.drip-tab .iti__flag.iti__cd {
    height: 15px;
    background-position: -878px 0px;
  }

.drip-tab .iti__flag.iti__cf {
    height: 14px;
    background-position: -900px 0px;
  }

.drip-tab .iti__flag.iti__cg {
    height: 14px;
    background-position: -922px 0px;
  }

.drip-tab .iti__flag.iti__ch {
    height: 15px;
    background-position: -944px 0px;
  }

.drip-tab .iti__flag.iti__ci {
    height: 14px;
    background-position: -961px 0px;
  }

.drip-tab .iti__flag.iti__ck {
    height: 10px;
    background-position: -983px 0px;
  }

.drip-tab .iti__flag.iti__cl {
    height: 14px;
    background-position: -1005px 0px;
  }

.drip-tab .iti__flag.iti__cm {
    height: 14px;
    background-position: -1027px 0px;
  }

.drip-tab .iti__flag.iti__cn {
    height: 14px;
    background-position: -1049px 0px;
  }

.drip-tab .iti__flag.iti__co {
    height: 14px;
    background-position: -1071px 0px;
  }

.drip-tab .iti__flag.iti__cp {
    height: 14px;
    background-position: -1093px 0px;
  }

.drip-tab .iti__flag.iti__cr {
    height: 12px;
    background-position: -1115px 0px;
  }

.drip-tab .iti__flag.iti__cu {
    height: 10px;
    background-position: -1137px 0px;
  }

.drip-tab .iti__flag.iti__cv {
    height: 12px;
    background-position: -1159px 0px;
  }

.drip-tab .iti__flag.iti__cw {
    height: 14px;
    background-position: -1181px 0px;
  }

.drip-tab .iti__flag.iti__cx {
    height: 10px;
    background-position: -1203px 0px;
  }

.drip-tab .iti__flag.iti__cy {
    height: 14px;
    background-position: -1225px 0px;
  }

.drip-tab .iti__flag.iti__cz {
    height: 14px;
    background-position: -1247px 0px;
  }

.drip-tab .iti__flag.iti__de {
    height: 12px;
    background-position: -1269px 0px;
  }

.drip-tab .iti__flag.iti__dg {
    height: 10px;
    background-position: -1291px 0px;
  }

.drip-tab .iti__flag.iti__dj {
    height: 14px;
    background-position: -1313px 0px;
  }

.drip-tab .iti__flag.iti__dk {
    height: 15px;
    background-position: -1335px 0px;
  }

.drip-tab .iti__flag.iti__dm {
    height: 10px;
    background-position: -1357px 0px;
  }

.drip-tab .iti__flag.iti__do {
    height: 14px;
    background-position: -1379px 0px;
  }

.drip-tab .iti__flag.iti__dz {
    height: 14px;
    background-position: -1401px 0px;
  }

.drip-tab .iti__flag.iti__ea {
    height: 14px;
    background-position: -1423px 0px;
  }

.drip-tab .iti__flag.iti__ec {
    height: 14px;
    background-position: -1445px 0px;
  }

.drip-tab .iti__flag.iti__ee {
    height: 13px;
    background-position: -1467px 0px;
  }

.drip-tab .iti__flag.iti__eg {
    height: 14px;
    background-position: -1489px 0px;
  }

.drip-tab .iti__flag.iti__eh {
    height: 10px;
    background-position: -1511px 0px;
  }

.drip-tab .iti__flag.iti__er {
    height: 10px;
    background-position: -1533px 0px;
  }

.drip-tab .iti__flag.iti__es {
    height: 14px;
    background-position: -1555px 0px;
  }

.drip-tab .iti__flag.iti__et {
    height: 10px;
    background-position: -1577px 0px;
  }

.drip-tab .iti__flag.iti__eu {
    height: 14px;
    background-position: -1599px 0px;
  }

.drip-tab .iti__flag.iti__fi {
    height: 12px;
    background-position: -1621px 0px;
  }

.drip-tab .iti__flag.iti__fj {
    height: 10px;
    background-position: -1643px 0px;
  }

.drip-tab .iti__flag.iti__fk {
    height: 10px;
    background-position: -1665px 0px;
  }

.drip-tab .iti__flag.iti__fm {
    height: 11px;
    background-position: -1687px 0px;
  }

.drip-tab .iti__flag.iti__fo {
    height: 15px;
    background-position: -1709px 0px;
  }

.drip-tab .iti__flag.iti__fr {
    height: 14px;
    background-position: -1731px 0px;
  }

.drip-tab .iti__flag.iti__ga {
    height: 15px;
    background-position: -1753px 0px;
  }

.drip-tab .iti__flag.iti__gb {
    height: 10px;
    background-position: -1775px 0px;
  }

.drip-tab .iti__flag.iti__gd {
    height: 12px;
    background-position: -1797px 0px;
  }

.drip-tab .iti__flag.iti__ge {
    height: 14px;
    background-position: -1819px 0px;
  }

.drip-tab .iti__flag.iti__gf {
    height: 14px;
    background-position: -1841px 0px;
  }

.drip-tab .iti__flag.iti__gg {
    height: 14px;
    background-position: -1863px 0px;
  }

.drip-tab .iti__flag.iti__gh {
    height: 14px;
    background-position: -1885px 0px;
  }

.drip-tab .iti__flag.iti__gi {
    height: 10px;
    background-position: -1907px 0px;
  }

.drip-tab .iti__flag.iti__gl {
    height: 14px;
    background-position: -1929px 0px;
  }

.drip-tab .iti__flag.iti__gm {
    height: 14px;
    background-position: -1951px 0px;
  }

.drip-tab .iti__flag.iti__gn {
    height: 14px;
    background-position: -1973px 0px;
  }

.drip-tab .iti__flag.iti__gp {
    height: 14px;
    background-position: -1995px 0px;
  }

.drip-tab .iti__flag.iti__gq {
    height: 14px;
    background-position: -2017px 0px;
  }

.drip-tab .iti__flag.iti__gr {
    height: 14px;
    background-position: -2039px 0px;
  }

.drip-tab .iti__flag.iti__gs {
    height: 10px;
    background-position: -2061px 0px;
  }

.drip-tab .iti__flag.iti__gt {
    height: 13px;
    background-position: -2083px 0px;
  }

.drip-tab .iti__flag.iti__gu {
    height: 11px;
    background-position: -2105px 0px;
  }

.drip-tab .iti__flag.iti__gw {
    height: 10px;
    background-position: -2127px 0px;
  }

.drip-tab .iti__flag.iti__gy {
    height: 12px;
    background-position: -2149px 0px;
  }

.drip-tab .iti__flag.iti__hk {
    height: 14px;
    background-position: -2171px 0px;
  }

.drip-tab .iti__flag.iti__hm {
    height: 10px;
    background-position: -2193px 0px;
  }

.drip-tab .iti__flag.iti__hn {
    height: 10px;
    background-position: -2215px 0px;
  }

.drip-tab .iti__flag.iti__hr {
    height: 10px;
    background-position: -2237px 0px;
  }

.drip-tab .iti__flag.iti__ht {
    height: 12px;
    background-position: -2259px 0px;
  }

.drip-tab .iti__flag.iti__hu {
    height: 10px;
    background-position: -2281px 0px;
  }

.drip-tab .iti__flag.iti__ic {
    height: 14px;
    background-position: -2303px 0px;
  }

.drip-tab .iti__flag.iti__id {
    height: 14px;
    background-position: -2325px 0px;
  }

.drip-tab .iti__flag.iti__ie {
    height: 10px;
    background-position: -2347px 0px;
  }

.drip-tab .iti__flag.iti__il {
    height: 15px;
    background-position: -2369px 0px;
  }

.drip-tab .iti__flag.iti__im {
    height: 10px;
    background-position: -2391px 0px;
  }

.drip-tab .iti__flag.iti__in {
    height: 14px;
    background-position: -2413px 0px;
  }

.drip-tab .iti__flag.iti__io {
    height: 10px;
    background-position: -2435px 0px;
  }

.drip-tab .iti__flag.iti__iq {
    height: 14px;
    background-position: -2457px 0px;
  }

.drip-tab .iti__flag.iti__ir {
    height: 12px;
    background-position: -2479px 0px;
  }

.drip-tab .iti__flag.iti__is {
    height: 15px;
    background-position: -2501px 0px;
  }

.drip-tab .iti__flag.iti__it {
    height: 14px;
    background-position: -2523px 0px;
  }

.drip-tab .iti__flag.iti__je {
    height: 12px;
    background-position: -2545px 0px;
  }

.drip-tab .iti__flag.iti__jm {
    height: 10px;
    background-position: -2567px 0px;
  }

.drip-tab .iti__flag.iti__jo {
    height: 10px;
    background-position: -2589px 0px;
  }

.drip-tab .iti__flag.iti__jp {
    height: 14px;
    background-position: -2611px 0px;
  }

.drip-tab .iti__flag.iti__ke {
    height: 14px;
    background-position: -2633px 0px;
  }

.drip-tab .iti__flag.iti__kg {
    height: 12px;
    background-position: -2655px 0px;
  }

.drip-tab .iti__flag.iti__kh {
    height: 13px;
    background-position: -2677px 0px;
  }

.drip-tab .iti__flag.iti__ki {
    height: 10px;
    background-position: -2699px 0px;
  }

.drip-tab .iti__flag.iti__km {
    height: 12px;
    background-position: -2721px 0px;
  }

.drip-tab .iti__flag.iti__kn {
    height: 14px;
    background-position: -2743px 0px;
  }

.drip-tab .iti__flag.iti__kp {
    height: 10px;
    background-position: -2765px 0px;
  }

.drip-tab .iti__flag.iti__kr {
    height: 14px;
    background-position: -2787px 0px;
  }

.drip-tab .iti__flag.iti__kw {
    height: 10px;
    background-position: -2809px 0px;
  }

.drip-tab .iti__flag.iti__ky {
    height: 10px;
    background-position: -2831px 0px;
  }

.drip-tab .iti__flag.iti__kz {
    height: 10px;
    background-position: -2853px 0px;
  }

.drip-tab .iti__flag.iti__la {
    height: 14px;
    background-position: -2875px 0px;
  }

.drip-tab .iti__flag.iti__lb {
    height: 14px;
    background-position: -2897px 0px;
  }

.drip-tab .iti__flag.iti__lc {
    height: 10px;
    background-position: -2919px 0px;
  }

.drip-tab .iti__flag.iti__li {
    height: 12px;
    background-position: -2941px 0px;
  }

.drip-tab .iti__flag.iti__lk {
    height: 10px;
    background-position: -2963px 0px;
  }

.drip-tab .iti__flag.iti__lr {
    height: 11px;
    background-position: -2985px 0px;
  }

.drip-tab .iti__flag.iti__ls {
    height: 14px;
    background-position: -3007px 0px;
  }

.drip-tab .iti__flag.iti__lt {
    height: 12px;
    background-position: -3029px 0px;
  }

.drip-tab .iti__flag.iti__lu {
    height: 12px;
    background-position: -3051px 0px;
  }

.drip-tab .iti__flag.iti__lv {
    height: 10px;
    background-position: -3073px 0px;
  }

.drip-tab .iti__flag.iti__ly {
    height: 10px;
    background-position: -3095px 0px;
  }

.drip-tab .iti__flag.iti__ma {
    height: 14px;
    background-position: -3117px 0px;
  }

.drip-tab .iti__flag.iti__mc {
    height: 15px;
    background-position: -3139px 0px;
  }

.drip-tab .iti__flag.iti__md {
    height: 10px;
    background-position: -3160px 0px;
  }

.drip-tab .iti__flag.iti__me {
    height: 10px;
    background-position: -3182px 0px;
  }

.drip-tab .iti__flag.iti__mf {
    height: 14px;
    background-position: -3204px 0px;
  }

.drip-tab .iti__flag.iti__mg {
    height: 14px;
    background-position: -3226px 0px;
  }

.drip-tab .iti__flag.iti__mh {
    height: 11px;
    background-position: -3248px 0px;
  }

.drip-tab .iti__flag.iti__mk {
    height: 10px;
    background-position: -3270px 0px;
  }

.drip-tab .iti__flag.iti__ml {
    height: 14px;
    background-position: -3292px 0px;
  }

.drip-tab .iti__flag.iti__mm {
    height: 14px;
    background-position: -3314px 0px;
  }

.drip-tab .iti__flag.iti__mn {
    height: 10px;
    background-position: -3336px 0px;
  }

.drip-tab .iti__flag.iti__mo {
    height: 14px;
    background-position: -3358px 0px;
  }

.drip-tab .iti__flag.iti__mp {
    height: 10px;
    background-position: -3380px 0px;
  }

.drip-tab .iti__flag.iti__mq {
    height: 14px;
    background-position: -3402px 0px;
  }

.drip-tab .iti__flag.iti__mr {
    height: 14px;
    background-position: -3424px 0px;
  }

.drip-tab .iti__flag.iti__ms {
    height: 10px;
    background-position: -3446px 0px;
  }

.drip-tab .iti__flag.iti__mt {
    height: 14px;
    background-position: -3468px 0px;
  }

.drip-tab .iti__flag.iti__mu {
    height: 14px;
    background-position: -3490px 0px;
  }

.drip-tab .iti__flag.iti__mv {
    height: 14px;
    background-position: -3512px 0px;
  }

.drip-tab .iti__flag.iti__mw {
    height: 14px;
    background-position: -3534px 0px;
  }

.drip-tab .iti__flag.iti__mx {
    height: 12px;
    background-position: -3556px 0px;
  }

.drip-tab .iti__flag.iti__my {
    height: 10px;
    background-position: -3578px 0px;
  }

.drip-tab .iti__flag.iti__mz {
    height: 14px;
    background-position: -3600px 0px;
  }

.drip-tab .iti__flag.iti__na {
    height: 14px;
    background-position: -3622px 0px;
  }

.drip-tab .iti__flag.iti__nc {
    height: 10px;
    background-position: -3644px 0px;
  }

.drip-tab .iti__flag.iti__ne {
    height: 15px;
    background-position: -3666px 0px;
  }

.drip-tab .iti__flag.iti__nf {
    height: 10px;
    background-position: -3686px 0px;
  }

.drip-tab .iti__flag.iti__ng {
    height: 10px;
    background-position: -3708px 0px;
  }

.drip-tab .iti__flag.iti__ni {
    height: 12px;
    background-position: -3730px 0px;
  }

.drip-tab .iti__flag.iti__nl {
    height: 14px;
    background-position: -3752px 0px;
  }

.drip-tab .iti__flag.iti__no {
    height: 15px;
    background-position: -3774px 0px;
  }

.drip-tab .iti__flag.iti__np {
    height: 15px;
    background-position: -3796px 0px;
  }

.drip-tab .iti__flag.iti__nr {
    height: 10px;
    background-position: -3811px 0px;
  }

.drip-tab .iti__flag.iti__nu {
    height: 10px;
    background-position: -3833px 0px;
  }

.drip-tab .iti__flag.iti__nz {
    height: 10px;
    background-position: -3855px 0px;
  }

.drip-tab .iti__flag.iti__om {
    height: 10px;
    background-position: -3877px 0px;
  }

.drip-tab .iti__flag.iti__pa {
    height: 14px;
    background-position: -3899px 0px;
  }

.drip-tab .iti__flag.iti__pe {
    height: 14px;
    background-position: -3921px 0px;
  }

.drip-tab .iti__flag.iti__pf {
    height: 14px;
    background-position: -3943px 0px;
  }

.drip-tab .iti__flag.iti__pg {
    height: 15px;
    background-position: -3965px 0px;
  }

.drip-tab .iti__flag.iti__ph {
    height: 10px;
    background-position: -3987px 0px;
  }

.drip-tab .iti__flag.iti__pk {
    height: 14px;
    background-position: -4009px 0px;
  }

.drip-tab .iti__flag.iti__pl {
    height: 13px;
    background-position: -4031px 0px;
  }

.drip-tab .iti__flag.iti__pm {
    height: 14px;
    background-position: -4053px 0px;
  }

.drip-tab .iti__flag.iti__pn {
    height: 10px;
    background-position: -4075px 0px;
  }

.drip-tab .iti__flag.iti__pr {
    height: 14px;
    background-position: -4097px 0px;
  }

.drip-tab .iti__flag.iti__ps {
    height: 10px;
    background-position: -4119px 0px;
  }

.drip-tab .iti__flag.iti__pt {
    height: 14px;
    background-position: -4141px 0px;
  }

.drip-tab .iti__flag.iti__pw {
    height: 13px;
    background-position: -4163px 0px;
  }

.drip-tab .iti__flag.iti__py {
    height: 11px;
    background-position: -4185px 0px;
  }

.drip-tab .iti__flag.iti__qa {
    height: 8px;
    background-position: -4207px 0px;
  }

.drip-tab .iti__flag.iti__re {
    height: 14px;
    background-position: -4229px 0px;
  }

.drip-tab .iti__flag.iti__ro {
    height: 14px;
    background-position: -4251px 0px;
  }

.drip-tab .iti__flag.iti__rs {
    height: 14px;
    background-position: -4273px 0px;
  }

.drip-tab .iti__flag.iti__ru {
    height: 14px;
    background-position: -4295px 0px;
  }

.drip-tab .iti__flag.iti__rw {
    height: 14px;
    background-position: -4317px 0px;
  }

.drip-tab .iti__flag.iti__sa {
    height: 14px;
    background-position: -4339px 0px;
  }

.drip-tab .iti__flag.iti__sb {
    height: 10px;
    background-position: -4361px 0px;
  }

.drip-tab .iti__flag.iti__sc {
    height: 10px;
    background-position: -4383px 0px;
  }

.drip-tab .iti__flag.iti__sd {
    height: 10px;
    background-position: -4405px 0px;
  }

.drip-tab .iti__flag.iti__se {
    height: 13px;
    background-position: -4427px 0px;
  }

.drip-tab .iti__flag.iti__sg {
    height: 14px;
    background-position: -4449px 0px;
  }

.drip-tab .iti__flag.iti__sh {
    height: 10px;
    background-position: -4471px 0px;
  }

.drip-tab .iti__flag.iti__si {
    height: 10px;
    background-position: -4493px 0px;
  }

.drip-tab .iti__flag.iti__sj {
    height: 15px;
    background-position: -4515px 0px;
  }

.drip-tab .iti__flag.iti__sk {
    height: 14px;
    background-position: -4537px 0px;
  }

.drip-tab .iti__flag.iti__sl {
    height: 14px;
    background-position: -4559px 0px;
  }

.drip-tab .iti__flag.iti__sm {
    height: 15px;
    background-position: -4581px 0px;
  }

.drip-tab .iti__flag.iti__sn {
    height: 14px;
    background-position: -4603px 0px;
  }

.drip-tab .iti__flag.iti__so {
    height: 14px;
    background-position: -4625px 0px;
  }

.drip-tab .iti__flag.iti__sr {
    height: 14px;
    background-position: -4647px 0px;
  }

.drip-tab .iti__flag.iti__ss {
    height: 10px;
    background-position: -4669px 0px;
  }

.drip-tab .iti__flag.iti__st {
    height: 10px;
    background-position: -4691px 0px;
  }

.drip-tab .iti__flag.iti__sv {
    height: 12px;
    background-position: -4713px 0px;
  }

.drip-tab .iti__flag.iti__sx {
    height: 14px;
    background-position: -4735px 0px;
  }

.drip-tab .iti__flag.iti__sy {
    height: 14px;
    background-position: -4757px 0px;
  }

.drip-tab .iti__flag.iti__sz {
    height: 14px;
    background-position: -4779px 0px;
  }

.drip-tab .iti__flag.iti__ta {
    height: 10px;
    background-position: -4801px 0px;
  }

.drip-tab .iti__flag.iti__tc {
    height: 10px;
    background-position: -4823px 0px;
  }

.drip-tab .iti__flag.iti__td {
    height: 14px;
    background-position: -4845px 0px;
  }

.drip-tab .iti__flag.iti__tf {
    height: 14px;
    background-position: -4867px 0px;
  }

.drip-tab .iti__flag.iti__tg {
    height: 13px;
    background-position: -4889px 0px;
  }

.drip-tab .iti__flag.iti__th {
    height: 14px;
    background-position: -4911px 0px;
  }

.drip-tab .iti__flag.iti__tj {
    height: 10px;
    background-position: -4933px 0px;
  }

.drip-tab .iti__flag.iti__tk {
    height: 10px;
    background-position: -4955px 0px;
  }

.drip-tab .iti__flag.iti__tl {
    height: 10px;
    background-position: -4977px 0px;
  }

.drip-tab .iti__flag.iti__tm {
    height: 14px;
    background-position: -4999px 0px;
  }

.drip-tab .iti__flag.iti__tn {
    height: 14px;
    background-position: -5021px 0px;
  }

.drip-tab .iti__flag.iti__to {
    height: 10px;
    background-position: -5043px 0px;
  }

.drip-tab .iti__flag.iti__tr {
    height: 14px;
    background-position: -5065px 0px;
  }

.drip-tab .iti__flag.iti__tt {
    height: 12px;
    background-position: -5087px 0px;
  }

.drip-tab .iti__flag.iti__tv {
    height: 10px;
    background-position: -5109px 0px;
  }

.drip-tab .iti__flag.iti__tw {
    height: 14px;
    background-position: -5131px 0px;
  }

.drip-tab .iti__flag.iti__tz {
    height: 14px;
    background-position: -5153px 0px;
  }

.drip-tab .iti__flag.iti__ua {
    height: 14px;
    background-position: -5175px 0px;
  }

.drip-tab .iti__flag.iti__ug {
    height: 14px;
    background-position: -5197px 0px;
  }

.drip-tab .iti__flag.iti__um {
    height: 11px;
    background-position: -5219px 0px;
  }

.drip-tab .iti__flag.iti__un {
    height: 14px;
    background-position: -5241px 0px;
  }

.drip-tab .iti__flag.iti__us {
    height: 11px;
    background-position: -5263px 0px;
  }

.drip-tab .iti__flag.iti__uy {
    height: 14px;
    background-position: -5285px 0px;
  }

.drip-tab .iti__flag.iti__uz {
    height: 10px;
    background-position: -5307px 0px;
  }

.drip-tab .iti__flag.iti__va {
    height: 15px;
    background-position: -5329px 0px;
  }

.drip-tab .iti__flag.iti__vc {
    height: 14px;
    background-position: -5346px 0px;
  }

.drip-tab .iti__flag.iti__ve {
    height: 14px;
    background-position: -5368px 0px;
  }

.drip-tab .iti__flag.iti__vg {
    height: 10px;
    background-position: -5390px 0px;
  }

.drip-tab .iti__flag.iti__vi {
    height: 14px;
    background-position: -5412px 0px;
  }

.drip-tab .iti__flag.iti__vn {
    height: 14px;
    background-position: -5434px 0px;
  }

.drip-tab .iti__flag.iti__vu {
    height: 12px;
    background-position: -5456px 0px;
  }

.drip-tab .iti__flag.iti__wf {
    height: 14px;
    background-position: -5478px 0px;
  }

.drip-tab .iti__flag.iti__ws {
    height: 10px;
    background-position: -5500px 0px;
  }

.drip-tab .iti__flag.iti__xk {
    height: 15px;
    background-position: -5522px 0px;
  }

.drip-tab .iti__flag.iti__ye {
    height: 14px;
    background-position: -5544px 0px;
  }

.drip-tab .iti__flag.iti__yt {
    height: 14px;
    background-position: -5566px 0px;
  }

.drip-tab .iti__flag.iti__za {
    height: 14px;
    background-position: -5588px 0px;
  }

.drip-tab .iti__flag.iti__zm {
    height: 14px;
    background-position: -5610px 0px;
  }

.drip-tab .iti__flag.iti__zw {
    height: 10px;
    background-position: -5632px 0px;
  }

.drip-tab .iti__flag {
    height: 15px;
    box-shadow: 0px 0px 1px 0px #888;
    background-image: url("flags.png");
    background-repeat: no-repeat;
    background-position: 20px 0;
  }

.drip-tab .iti__flag.iti__np {
  background-color: transparent;
}

.drip-tab .iti__flag {
  background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags.png");
};

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .drip-tab .iti__flag {
    background-image: url("https://d14jnfavjicsbe.cloudfront.net/images/client/flags@2x.png");
  }
}

/* stylelint-enable */


  /* preview settings */
  body.after-submit-preview .drip-panel:not(.drip-success) {
    display: none !important;
  }
  body.after-submit-preview .drip-success {
    display: block !important;
  }

  /* stylelint-enable */

</style><script src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/can-i-show.html"></script><style type="text/css">.CtxtMenu_InfoClose {  top:.2em; right:.2em;}
.CtxtMenu_InfoContent {  overflow:auto; text-align:left; font-size:80%;  padding:.4em .6em; border:1px inset; margin:1em 0px;  max-height:20em; max-width:30em; background-color:#EEEEEE;  white-space:normal;}
.CtxtMenu_Info.CtxtMenu_MousePost {outline:none;}
.CtxtMenu_Info {  position:fixed; left:50%; width:auto; text-align:center;  border:3px outset; padding:1em 2em; background-color:#DDDDDD;  color:black;  cursor:default; font-family:message-box; font-size:120%;  font-style:normal; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 15px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius:15px;               /* Safari and Chrome */  -moz-border-radius:15px;                  /* Firefox */  -khtml-border-radius:15px;                /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */  filter:progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color="gray", Positive="true"); /* IE */}
</style><style type="text/css">.CtxtMenu_MenuClose {  position:absolute;  cursor:pointer;  display:inline-block;  border:2px solid #AAA;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  font-family: "Courier New", Courier;  font-size:24px;  color:#F0F0F0}
.CtxtMenu_MenuClose span {  display:block; background-color:#AAA; border:1.5px solid;  border-radius:18px;  -webkit-border-radius: 18px;             /* Safari and Chrome */  -moz-border-radius: 18px;                /* Firefox */  -khtml-border-radius: 18px;              /* Konqueror */  line-height:0;  padding:8px 0 6px     /* may need to be browser-specific */}
.CtxtMenu_MenuClose:hover {  color:white!important;  border:2px solid #CCC!important}
.CtxtMenu_MenuClose:hover span {  background-color:#CCC!important}
.CtxtMenu_MenuClose:hover:focus {  outline:none}
</style><style type="text/css">.CtxtMenu_Menu {  position:absolute;  background-color:white;  color:black;  width:auto; padding:5px 0px;  border:1px solid #CCCCCC; margin:0; cursor:default;  font: menu; text-align:left; text-indent:0; text-transform:none;  line-height:normal; letter-spacing:normal; word-spacing:normal;  word-wrap:normal; white-space:nowrap; float:none; z-index:201;  border-radius: 5px;                     /* Opera 10.5 and IE9 */  -webkit-border-radius: 5px;             /* Safari and Chrome */  -moz-border-radius: 5px;                /* Firefox */  -khtml-border-radius: 5px;              /* Konqueror */  box-shadow:0px 10px 20px #808080;         /* Opera 10.5 and IE9 */  -webkit-box-shadow:0px 10px 20px #808080; /* Safari 3 & Chrome */  -moz-box-shadow:0px 10px 20px #808080;    /* Forefox 3.5 */  -khtml-box-shadow:0px 10px 20px #808080;  /* Konqueror */}
.CtxtMenu_MenuItem {  padding: 1px 2em;  background:transparent;}
.CtxtMenu_MenuArrow {  position:absolute; right:.5em; padding-top:.25em; color:#666666;  font-family: null; font-size: .75em}
.CtxtMenu_MenuActive .CtxtMenu_MenuArrow {color:white}
.CtxtMenu_MenuArrow.CtxtMenu_RTL {left:.5em; right:auto}
.CtxtMenu_MenuCheck {  position:absolute; left:.7em;  font-family: null}
.CtxtMenu_MenuCheck.CtxtMenu_RTL { right:.7em; left:auto }
.CtxtMenu_MenuRadioCheck {  position:absolute; left: .7em;}
.CtxtMenu_MenuRadioCheck.CtxtMenu_RTL {  right: .7em; left:auto}
.CtxtMenu_MenuInputBox {  padding-left: 1em; right:.5em; color:#666666;  font-family: null;}
.CtxtMenu_MenuInputBox.CtxtMenu_RTL {  left: .1em;}
.CtxtMenu_MenuComboBox {  left:.1em; padding-bottom:.5em;}
.CtxtMenu_MenuSlider {  left: .1em;}
.CtxtMenu_SliderValue {  position:absolute; right:.1em; padding-top:.25em; color:#333333;  font-size: .75em}
.CtxtMenu_SliderBar {  outline: none; background: #d3d3d3}
.CtxtMenu_MenuLabel {  padding: 1px 2em 3px 1.33em;  font-style:italic}
.CtxtMenu_MenuRule {  border-top: 1px solid #DDDDDD;  margin: 4px 3px;}
.CtxtMenu_MenuDisabled {  color:GrayText}
.CtxtMenu_MenuActive {  background-color: #606872;  color: white;}
.CtxtMenu_MenuDisabled:focus {  background-color: #E8E8E8}
.CtxtMenu_MenuLabel:focus {  background-color: #E8E8E8}
.CtxtMenu_ContextMenu:focus {  outline:none}
.CtxtMenu_ContextMenu .CtxtMenu_MenuItem:focus {  outline:none}
.CtxtMenu_SelectionMenu {  position:relative; float:left;  border-bottom: none; -webkit-box-shadow:none; -webkit-border-radius:0px; }
.CtxtMenu_SelectionItem {  padding-right: 1em;}
.CtxtMenu_Selection {  right: 40%; width:50%; }
.CtxtMenu_SelectionBox {  padding: 0em; max-height:20em; max-width: none;  background-color:#FFFFFF;}
.CtxtMenu_SelectionDivider {  clear: both; border-top: 2px solid #000000;}
.CtxtMenu_Menu .CtxtMenu_MenuClose {  top:-10px; left:-10px}
</style><style id="MJX-CHTML-styles">
mjx-container[jax="CHTML"] {
  line-height: 0;
}

mjx-container [space="1"] {
  margin-left: .111em;
}

mjx-container [space="2"] {
  margin-left: .167em;
}

mjx-container [space="3"] {
  margin-left: .222em;
}

mjx-container [space="4"] {
  margin-left: .278em;
}

mjx-container [space="5"] {
  margin-left: .333em;
}

mjx-container [rspace="1"] {
  margin-right: .111em;
}

mjx-container [rspace="2"] {
  margin-right: .167em;
}

mjx-container [rspace="3"] {
  margin-right: .222em;
}

mjx-container [rspace="4"] {
  margin-right: .278em;
}

mjx-container [rspace="5"] {
  margin-right: .333em;
}

mjx-container [size="s"] {
  font-size: 70.7%;
}

mjx-container [size="ss"] {
  font-size: 50%;
}

mjx-container [size="Tn"] {
  font-size: 60%;
}

mjx-container [size="sm"] {
  font-size: 85%;
}

mjx-container [size="lg"] {
  font-size: 120%;
}

mjx-container [size="Lg"] {
  font-size: 144%;
}

mjx-container [size="LG"] {
  font-size: 173%;
}

mjx-container [size="hg"] {
  font-size: 207%;
}

mjx-container [size="HG"] {
  font-size: 249%;
}

mjx-container [width="full"] {
  width: 100%;
}

mjx-box {
  display: inline-block;
}

mjx-block {
  display: block;
}

mjx-itable {
  display: inline-table;
}

mjx-row {
  display: table-row;
}

mjx-row > * {
  display: table-cell;
}

mjx-mtext {
  display: inline-block;
}

mjx-mstyle {
  display: inline-block;
}

mjx-merror {
  display: inline-block;
  color: red;
  background-color: yellow;
}

mjx-mphantom {
  visibility: hidden;
}

_::-webkit-full-page-media, _:future, :root mjx-container {
  will-change: opacity;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-c::before {
  display: block;
  width: 0;
}

.MJX-TEX {
  font-family: MJXZERO, MJXTEX;
}

.TEX-B {
  font-family: MJXZERO, MJXTEX-B;
}

.TEX-I {
  font-family: MJXZERO, MJXTEX-I;
}

.TEX-MI {
  font-family: MJXZERO, MJXTEX-MI;
}

.TEX-BI {
  font-family: MJXZERO, MJXTEX-BI;
}

.TEX-S1 {
  font-family: MJXZERO, MJXTEX-S1;
}

.TEX-S2 {
  font-family: MJXZERO, MJXTEX-S2;
}

.TEX-S3 {
  font-family: MJXZERO, MJXTEX-S3;
}

.TEX-S4 {
  font-family: MJXZERO, MJXTEX-S4;
}

.TEX-A {
  font-family: MJXZERO, MJXTEX-A;
}

.TEX-C {
  font-family: MJXZERO, MJXTEX-C;
}

.TEX-CB {
  font-family: MJXZERO, MJXTEX-CB;
}

.TEX-FR {
  font-family: MJXZERO, MJXTEX-FR;
}

.TEX-FRB {
  font-family: MJXZERO, MJXTEX-FRB;
}

.TEX-SS {
  font-family: MJXZERO, MJXTEX-SS;
}

.TEX-SSB {
  font-family: MJXZERO, MJXTEX-SSB;
}

.TEX-SSI {
  font-family: MJXZERO, MJXTEX-SSI;
}

.TEX-SC {
  font-family: MJXZERO, MJXTEX-SC;
}

.TEX-T {
  font-family: MJXZERO, MJXTEX-T;
}

.TEX-V {
  font-family: MJXZERO, MJXTEX-V;
}

.TEX-VB {
  font-family: MJXZERO, MJXTEX-VB;
}

mjx-stretchy-v mjx-c, mjx-stretchy-h mjx-c {
  font-family: MJXZERO, MJXTEX-S1, MJXTEX-S4, MJXTEX, MJXTEX-A ! important;
}

@font-face /* 0 */ {
  font-family: MJXZERO;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Zero.woff") format("woff");
}

@font-face /* 1 */ {
  font-family: MJXTEX;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Main-Regular.woff") format("woff");
}

@font-face /* 2 */ {
  font-family: MJXTEX-B;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Main-Bold.woff") format("woff");
}

@font-face /* 3 */ {
  font-family: MJXTEX-I;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Math-Italic.woff") format("woff");
}

@font-face /* 4 */ {
  font-family: MJXTEX-MI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Main-Italic.woff") format("woff");
}

@font-face /* 5 */ {
  font-family: MJXTEX-BI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Math-BoldItalic.woff") format("woff");
}

@font-face /* 6 */ {
  font-family: MJXTEX-S1;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Size1-Regular.woff") format("woff");
}

@font-face /* 7 */ {
  font-family: MJXTEX-S2;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Size2-Regular.woff") format("woff");
}

@font-face /* 8 */ {
  font-family: MJXTEX-S3;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Size3-Regular.woff") format("woff");
}

@font-face /* 9 */ {
  font-family: MJXTEX-S4;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Size4-Regular.woff") format("woff");
}

@font-face /* 10 */ {
  font-family: MJXTEX-A;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_AMS-Regular.woff") format("woff");
}

@font-face /* 11 */ {
  font-family: MJXTEX-C;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Regular.woff") format("woff");
}

@font-face /* 12 */ {
  font-family: MJXTEX-CB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Calligraphic-Bold.woff") format("woff");
}

@font-face /* 13 */ {
  font-family: MJXTEX-FR;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Fraktur-Regular.woff") format("woff");
}

@font-face /* 14 */ {
  font-family: MJXTEX-FRB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Fraktur-Bold.woff") format("woff");
}

@font-face /* 15 */ {
  font-family: MJXTEX-SS;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_SansSerif-Regular.woff") format("woff");
}

@font-face /* 16 */ {
  font-family: MJXTEX-SSB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_SansSerif-Bold.woff") format("woff");
}

@font-face /* 17 */ {
  font-family: MJXTEX-SSI;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_SansSerif-Italic.woff") format("woff");
}

@font-face /* 18 */ {
  font-family: MJXTEX-SC;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Script-Regular.woff") format("woff");
}

@font-face /* 19 */ {
  font-family: MJXTEX-T;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Typewriter-Regular.woff") format("woff");
}

@font-face /* 20 */ {
  font-family: MJXTEX-V;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Vector-Regular.woff") format("woff");
}

@font-face /* 21 */ {
  font-family: MJXTEX-VB;
  src: url("https://machinelearningmastery.com/wp-content/cache/min/1/output/chtml/fonts/woff-v2/MathJax_Vector-Bold.woff") format("woff");
}
</style><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="stylesheet" type="text/css" href="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/twitcount.css" media="all"></head>
<body class="post-template-default single single-post postid-4401 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<!--[sc name="banner_super_bundle"]--><h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/Header_smaller_text_better-1.webp" alt="Machine Learning Mastery" width="480" height="80"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-42" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<a href="https://machinelearningmastery.lpages.co/dlfnlp-mini-course/">Click to Take the FREE NLP Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (!window.__cfRLUnblockHandlers) return false; if (this.value == 'Search...') {this.value = '';}" onblur="if (!window.__cfRLUnblockHandlers) return false; if (this.value == '') {this.value = 'Search...';}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Neural Net Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-11055" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-11055"><a href="https://machinelearningmastery.com/category/ensemble-learning/">Ensemble Learning</a></li>
	<li id="menu-item-9966" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-9966"><a href="https://machinelearningmastery.com/category/imbalanced-classification/">Imbalanced Learning</a></li>
	<li id="menu-item-10674" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-10674"><a href="https://machinelearningmastery.com/category/data-preparation/">Data Preparation</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-12825" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-12825"><a href="https://machinelearningmastery.com/category/optimization/">Optimization</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-4401 post type-post status-publish format-standard has-post-thumbnail hentry category-natural-language-processing">
	<header>
	<h1 class="title entry-title">Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2017-10-30T05:00:39+1100">October 30, 2017</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/natural-language-processing/" title="View all items in Deep Learning for Natural Language Processing">Deep Learning for Natural Language Processing</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4401 post simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Deep+Convolutional+Neural+Network+for+Sentiment+Analysis+%28Text+Classification%29&amp;url=https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p id="last-modified-info">Last Updated on September 3, 2020</p>
<h4 style="text-align: center;">Develop a Deep Learning Model to Automatically Classify Movie Reviews<br>
as Positive or Negative in Python with Keras, Step-by-Step.</h4>
<p><a href="https://machinelearningmastery.com/what-are-word-embeddings/">Word embeddings</a>
 are a technique for representing text where different words with 
similar meaning have a similar real-valued vector representation.</p>
<p>They are a key breakthrough that has led to great performance of 
neural network models on a suite of challenging natural language 
processing problems.</p>
<p>In this tutorial, you will discover how to develop word embedding models for neural networks to classify movie reviews.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>How to prepare movie review text data for classification with deep learning methods.</li>
<li>How to learn a word embedding as part of fitting a deep learning model.</li>
<li>How to learn a standalone word embedding and how to use a pre-trained embedding in a neural network model.</li>
</ul>
<p><strong>Kick-start your project</strong> with my new book <a href="https://machinelearningmastery.com/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a>, including <em>step-by-step tutorials</em> and the <em>Python source code</em> files for all examples.</p>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2019</strong>: Fixed code typo when preparing training dataset (thanks HSA).</li>
<li><strong>Update Aug/2020</strong>: Updated link to movie review dataset.</li>
</ul>
<div id="attachment_4402" style="width: 810px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-4402" loading="lazy" class="size-full wp-image-4402" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Mov_002.jpg" alt="How to Develop a Word Embedding Model for Predicting Movie Review Sentiment" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Mov_002.jpg 800w, Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Mov_004.jpg 300w, Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Movie-R.jpg 768w" sizes="(max-width: 800px) 100vw, 800px" width="800" height="537"><p id="caption-attachment-4402" class="wp-caption-text">How to Develop a Word Embedding Model for Predicting Movie Review Sentiment<br>Photo by <a href="https://www.flickr.com/photos/fuzzyblue/6351564408/">Katrina Br*?#*!@nd</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into 5 parts; they are:</p>
<ol>
<li>Movie Review Dataset</li>
<li>Data Preparation</li>
<li>Train Embedding Layer</li>
<li>Train word2vec Embedding</li>
<li>Use Pre-trained Embedding</li>
</ol>
<h3>Python Environment</h3>
<p>This tutorial assumes you have a Python SciPy environment installed, ideally with Python 3.</p>
<p>You must have Keras (2.2 or higher) installed with either the TensorFlow or Theano backend.</p>
<p>The tutorial also assumes you have scikit-learn, Pandas, NumPy, and Matplotlib installed.</p>
<p>If you need help with your environment, see this tutorial:</p>
<ul>
<li><a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Setup a Python Environment for Machine Learning and Deep Learning with Anaconda</a></li>
</ul>
<p>A GPU is not required for this tutorial, nevertheless, you can access
 GPUs cheaply on Amazon Web Services. Learn how in this tutorial:</p>
<ul>
<li><a href="https://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/">How to Setup Amazon AWS EC2 GPUs to Train Keras Deep Learning Models (step-by-step)</a></li>
</ul>
<p>Let’s dive in.</p>
<p></p><div class="woo-sc-hr"></div><p></p>
<center>
<h3>Need help with Deep Learning for Text Data?</h3>
<p>Take my free 7-day email crash course now (with code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a style="background: #ffce0a; color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" href="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" target="_blank" rel="noopener noreferrer" data-leadbox="https://machinelearningmastery.lpages.co/leadbox/144855173f72a2%3A164f8be4f346dc/5655638436741120/" data-leadbox-id="144855173f72a2:164f8be4f346dc">Start Your FREE Crash-Course Now</a></p>
</center>
<p></p><div class="woo-sc-hr"></div><p></p>
<h2>1. Movie Review Dataset</h2>
<p>The Movie Review Data is a collection of movie reviews retrieved from
 the imdb.com website in the early 2000s by Bo Pang and Lillian Lee. The
 reviews were collected and made available as part of their research on 
natural language processing.</p>
<p>The reviews were originally released in 2002, but an updated and 
cleaned up version were released in 2004, referred to as “v2.0”.</p>
<p>The dataset is comprised of 1,000 positive and 1,000 negative movie 
reviews drawn from an archive of the rec.arts.movies.reviews newsgroup 
hosted at <a href="http://reviews.imdb.com/Reviews">imdb.com</a>. The authors refer to this dataset as the “polarity dataset.”</p>
<blockquote><p>Our data contains 1000 positive and 1000 negative reviews
 all written before 2002, with a cap of 20 reviews per author (312 
authors total) per category. We refer to this corpus as the polarity 
dataset.</p></blockquote>
<p>— <a href="http://xxx.lanl.gov/abs/cs/0409058">A Sentimental Education: Sentiment Analysis Using Subjectivity Summarization Based on Minimum Cuts</a>, 2004.</p>
<p>The data has been cleaned up somewhat, for example:</p>
<ul>
<li>The dataset is comprised of only English reviews.</li>
<li>All text has been converted to lowercase.</li>
<li>There is white space around punctuation like periods, commas, and brackets.</li>
<li>Text has been split into one sentence per line.</li>
</ul>
<p>The data has been used for a few related natural language processing 
tasks. For classification, the performance of machine learning models 
(such as Support Vector Machines) on the data is in the range of high 
70% to low 80% (e.g. 78%-82%).</p>
<p>More sophisticated data preparation may see results as high as 86% 
with 10-fold cross validation. This gives us a ballpark of low-to-mid 
80s if we were looking to use this dataset in experiments of modern 
methods.</p>
<blockquote><p>… depending on choice of downstream polarity classifier, 
we can achieve highly statistically significant improvement (from 82.8% 
to 86.4%)</p></blockquote>
<p>— <a href="http://xxx.lanl.gov/abs/cs/0409058">A Sentimental Education: Sentiment Analysis Using Subjectivity Summarization Based on Minimum Cuts</a>, 2004.</p>
<p>You can download the dataset from here:</p>
<ul>
<li><a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/review_polarity.tar.gz">Movie Review Polarity Dataset</a> (review_polarity.tar.gz, 3MB)</li>
</ul>
<p>After unzipping the file, you will have a directory called “<em>txt_sentoken</em>” with two sub-directories containing the text “<em>neg</em>” and “<em>pos</em>”
 for negative and positive reviews. Reviews are stored one per file with
 a naming convention cv000 to cv999 for each neg and pos.</p>
<p>Next, let’s look at loading and preparing the text data.</p>
<h2>2. Data Preparation</h2>
<p>In this section, we will look at 3 things:</p>
<ol>
<li>Separation of data into training and test sets.</li>
<li>Loading and cleaning the data to remove punctuation and numbers.</li>
<li>Defining a vocabulary of preferred words.</li>
</ol>
<h3>Split into Train and Test Sets</h3>
<p>We are pretending that we are developing a system that can predict 
the sentiment of a textual movie review as either positive or negative.</p>
<p>This means that after the model is developed, we will need to make 
predictions on new textual reviews. This will require all of the same 
data preparation to be performed on those new reviews as is performed on
 the training data for the model.</p>
<p>We will ensure that this constraint is built into the evaluation of 
our models by splitting the training and test datasets prior to any data
 preparation. This means that any knowledge in the data in the test set 
that could help us better prepare the data (e.g. the words used) are 
unavailable in the preparation of data used for training the model.</p>
<p>That being said, we will use the last 100 positive reviews and the 
last 100 negative reviews as a test set (100 reviews) and the remaining 
1,800 reviews as the training dataset.</p>
<p>This is a 90% train, 10% split of the data.</p>
<p>The split can be imposed easily by using the filenames of the reviews
 where reviews named 000 to 899 are for training data and reviews named 
900 onwards are for test.</p>
<h3>Loading and Cleaning Reviews</h3>
<p>The text data is already pretty clean; not much preparation is required.</p>
<p>If you are new to cleaning text data, see this post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/clean-text-machine-learning-python/">How to Clean Text for Machine Learning with Python</a></li>
</ul>
<p>Without getting bogged down too much in the details, we will prepare the data using the following way:</p>
<ul>
<li>Split tokens on white space.</li>
<li>Remove all punctuation from words.</li>
<li>Remove all words that are not purely comprised of alphabetical characters.</li>
<li>Remove all words that are known stop words.</li>
<li>Remove all words that have a length &lt;= 1 character.</li>
</ul>
<p>We can put all of these steps into a function called <em>clean_doc()</em> that takes as an argument the raw text loaded from a file and returns a list of cleaned tokens. We can also define a function <em>load_doc()</em> that loads a document from file ready for use with the <em>clean_doc()</em> function.</p>
<p>An example of cleaning the first positive review is listed below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5e4682767996" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">from nltk.corpus import stopwords
import string

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', string.punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load the document
filename = 'txt_sentoken/pos/cv000_29590.txt'
text = load_doc(filename)
tokens = clean_doc(text)
print(tokens)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e4682767996-34">34</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-1"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-e">stopwords</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-2"><span class="crayon-e">import </span><span class="crayon-t">string</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-4"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-5"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-6"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-7"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-8"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-9"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-10"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-11"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-14"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-15"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-16"><span class="crayon-h">	</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-17"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-18"><span class="crayon-h">	</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-19"><span class="crayon-h">	</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">string</span><span class="crayon-sy">.</span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-20"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-21"><span class="crayon-h">	</span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-22"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-23"><span class="crayon-h">	</span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-24"><span class="crayon-h">	</span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-25"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-26"><span class="crayon-h">	</span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-27"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-28"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">tokens</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-30"><span class="crayon-p"># load the document</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-31"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'txt_sentoken/pos/cv000_29590.txt'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-32"><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-33"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e4682767996-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example prints a long list of clean tokens.</p>
<p>There are many more cleaning steps we may want to explore and I leave them as further exercises.</p>
<p>I’d love to see what you can come up with.<br>
Post your approaches and findings in the comments at the end.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5e9504983751" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">...
'creepy',
 'place', 'even', 'acting', 'hell', 'solid', 'dreamy', 'depp', 
'turning', 'typically', 'strong', 'performance', 'deftly', 'handling', 
'british', 'accent', 'ians', 'holm', 'joe', 'goulds', 'secret', 
'richardson', 'dalmatians', 'log', 'great', 'supporting', 'roles', 
'big', 'surprise', 'graham', 'cringed', 'first', 'time', 'opened', 
'mouth', 'imagining', 'attempt', 'irish', 'accent', 'actually', 'wasnt',
 'half', 'bad', 'film', 'however', 'good', 'strong', 'violencegore', 
'sexuality', 'language', 'drug', 'content']</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5e9504983751-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5e9504983751-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5e9504983751-1">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5e9504983751-2">'creepy', 'place', 'even', 'acting', 'hell', 'solid', 'dreamy', 'depp', 'turning', 'typically', 'strong', 'performance', 'deftly', 'handling', 'british', 'accent', 'ians', 'holm', 'joe', 'goulds', 'secret', 'richardson', 'dalmatians', 'log', 'great', 'supporting', 'roles', 'big', 'surprise', 'graham', 'cringed', 'first', 'time', 'opened', 'mouth', 'imagining', 'attempt', 'irish', 'accent', 'actually', 'wasnt', 'half', 'bad', 'film', 'however', 'good', 'strong', 'violencegore', 'sexuality', 'language', 'drug', 'content']</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<h3>Define a Vocabulary</h3>
<p>It is important to define a vocabulary of known words when using a bag-of-words or embedding model.</p>
<p>The more words, the larger the representation of documents, therefore
 it is important to constrain the words to only those believed to be 
predictive. This is difficult to know beforehand and often it is 
important to test different hypotheses about how to construct a useful 
vocabulary.</p>
<p>We have already seen how we can remove punctuation and numbers from 
the vocabulary in the previous section. We can repeat this for all 
documents and build a set of all known words.</p>
<p>We can develop a vocabulary as a Counter, which is a dictionary 
mapping of words and their counts that allow&nbsp;us to easily update 
and query.</p>
<p>Each document can be added to the counter (a new function called <em>add_doc_to_vocab()</em>) and we can step over all of the reviews in the negative directory and then the positive directory (a new function called <em>process_docs()</em>).</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5ea638118547" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">from string import punctuation
from os import listdir
from collections import Counter
from nltk.corpus import stopwords

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# remove remaining tokens that are not alphabetic
	tokens = [word for word in tokens if word.isalpha()]
	# filter out stop words
	stop_words = set(stopwords.words('english'))
	tokens = [w for w in tokens if not w in stop_words]
	# filter out short tokens
	tokens = [word for word in tokens if len(word) &gt; 1]
	return tokens

# load doc and add to vocab
def add_doc_to_vocab(filename, vocab):
	# load doc
	doc = load_doc(filename)
	# clean doc
	tokens = clean_doc(doc)
	# update counts
	vocab.update(tokens)

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# add doc to vocab
		add_doc_to_vocab(path, vocab)

# define vocab
vocab = Counter()
# add all docs to vocab
process_docs('txt_sentoken/neg', vocab, True)
process_docs('txt_sentoken/pos', vocab, True)
# print the size of the vocab
print(len(vocab))
# print the top words in the vocab
print(vocab.most_common(50))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ea638118547-63">63</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-3"><span class="crayon-e">from </span><span class="crayon-e">collections </span><span class="crayon-e">import </span><span class="crayon-e">Counter</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-4"><span class="crayon-e">from </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-e">import </span><span class="crayon-i">stopwords</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-6"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-7"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-8"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-9"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-10"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-11"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-12"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-13"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-16"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-17"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-18"><span class="crayon-h">	</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-19"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-20"><span class="crayon-h">	</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-21"><span class="crayon-h">	</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-22"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-23"><span class="crayon-h">	</span><span class="crayon-p"># remove remaining tokens that are not alphabetic</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-24"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-25"><span class="crayon-h">	</span><span class="crayon-p"># filter out stop words</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-26"><span class="crayon-h">	</span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-27"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-28"><span class="crayon-h">	</span><span class="crayon-p"># filter out short tokens</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-29"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-30"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">tokens</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-32"><span class="crayon-p"># load doc and add to vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-33"><span class="crayon-e">def </span><span class="crayon-e">add_doc_to_vocab</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-34"><span class="crayon-h">	</span><span class="crayon-p"># load doc</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-35"><span class="crayon-h">	</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-36"><span class="crayon-h">	</span><span class="crayon-p"># clean doc</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-37"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-38"><span class="crayon-h">	</span><span class="crayon-p"># update counts</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-39"><span class="crayon-h">	</span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-41"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-42"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-43"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-44"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-45"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-46"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-47"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-48"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-49"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-50"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-51"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-52"><span class="crayon-h">		</span><span class="crayon-p"># add doc to vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-53"><span class="crayon-h">		</span><span class="crayon-e">add_doc_to_vocab</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-54">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-55"><span class="crayon-p"># define vocab</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-56"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-57"><span class="crayon-p"># add all docs to vocab</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-58"><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-59"><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-60"><span class="crayon-p"># print the size of the vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-61"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-62"><span class="crayon-p"># print the top words in the vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ea638118547-63"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">most_common</span><span class="crayon-sy">(</span><span class="crayon-cn">50</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example shows that we have a vocabulary of 44,276 words.</p>
<p>We also can see a sample of the top 50 most used words in the movie reviews.</p>
<p>Note, that this vocabulary was constructed based on only those reviews in the training dataset.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5eb397956806" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">44276
[('film',
 7983), ('one', 4946), ('movie', 4826), ('like', 3201), ('even', 2262), 
('good', 2080), ('time', 2041), ('story', 1907), ('films', 1873), 
('would', 1844), ('much', 1824), ('also', 1757), ('characters', 1735), 
('get', 1724), ('character', 1703), ('two', 1643), ('first', 1588), 
('see', 1557), ('way', 1515), ('well', 1511), ('make', 1418), ('really',
 1407), ('little', 1351), ('life', 1334), ('plot', 1288), ('people', 
1269), ('could', 1248), ('bad', 1248), ('scene', 1241), ('movies', 
1238), ('never', 1201), ('best', 1179), ('new', 1140), ('scenes', 1135),
 ('man', 1131), ('many', 1130), ('doesnt', 1118), ('know', 1092), 
('dont', 1086), ('hes', 1024), ('great', 1014), ('another', 992), 
('action', 985), ('love', 977), ('us', 967), ('go', 952), ('director', 
948), ('end', 946), ('something', 945), ('still', 936)]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5eb397956806-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5eb397956806-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5eb397956806-1">44276</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5eb397956806-2">[('film', 7983), ('one', 4946), ('movie', 4826), ('like', 3201), ('even', 2262), ('good', 2080), ('time', 2041), ('story', 1907), ('films', 1873), ('would', 1844), ('much', 1824), ('also', 1757), ('characters', 1735), ('get', 1724), ('character', 1703), ('two', 1643), ('first', 1588), ('see', 1557), ('way', 1515), ('well', 1511), ('make', 1418), ('really', 1407), ('little', 1351), ('life', 1334), ('plot', 1288), ('people', 1269), ('could', 1248), ('bad', 1248), ('scene', 1241), ('movies', 1238), ('never', 1201), ('best', 1179), ('new', 1140), ('scenes', 1135), ('man', 1131), ('many', 1130), ('doesnt', 1118), ('know', 1092), ('dont', 1086), ('hes', 1024), ('great', 1014), ('another', 992), ('action', 985), ('love', 977), ('us', 967), ('go', 952), ('director', 948), ('end', 946), ('something', 945), ('still', 936)]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can step through the vocabulary and remove all words that 
have a low occurrence, such as only being used once or twice in all 
reviews.</p>
<p>For example, the following snippet will retrieve only the tokens that of appears 2 or more times in all reviews.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5ec398364322" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># keep tokens with a min occurrence
min_occurane = 2
tokens = [k for k,c in vocab.items() if c &gt;= min_occurane]
print(len(tokens))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ec398364322-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ec398364322-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ec398364322-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ec398364322-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ec398364322-1"><span class="crayon-p"># keep tokens with a min occurrence</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ec398364322-2"><span class="crayon-v">min_occurane</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ec398364322-3"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">k</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">k</span><span class="crayon-sy">,</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">min_occurane</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ec398364322-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the above example with this addition shows that the 
vocabulary size drops by a little more than half its size from 44,276 to
 25,767 words.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5ed848983039" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">25767</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ed848983039-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ed848983039-1">25767</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Finally, the vocabulary can be saved to a new file called <em>vocab.txt</em> that we can later load and use to filter movie reviews prior to encoding them for modeling. We define a new function called <em>save_list()</em> that saves the vocabulary to file, with one word per file.</p>
<p>For example:</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5ee231326643" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># save list to file
def save_list(lines, filename):
	# convert lines to a single blob of text
	data = '\n'.join(lines)
	# open file
	file = open(filename, 'w')
	# write text
	file.write(data)
	# close file
	file.close()

# save tokens to a vocabulary file
save_list(tokens, 'vocab.txt')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ee231326643-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-1"><span class="crayon-p"># save list to file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-2"><span class="crayon-e">def </span><span class="crayon-e">save_list</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-3"><span class="crayon-h">	</span><span class="crayon-p"># convert lines to a single blob of text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-4"><span class="crayon-h">	</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'\n'</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">lines</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-5"><span class="crayon-h">	</span><span class="crayon-p"># open file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-6"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'w'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-7"><span class="crayon-h">	</span><span class="crayon-p"># write text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-8"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-9"><span class="crayon-h">	</span><span class="crayon-p"># close file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-10"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-12"><span class="crayon-p"># save tokens to a vocabulary file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ee231326643-13"><span class="crayon-e">save_list</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the min occurrence filter on the vocabulary and saving it to file, you should now have a new file called <em>vocab.txt</em> with only the words we are interested in.</p>
<p>The order of words in your file will differ, but should look something like the following:</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5ef205079451" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">aberdeen
dupe
burt
libido
hamlet
arlene
available
corners
web
columbia
...</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ef205079451-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-1">aberdeen</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-2">dupe</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-3">burt</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-4">libido</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-5">hamlet</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-6">arlene</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-7">available</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-8">corners</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-9">web</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-10">columbia</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ef205079451-11">...</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We are now ready to look at learning features from the reviews.</p>
<h2>3. Train Embedding Layer</h2>
<p>In this section, we will learn a word embedding while training a neural network on the classification problem.</p>
<p>A word embedding is a way of representing text where each word in the
 vocabulary is represented by a real valued vector in a high-dimensional
 space. The vectors are learned in such a way that words that have 
similar meanings will have similar representation in the vector space 
(close in the vector space). This is a more expressive representation 
for text than more classical methods like bag-of-words, where 
relationships between words or tokens are ignored, or forced in bigram 
and trigram approaches.</p>
<p>The real valued vector representation for words can be learned while 
training the neural network. We can do this in the Keras deep learning 
library using the <a href="https://keras.io/layers/embeddings/">Embedding layer</a>.</p>
<p>If you are new to word embeddings, see the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/what-are-word-embeddings/">What Are Word Embeddings for Text?</a></li>
</ul>
<p>If you are new to word embedding layers in Keras, see the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/">How to Use Word Embedding Layers for Deep Learning with Keras</a></li>
</ul>
<p>The first step is to load the vocabulary. We will use&nbsp;it to 
filter out words from movie reviews that we are not interested in.</p>
<p>If you have worked through the previous section, you should have a local file called ‘<em>vocab.txt</em>‘ with one word per line. We can load that file and build a vocabulary as a set for checking the validity of tokens.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f0985534361" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f0985534361-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-1"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-2"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-3"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-4"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-5"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-6"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-7"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-8"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-11"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-12"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-13"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-14"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f0985534361-15"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we need to load all of the training data movie reviews. For that we can adapt the <em>process_docs()</em>
 from the previous section to load the documents, clean them, and return
 them as a list of strings, with one document per string. We want each 
document to be a string for easy encoding as a sequence of integers 
later.</p>
<p>Cleaning the document involves splitting each review based on white 
space, removing punctuation, and then filtering out all tokens not in 
the vocabulary.</p>
<p>The updated <em>clean_doc()</em> function is listed below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f1191866567" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># turn a doc into clean tokens
def clean_doc(doc, vocab):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# filter out tokens not in vocab
	tokens = [w for w in tokens if w in vocab]
	tokens = ' '.join(tokens)
	return tokens</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f1191866567-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-1"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-2"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-3"><span class="crayon-h">	</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-4"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-5"><span class="crayon-h">	</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-6"><span class="crayon-h">	</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-7"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-8"><span class="crayon-h">	</span><span class="crayon-p"># filter out tokens not in vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-9"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-10"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f1191866567-11"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The updated <em>process_docs()</em> can then call the <em>clean_doc()</em> for each document on the ‘<em>pos</em>‘ and ‘<em>neg</em>‘ directories that are in our training dataset.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f2884169544" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load all docs in a directory
def process_docs(directory, vocab, is_trian):
	documents = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load the doc
		doc = load_doc(path)
		# clean doc
		tokens = clean_doc(doc, vocab)
		# add to list
		documents.append(tokens)
	return documents

# load all training reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, True)
negative_docs = process_docs('txt_sentoken/neg', vocab, True)
train_docs = negative_docs + positive_docs</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f2884169544-24">24</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-1"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-2"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-3"><span class="crayon-h">	</span><span class="crayon-v">documents</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-4"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-6"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-7"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-8"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-9"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-10"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-11"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-12"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-13"><span class="crayon-h">		</span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-14"><span class="crayon-h">		</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-15"><span class="crayon-h">		</span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-16"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-17"><span class="crayon-h">		</span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-18"><span class="crayon-h">		</span><span class="crayon-v">documents</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-21"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-22"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-23"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f2884169544-24"><span class="crayon-v">train_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive_docs</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The next step is to encode each document as a sequence of integers.</p>
<p>The Keras Embedding layer requires integer inputs where each integer 
maps to a single token that has a specific real-valued vector 
representation within the embedding. These vectors are random at the 
beginning of training, but during training become meaningful to the 
network.</p>
<p>We can encode the training documents as sequences of integers using the <a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer</a> class in the Keras API.</p>
<p>First, we must construct an instance of the class then train it on 
all documents in the training dataset. In this case, it develops a 
vocabulary of all tokens in the training dataset and develops a 
consistent mapping from words in the vocabulary to unique integers. We 
could just as easily develop this mapping ourselves using our vocabulary
 file.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f3703536344" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
tokenizer.fit_on_texts(train_docs)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f3703536344-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f3703536344-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f3703536344-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f3703536344-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f3703536344-1"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f3703536344-2"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f3703536344-3"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f3703536344-4"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that the mapping of words to integers has been prepared, 
we can use it to encode the reviews in the training dataset. We can do 
that by calling the <em>texts_to_sequences()</em> function on the Tokenizer.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f4611981377" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># sequence encode
encoded_docs = tokenizer.texts_to_sequences(train_docs)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f4611981377-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f4611981377-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f4611981377-1"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f4611981377-2"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We also need to ensure that all documents have the same length.</p>
<p>This is a requirement of Keras for efficient computation. We could 
truncate reviews to the smallest size or zero-pad (pad with the value 
‘0’) reviews to the maximum length, or some hybrid. In this case, we 
will pad all reviews to the length of the longest review in the training
 dataset.</p>
<p>First, we can find the longest review using the <em>max()</em> function on the training dataset and take its length. We can then call the Keras function <em>pad_sequences()</em> to pad the sequences to the maximum length by adding 0 values on the end.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f5208360836" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># pad sequences
max_length = max([len(s.split()) for s in train_docs])
Xtrain = pad_sequences(encoded_docs, maxlen=max_length, padding='post')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f5208360836-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f5208360836-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f5208360836-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f5208360836-1"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f5208360836-2"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train_docs</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f5208360836-3"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Finally, we can define the class labels for the training 
dataset, needed to fit the supervised neural network model to predict 
the sentiment of reviews.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f6608960755" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># define training labels
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f6608960755-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f6608960755-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f6608960755-1"><span class="crayon-p"># define training labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f6608960755-2"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can then encode and pad the test dataset, needed later to evaluate the model after we train it.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f7882060967" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load all test reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, False)
negative_docs = process_docs('txt_sentoken/neg', vocab, False)
test_docs = negative_docs + positive_docs
# sequence encode
encoded_docs = tokenizer.texts_to_sequences(test_docs)
# pad sequences
Xtest = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define test labels
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f7882060967-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-1"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-2"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-3"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-4"><span class="crayon-v">test_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-5"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-6"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">test_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-7"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-8"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-9"><span class="crayon-p"># define test labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f7882060967-10"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We are now ready to define our neural network model.</p>
<p>The model will use an Embedding layer as the first hidden layer. The 
Embedding requires the specification of the vocabulary size, the size of
 the real-valued vector space, and the maximum length of input 
documents.</p>
<p>The vocabulary size is the total number of words in our vocabulary, 
plus one for unknown words. This could be the vocab set length or the 
size of the vocab within the tokenizer used to integer encode the 
documents, for example:</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f8547295520" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># define vocabulary size (largest integer value)
vocab_size = len(tokenizer.word_index) + 1</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f8547295520-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f8547295520-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f8547295520-1"><span class="crayon-p"># define vocabulary size (largest integer value)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f8547295520-2"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We will use a 100-dimensional vector space, but you could try
 other values, such as 50 or 150. Finally, the maximum document length 
was calculated above in the <em>max_length</em> variable used during padding.</p>
<p>The complete model definition is listed below including the Embedding layer.</p>
<p>We use a Convolutional Neural Network (CNN) as they have proven to be
 successful at document classification problems. A conservative CNN 
configuration is used with 32 filters (parallel fields for processing 
words) and a kernel size of 8 with a <a href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/">rectified linear (‘relu’) activation function</a>. This is followed by a pooling layer that reduces the output of the convolutional layer by half.</p>
<p>Next, the 2D output from the CNN part of the model is flattened to 
one long 2D vector to represent the ‘features’ extracted by the CNN. The
 back-end of the model is a standard Multilayer Perceptron layers to 
interpret the CNN features. The output layer uses a sigmoid activation 
function to output a value between 0 and 1 for the negative and positive
 sentiment in the review.</p>
<p>For more advice on effective deep learning model configuration for text classification, see the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/best-practices-document-classification-deep-learning/">Best Practices for Document Classification with Deep Learning</a></li>
</ul>
<p></p>
		<div id="urvanov-syntax-highlighter-6142081c0f5f9138274592" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># define model
model = Sequential()
model.add(Embedding(vocab_size, 100, input_length=max_length))
model.add(Conv1D(filters=32, kernel_size=8, activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(Flatten())
model.add(Dense(10, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
print(model.summary())</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5f9138274592-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-8"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5f9138274592-9"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running just this piece provides a summary of the defined network.</p>
<p>We can see that the Embedding layer expects documents with a length 
of 442 words as input and encodes each word in the document as a 100 
element vector.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5fa137239203" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
embedding_1 (Embedding)      (None, 442, 100)          2576800
_________________________________________________________________
conv1d_1 (Conv1D)            (None, 435, 32)           25632
_________________________________________________________________
max_pooling1d_1 (MaxPooling1 (None, 217, 32)           0
_________________________________________________________________
flatten_1 (Flatten)          (None, 6944)              0
_________________________________________________________________
dense_1 (Dense)              (None, 10)                69450
_________________________________________________________________
dense_2 (Dense)              (None, 1)                 11
=================================================================
Total params: 2,671,893
Trainable params: 2,671,893
Non-trainable params: 0
_________________________________________________________________</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fa137239203-19">19</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-1">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-2">Layer (type)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Output Shape&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Param #</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-3">=================================================================</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-4">embedding_1 (Embedding)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(None, 442, 100)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2576800</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-5">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-6">conv1d_1 (Conv1D)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(None, 435, 32)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 25632</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-7">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-8">max_pooling1d_1 (MaxPooling1 (None, 217, 32)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-9">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-10">flatten_1 (Flatten)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(None, 6944)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-11">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-12">dense_1 (Dense)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(None, 10)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;69450</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-13">_________________________________________________________________</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-14">dense_2 (Dense)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(None, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 11</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-15">=================================================================</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-16">Total params: 2,671,893</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-17">Trainable params: 2,671,893</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-18">Non-trainable params: 0</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fa137239203-19">_________________________________________________________________</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we fit the network on the training data.</p>
<p>We use a binary cross entropy loss function because the problem we 
are learning is a binary classification problem. The efficient Adam 
implementation of stochastic gradient descent is used and we keep track 
of accuracy in addition to loss during training. The model is trained 
for 10 epochs, or 10 passes through the training data.</p>
<p>The network configuration and training schedule were found with a 
little trial and error, but are by no means optimal for this problem. If
 you can get better results with a different configuration, let me know.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5fb377913639" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># compile network
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit network
model.fit(Xtrain, ytrain, epochs=10, verbose=2)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fb377913639-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fb377913639-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fb377913639-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fb377913639-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fb377913639-1"><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fb377913639-2"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fb377913639-3"><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fb377913639-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>After the model is fit, it is evaluated on the test dataset. 
This dataset contains words that we have not seen before and reviews not
 seen during training.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5fc237212984" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># evaluate
loss, acc = model.evaluate(Xtest, ytest, verbose=0)
print('Test Accuracy: %f' % (acc*100))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fc237212984-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fc237212984-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fc237212984-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fc237212984-1"><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fc237212984-2"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fc237212984-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can tie all of this together.</p>
<p>The complete code listing is provided below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5fd682859897" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">from string import punctuation
from os import listdir
from numpy import array
from keras.preprocessing.text import Tokenizer
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import Embedding
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc, vocab):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# filter out tokens not in vocab
	tokens = [w for w in tokens if w in vocab]
	tokens = ' '.join(tokens)
	return tokens

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	documents = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load the doc
		doc = load_doc(path)
		# clean doc
		tokens = clean_doc(doc, vocab)
		# add to list
		documents.append(tokens)
	return documents

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)

# load all training reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, True)
negative_docs = process_docs('txt_sentoken/neg', vocab, True)
train_docs = negative_docs + positive_docs

# create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
tokenizer.fit_on_texts(train_docs)

# sequence encode
encoded_docs = tokenizer.texts_to_sequences(train_docs)
# pad sequences
max_length = max([len(s.split()) for s in train_docs])
Xtrain = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define training labels
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])

# load all test reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, False)
negative_docs = process_docs('txt_sentoken/neg', vocab, False)
test_docs = negative_docs + positive_docs
# sequence encode
encoded_docs = tokenizer.texts_to_sequences(test_docs)
# pad sequences
Xtest = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define test labels
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])

# define vocabulary size (largest integer value)
vocab_size = len(tokenizer.word_index) + 1

# define model
model = Sequential()
model.add(Embedding(vocab_size, 100, input_length=max_length))
model.add(Conv1D(filters=32, kernel_size=8, activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(Flatten())
model.add(Dense(10, activation='relu'))
model.add(Dense(1, activation='sigmoid'))
print(model.summary())
# compile network
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit network
model.fit(Xtrain, ytrain, epochs=10, verbose=2)
# evaluate
loss, acc = model.evaluate(Xtest, ytest, verbose=0)
print('Test Accuracy: %f' % (acc*100))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fd682859897-108">108</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv1D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-i">MaxPooling1D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-13"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-14"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-15"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-16"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-17"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-18"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-19"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-20"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-21"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-23"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-24"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-25"><span class="crayon-h">	</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-26"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-27"><span class="crayon-h">	</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-28"><span class="crayon-h">	</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-29"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-30"><span class="crayon-h">	</span><span class="crayon-p"># filter out tokens not in vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-31"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-32"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-33"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-35"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-36"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-37"><span class="crayon-h">	</span><span class="crayon-v">documents</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-38"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-39"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-40"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-41"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-42"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-43"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-44"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-45"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-46"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-47"><span class="crayon-h">		</span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-48"><span class="crayon-h">		</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-49"><span class="crayon-h">		</span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-50"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-51"><span class="crayon-h">		</span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-52"><span class="crayon-h">		</span><span class="crayon-v">documents</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-53"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-54">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-55"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-56"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-57"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-58"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-59"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-61"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-62"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-63"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-64"><span class="crayon-v">train_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-66"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-67"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-68"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-69"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-70">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-71"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-72"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-73"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-74"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train_docs</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-75"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-76"><span class="crayon-p"># define training labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-77"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-78">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-79"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-80"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-81"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-82"><span class="crayon-v">test_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-83"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-84"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">test_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-85"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-86"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-87"><span class="crayon-p"># define test labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-88"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-90"><span class="crayon-p"># define vocabulary size (largest integer value)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-91"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-92">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-93"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-94"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-95"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-96"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-97"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-98"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-99"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-100"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-101"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-102"><span class="crayon-p"># compile network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-103"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-104"><span class="crayon-p"># fit network</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-105"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-106"><span class="crayon-p"># evaluate</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-107"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fd682859897-108"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example prints the loss and accuracy at the end of each training epoch.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a>
 given the stochastic nature of the algorithm or evaluation procedure, 
or differences in numerical precision. Consider running the example a 
few times and compare the average outcome.</p>

<p>We can see that the model very quickly achieves 100% accuracy on the 
training dataset. At the end of the run, the model achieves an accuracy 
of 84.5% on the test dataset, which is a great score.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5fe135937863" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">...
Epoch 6/10
2s - loss: 0.0013 - acc: 1.0000
Epoch 7/10
2s - loss: 8.4573e-04 - acc: 1.0000
Epoch 8/10
2s - loss: 5.8323e-04 - acc: 1.0000
Epoch 9/10
2s - loss: 4.3155e-04 - acc: 1.0000
Epoch 10/10
2s - loss: 3.3083e-04 - acc: 1.0000
Test Accuracy: 84.500000</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5fe135937863-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-1">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-2">Epoch 6/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-3">2s - loss: 0.0013 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-4">Epoch 7/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-5">2s - loss: 8.4573e-04 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-6">Epoch 8/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-7">2s - loss: 5.8323e-04 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-8">Epoch 9/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-9">2s - loss: 4.3155e-04 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-10">Epoch 10/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-11">2s - loss: 3.3083e-04 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5fe135937863-12">Test Accuracy: 84.500000</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We have just seen an example of how we can learn a word embedding as part of fitting a neural network model.</p>
<p>Next, let’s look at how we can efficiently learn a standalone embedding that we could later use in our neural network.</p>
<h2>4. Train word2vec Embedding</h2>
<p>In this section, we will discover how to learn a standalone word embedding using an efficient algorithm called word2vec.</p>
<p>A downside of learning a word embedding as part of the network is 
that it can be very slow, especially for very large text datasets.</p>
<p>The word2vec algorithm is an approach to learning a word embedding 
from a text corpus in a standalone way. The benefit of the method is 
that it can produce high-quality word embeddings very efficiently, in 
terms of space and time complexity.</p>
<p>The first step is to prepare the documents ready for learning the embedding.</p>
<p>This involves the same data cleaning steps from the previous section,
 namely splitting documents by their white space, removing punctuation, 
and filtering out tokens not in the vocabulary.</p>
<p>The word2vec algorithm processes documents sentence by sentence. This
 means we will preserve the sentence-based structure during cleaning.</p>
<p>We start by loading the vocabulary, as before.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f5ff426839134" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f5ff426839134-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-1"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-2"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-3"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-4"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-5"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-6"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-7"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-8"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-11"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-12"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-13"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-14"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f5ff426839134-15"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we define a function named <em>doc_to_clean_lines()</em> to clean a loaded document line by line and return a list of the cleaned lines.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f600672443342" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># turn a doc into clean tokens
def doc_to_clean_lines(doc, vocab):
	clean_lines = list()
	lines = doc.splitlines()
	for line in lines:
		# split into tokens by white space
		tokens = line.split()
		# remove punctuation from each token
		table = str.maketrans('', '', punctuation)
		tokens = [w.translate(table) for w in tokens]
		# filter out tokens not in vocab
		tokens = [w for w in tokens if w in vocab]
		clean_lines.append(tokens)
	return clean_lines</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f600672443342-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-1"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-2"><span class="crayon-e">def </span><span class="crayon-e">doc_to_clean_lines</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-3"><span class="crayon-h">	</span><span class="crayon-v">clean_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-4"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">splitlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-6"><span class="crayon-h">		</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-7"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-8"><span class="crayon-h">		</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-9"><span class="crayon-h">		</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-10"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-11"><span class="crayon-h">		</span><span class="crayon-p"># filter out tokens not in vocab</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-12"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-13"><span class="crayon-h">		</span><span class="crayon-v">clean_lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f600672443342-14"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">clean_lines</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, we adapt the process_docs() function to load and clean 
all of the documents in a folder and return a list of all document 
lines.</p>
<p>The results from this function will be the training data for the word2vec model.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f601963903818" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load all docs in a directory
def process_docs(directory, vocab, is_trian):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		doc = load_doc(path)
		doc_lines = doc_to_clean_lines(doc, vocab)
		# add lines to list
		lines += doc_lines
	return lines</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f601963903818-18">18</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-1"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-2"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-3"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-4"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-6"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-7"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-8"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-9"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-10"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-11"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-12"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-13"><span class="crayon-h">		</span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-14"><span class="crayon-h">		</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-15"><span class="crayon-h">		</span><span class="crayon-v">doc_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_clean_lines</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-16"><span class="crayon-h">		</span><span class="crayon-p"># add lines to list</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-17"><span class="crayon-h">		</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">doc_lines</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f601963903818-18"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">lines</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can then load all of the training data and convert it into
 a long list of ‘sentences’ (lists of tokens) ready for fitting the 
word2vec model.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f602462307400" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load training data
positive_docs = process_docs('txt_sentoken/pos', vocab, True)
negative_docs = process_docs('txt_sentoken/neg', vocab, True)
sentences = negative_docs + positive_docs
print('Total training sentences: %d' % len(sentences))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f602462307400-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f602462307400-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f602462307400-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f602462307400-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f602462307400-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f602462307400-1"><span class="crayon-p"># load training data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f602462307400-2"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f602462307400-3"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f602462307400-4"><span class="crayon-v">sentences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">positive_docs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f602462307400-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Total training sentences: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We will use the word2vec implementation provided in the Gensim Python library. Specifically the <a href="https://radimrehurek.com/gensim/models/word2vec.html">Word2Vec class</a>.</p>
<p>For more on training a standalone word embedding with Gensim, see the post:</p>
<ul>
<li><a href="https://machinelearningmastery.com/develop-word-embeddings-python-gensim/">How to Develop Word Embeddings in Python with Gensim</a></li>
</ul>
<p>The model is fit when constructing the class. We pass in the list of 
clean sentences from the training data, then specify the size of the 
embedding vector space (we use 100 again), the number of neighboring 
words to look at when learning how to embed each word in the training 
sentences (we use 5 neighbors), the number of threads to use when 
fitting the model (we use 8, but change this if you have more or 
less&nbsp;CPU cores), and the minimum occurrence count for words to 
consider in the vocabulary (we set this to 1 as we have already prepared
 the vocabulary).</p>
<p>After the model is fit, we print the size of the learned vocabulary, 
which should match the size of our vocabulary in vocab.txt of 25,767 
tokens.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f608760294793" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># train word2vec model
model = Word2Vec(sentences, size=100, window=5, workers=8, min_count=1)
# summarize vocabulary size in model
words = list(model.wv.vocab)
print('Vocabulary size: %d' % len(words))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f608760294793-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f608760294793-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f608760294793-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f608760294793-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f608760294793-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f608760294793-1"><span class="crayon-p"># train word2vec model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f608760294793-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Word2Vec</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">workers</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_count</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f608760294793-3"><span class="crayon-p"># summarize vocabulary size in model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f608760294793-4"><span class="crayon-v">words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">wv</span><span class="crayon-sy">.</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f608760294793-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Vocabulary size: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">words</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Finally, we save the learned embedding vectors to file using the <a href="https://radimrehurek.com/gensim/models/keyedvectors.html">save_word2vec_format()</a> on the model’s ‘<em>wv</em>‘ (word vector) attribute. The embedding is saved in ASCII format with one word and vector per line.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f609290602979" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">from string import punctuation
from os import listdir
from gensim.models import Word2Vec

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def doc_to_clean_lines(doc, vocab):
	clean_lines = list()
	lines = doc.splitlines()
	for line in lines:
		# split into tokens by white space
		tokens = line.split()
		# remove punctuation from each token
		table = str.maketrans('', '', punctuation)
		tokens = [w.translate(table) for w in tokens]
		# filter out tokens not in vocab
		tokens = [w for w in tokens if w in vocab]
		clean_lines.append(tokens)
	return clean_lines

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	lines = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load and clean the doc
		doc = load_doc(path)
		doc_lines = doc_to_clean_lines(doc, vocab)
		# add lines to list
		lines += doc_lines
	return lines

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)

# load training data
positive_docs = process_docs('txt_sentoken/pos', vocab, True)
negative_docs = process_docs('txt_sentoken/neg', vocab, True)
sentences = negative_docs + positive_docs
print('Total training sentences: %d' % len(sentences))

# train word2vec model
model = Word2Vec(sentences, size=100, window=5, workers=8, min_count=1)
# summarize vocabulary size in model
words = list(model.wv.vocab)
print('Vocabulary size: %d' % len(words))

# save model in ASCII (word2vec) format
filename = 'embedding_word2vec.txt'
model.wv.save_word2vec_format(filename, binary=False)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f609290602979-69">69</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-3"><span class="crayon-e">from </span><span class="crayon-v">gensim</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-i">Word2Vec</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-5"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-6"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-7"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-8"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-9"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-10"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-11"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-12"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-15"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-16"><span class="crayon-e">def </span><span class="crayon-e">doc_to_clean_lines</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-17"><span class="crayon-h">	</span><span class="crayon-v">clean_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-18"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">splitlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-19"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-20"><span class="crayon-h">		</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-21"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-22"><span class="crayon-h">		</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-23"><span class="crayon-h">		</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-24"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-25"><span class="crayon-h">		</span><span class="crayon-p"># filter out tokens not in vocab</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-26"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-27"><span class="crayon-h">		</span><span class="crayon-v">clean_lines</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-28"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">clean</span><span class="crayon-sy">_</span>lines</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-30"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-31"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-32"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-33"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-34"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-35"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-36"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-37"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-38"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-39"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-40"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-41"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-42"><span class="crayon-h">		</span><span class="crayon-p"># load and clean the doc</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-43"><span class="crayon-h">		</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-44"><span class="crayon-h">		</span><span class="crayon-v">doc_lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">doc_to_clean_lines</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-45"><span class="crayon-h">		</span><span class="crayon-p"># add lines to list</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-46"><span class="crayon-h">		</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">doc_lines</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-47"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">lines</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-48">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-49"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-50"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-51"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-52"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-53"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-54">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-55"><span class="crayon-p"># load training data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-56"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-57"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-58"><span class="crayon-v">sentences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">positive_docs</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-59"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Total training sentences: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-61"><span class="crayon-p"># train word2vec model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-62"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Word2Vec</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">window</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">workers</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">min_count</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-63"><span class="crayon-p"># summarize vocabulary size in model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-64"><span class="crayon-v">words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">wv</span><span class="crayon-sy">.</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-65"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Vocabulary size: %d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">words</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-66">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-67"><span class="crayon-p"># save model in ASCII (word2vec) format</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-68"><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'embedding_word2vec.txt'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f609290602979-69"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">wv</span><span class="crayon-sy">.</span><span class="crayon-e">save_word2vec_format</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">binary</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example loads 58,109 sentences from the training data and creates an embedding for a vocabulary of 25,767 words.</p>
<p>You should now have a file ’embedding_word2vec.txt’ with the learned vectors in your current working directory.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f60a585366627" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Total training sentences: 58109
Vocabulary size: 25767</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60a585366627-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60a585366627-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60a585366627-1">Total training sentences: 58109</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60a585366627-2">Vocabulary size: 25767</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Next, let’s look at using these learned vectors in our model.</p>
<h2>5. Use Pre-trained Embedding</h2>
<p>In this section, we will use a pre-trained word embedding prepared on a very large text corpus.</p>
<p>We can use the pre-trained word embedding developed in the previous 
section and the CNN model developed in the section before that.</p>
<p>The first step is to load the word embedding as a directory of words to vectors. The word embedding was saved in so-called ‘<em>word2vec</em>‘ format that contains a header line. We will skip this header line when loading the embedding.</p>
<p>The function below named <em>load_embedding()</em> loads the embedding and returns a directory of words mapped to the vectors in NumPy format.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f60b231349128" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load embedding as a dict
def load_embedding(filename):
	# load embedding into memory, skip first line
	file = open(filename,'r')
	lines = file.readlines()[1:]
	file.close()
	# create a map of words to vectors
	embedding = dict()
	for line in lines:
		parts = line.split()
		# key is string word, value is numpy array for vector
		embedding[parts[0]] = asarray(parts[1:], dtype='float32')
	return embedding</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60b231349128-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-1"><span class="crayon-p"># load embedding as a dict</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-2"><span class="crayon-e">def </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-3"><span class="crayon-h">	</span><span class="crayon-p"># load embedding into memory, skip first line</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-4"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-5"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">readlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-6"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-7"><span class="crayon-h">	</span><span class="crayon-p"># create a map of words to vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-8"><span class="crayon-h">	</span><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-9"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-10"><span class="crayon-h">		</span><span class="crayon-v">parts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-11"><span class="crayon-h">		</span><span class="crayon-p"># key is string word, value is numpy array for vector</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-12"><span class="crayon-h">		</span><span class="crayon-v">embedding</span><span class="crayon-sy">[</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60b231349128-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">embedding</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now that we have all of the vectors in memory, we can order 
them in such a way as to match the integer encoding prepared by the 
Keras Tokenizer.</p>
<p>Recall that we integer encode the review documents prior to passing 
them to the Embedding layer. The integer maps to the index of a specific
 vector in the embedding layer. Therefore, it is important that we lay 
the vectors out in the Embedding layer such that the encoded words map 
to the correct vector.</p>
<p>Below defines a function <em>get_weight_matrix()</em> that takes the 
loaded embedding and the tokenizer.word_index vocabulary as arguments 
and returns a matrix with the word vectors in the correct locations.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f60c092596802" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># create a weight matrix for the Embedding layer from a loaded embedding
def get_weight_matrix(embedding, vocab):
	# total vocabulary size plus 0 for unknown words
	vocab_size = len(vocab) + 1
	# define weight matrix dimensions with all 0
	weight_matrix = zeros((vocab_size, 100))
	# step vocab, store vectors using the Tokenizer's integer mapping
	for word, i in vocab.items():
		weight_matrix[i] = embedding.get(word)
	return weight_matrix</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60c092596802-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-1"><span class="crayon-p"># create a weight matrix for the Embedding layer from a loaded embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-2"><span class="crayon-e">def </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-3"><span class="crayon-h">	</span><span class="crayon-p"># total vocabulary size plus 0 for unknown words</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-4"><span class="crayon-h">	</span><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-5"><span class="crayon-h">	</span><span class="crayon-p"># define weight matrix dimensions with all 0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-6"><span class="crayon-h">	</span><span class="crayon-v">weight_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-7"><span class="crayon-h">	</span><span class="crayon-p"># step vocab, store vectors using the Tokenizer's integer mapping</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-9"><span class="crayon-h">		</span><span class="crayon-v">weight_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60c092596802-10"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">weight_matrix</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Now we can use these functions to create our new Embedding layer for our model.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f60d463834671" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">...
# load embedding from file
raw_embedding = load_embedding('embedding_word2vec.txt')
# get vectors in the right order
embedding_vectors = get_weight_matrix(raw_embedding, tokenizer.word_index)
# create the embedding layer
embedding_layer = Embedding(vocab_size, 100, weights=[embedding_vectors], input_length=max_length, trainable=False)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60d463834671-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-1"><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-2"><span class="crayon-p"># load embedding from file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-3"><span class="crayon-v">raw_embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-s">'embedding_word2vec.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-4"><span class="crayon-p"># get vectors in the right order</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-5"><span class="crayon-v">embedding_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">raw_embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-6"><span class="crayon-p"># create the embedding layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60d463834671-7"><span class="crayon-v">embedding_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_vectors</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Note that the prepared weight matrix <em>embedding_vectors</em> is passed to the new Embedding layer as an argument and that we set the ‘<em>trainable</em>‘ argument to ‘<em>False</em>‘ to ensure that the network does not try to adapt the pre-learned vectors as part of training the network.</p>
<p>We can now add this layer to our model. We also have a slightly 
different model configuration with a lot more filters (128) in the CNN 
model and a kernel that matches the 5 words used as neighbors when 
developing the word2vec embedding. Finally, the back-end of the model 
was simplified.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f60e422676977" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># define model
model = Sequential()
model.add(embedding_layer)
model.add(Conv1D(filters=128, kernel_size=5, activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
print(model.summary())</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60e422676977-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-1"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">embedding_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-5"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-6"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-7"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60e422676977-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>These changes were found with a little trial and error.</p>
<p>The complete code listing is provided below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f60f615773025" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">from string import punctuation
from os import listdir
from numpy import array
from numpy import asarray
from numpy import zeros
from keras.preprocessing.text import Tokenizer
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import Embedding
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc, vocab):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# filter out tokens not in vocab
	tokens = [w for w in tokens if w in vocab]
	tokens = ' '.join(tokens)
	return tokens

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	documents = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load the doc
		doc = load_doc(path)
		# clean doc
		tokens = clean_doc(doc, vocab)
		# add to list
		documents.append(tokens)
	return documents

# load embedding as a dict
def load_embedding(filename):
	# load embedding into memory, skip first line
	file = open(filename,'r')
	lines = file.readlines()[1:]
	file.close()
	# create a map of words to vectors
	embedding = dict()
	for line in lines:
		parts = line.split()
		# key is string word, value is numpy array for vector
		embedding[parts[0]] = asarray(parts[1:], dtype='float32')
	return embedding

# create a weight matrix for the Embedding layer from a loaded embedding
def get_weight_matrix(embedding, vocab):
	# total vocabulary size plus 0 for unknown words
	vocab_size = len(vocab) + 1
	# define weight matrix dimensions with all 0
	weight_matrix = zeros((vocab_size, 100))
	# step vocab, store vectors using the Tokenizer's integer mapping
	for word, i in vocab.items():
		weight_matrix[i] = embedding.get(word)
	return weight_matrix

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)

# load all training reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, True)
negative_docs = process_docs('txt_sentoken/neg', vocab, True)
train_docs = negative_docs + positive_docs

# create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
tokenizer.fit_on_texts(train_docs)

# sequence encode
encoded_docs = tokenizer.texts_to_sequences(train_docs)
# pad sequences
max_length = max([len(s.split()) for s in train_docs])
Xtrain = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define training labels
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])

# load all test reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, False)
negative_docs = process_docs('txt_sentoken/neg', vocab, False)
test_docs = negative_docs + positive_docs
# sequence encode
encoded_docs = tokenizer.texts_to_sequences(test_docs)
# pad sequences
Xtest = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define test labels
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])

# define vocabulary size (largest integer value)
vocab_size = len(tokenizer.word_index) + 1

# load embedding from file
raw_embedding = load_embedding('embedding_word2vec.txt')
# get vectors in the right order
embedding_vectors = get_weight_matrix(raw_embedding, tokenizer.word_index)
# create the embedding layer
embedding_layer = Embedding(vocab_size, 100, weights=[embedding_vectors], input_length=max_length, trainable=False)

# define model
model = Sequential()
model.add(embedding_layer)
model.add(Conv1D(filters=128, kernel_size=5, activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
print(model.summary())
# compile network
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit network
model.fit(Xtrain, ytrain, epochs=10, verbose=2)
# evaluate
loss, acc = model.evaluate(Xtest, ytest, verbose=0)
print('Test Accuracy: %f' % (acc*100))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f60f615773025-141">141</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv1D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-i">MaxPooling1D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-15"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-16"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-17"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-18"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-19"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-20"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-21"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-22"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-23"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-25"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-26"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-27"><span class="crayon-h">	</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-28"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-29"><span class="crayon-h">	</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-30"><span class="crayon-h">	</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-31"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-32"><span class="crayon-h">	</span><span class="crayon-p"># filter out tokens not in vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-33"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-34"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-35"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-36">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-37"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-38"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-39"><span class="crayon-h">	</span><span class="crayon-v">documents</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-40"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-41"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-42"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-43"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-44"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-45"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-46"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-47"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-48"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-49"><span class="crayon-h">		</span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-50"><span class="crayon-h">		</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-51"><span class="crayon-h">		</span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-52"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-53"><span class="crayon-h">		</span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-54"><span class="crayon-h">		</span><span class="crayon-v">documents</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-55"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-56">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-57"><span class="crayon-p"># load embedding as a dict</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-58"><span class="crayon-e">def </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-59"><span class="crayon-h">	</span><span class="crayon-p"># load embedding into memory, skip first line</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-60"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-61"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">readlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-62"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-63"><span class="crayon-h">	</span><span class="crayon-p"># create a map of words to vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-64"><span class="crayon-h">	</span><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-65"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-66"><span class="crayon-h">		</span><span class="crayon-v">parts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-67"><span class="crayon-h">		</span><span class="crayon-p"># key is string word, value is numpy array for vector</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-68"><span class="crayon-h">		</span><span class="crayon-v">embedding</span><span class="crayon-sy">[</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-69"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-70">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-71"><span class="crayon-p"># create a weight matrix for the Embedding layer from a loaded embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-72"><span class="crayon-e">def </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-73"><span class="crayon-h">	</span><span class="crayon-p"># total vocabulary size plus 0 for unknown words</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-74"><span class="crayon-h">	</span><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-75"><span class="crayon-h">	</span><span class="crayon-p"># define weight matrix dimensions with all 0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-76"><span class="crayon-h">	</span><span class="crayon-v">weight_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-77"><span class="crayon-h">	</span><span class="crayon-p"># step vocab, store vectors using the Tokenizer's integer mapping</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-78"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-79"><span class="crayon-h">		</span><span class="crayon-v">weight_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-80"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">weight</span><span class="crayon-sy">_</span>matrix</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-82"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-83"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-84"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-85"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-86"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-87">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-88"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-89"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-90"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-91"><span class="crayon-v">train_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-92">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-93"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-94"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-95"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-96"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-97">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-98"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-99"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-100"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-101"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train_docs</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-102"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-103"><span class="crayon-p"># define training labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-104"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-105">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-106"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-107"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-108"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-109"><span class="crayon-v">test_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-110"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-111"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">test_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-112"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-113"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-114"><span class="crayon-p"># define test labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-115"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-116">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-117"><span class="crayon-p"># define vocabulary size (largest integer value)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-118"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-119">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-120"><span class="crayon-p"># load embedding from file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-121"><span class="crayon-v">raw_embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-s">'embedding_word2vec.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-122"><span class="crayon-p"># get vectors in the right order</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-123"><span class="crayon-v">embedding_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">raw_embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-124"><span class="crayon-p"># create the embedding layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-125"><span class="crayon-v">embedding_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_vectors</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-126">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-127"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-128"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-129"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">embedding_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-130"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-131"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-132"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-133"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-134"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-135"><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-136"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-137"><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-138"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-139"><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-140"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f60f615773025-141"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example shows that performance was not improved.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a>
 given the stochastic nature of the algorithm or evaluation procedure, 
or differences in numerical precision. Consider running the example a 
few times and compare the average outcome.</p>

<p>In fact, performance was a lot worse. The results show that the 
training dataset was learned successfully, but evaluation on the test 
dataset was very poor, at just above 50% accuracy.</p>
<p>The cause of the poor test performance may be because of the chosen 
word2vec configuration or the chosen neural network configuration.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f610363492553" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">...
Epoch 6/10
2s - loss: 0.3306 - acc: 0.8778
Epoch 7/10
2s - loss: 0.2888 - acc: 0.8917
Epoch 8/10
2s - loss: 0.1878 - acc: 0.9439
Epoch 9/10
2s - loss: 0.1255 - acc: 0.9750
Epoch 10/10
2s - loss: 0.0812 - acc: 0.9928
Test Accuracy: 53.000000</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f610363492553-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-1">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-2">Epoch 6/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-3">2s - loss: 0.3306 - acc: 0.8778</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-4">Epoch 7/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-5">2s - loss: 0.2888 - acc: 0.8917</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-6">Epoch 8/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-7">2s - loss: 0.1878 - acc: 0.9439</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-8">Epoch 9/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-9">2s - loss: 0.1255 - acc: 0.9750</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-10">Epoch 10/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-11">2s - loss: 0.0812 - acc: 0.9928</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f610363492553-12">Test Accuracy: 53.000000</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>The weights in the embedding layer can be used as a starting 
point for the network, and adapted during the training of the network. 
We can do this by setting ‘<em>trainable=True</em>‘ (the default) in the creation of the embedding layer.</p>
<p>Repeating the experiment with this change shows slightly better results, but still poor.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a>
 given the stochastic nature of the algorithm or evaluation procedure, 
or differences in numerical precision. Consider running the example a 
few times and compare the average outcome.</p>

<p>I would encourage you to explore alternate configurations of the 
embedding and network to see if you can do better. Let me know how you 
do.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f611118031887" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: 0px; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">...
Epoch 6/10
4s - loss: 0.0950 - acc: 0.9917
Epoch 7/10
4s - loss: 0.0355 - acc: 0.9983
Epoch 8/10
4s - loss: 0.0158 - acc: 1.0000
Epoch 9/10
4s - loss: 0.0080 - acc: 1.0000
Epoch 10/10
4s - loss: 0.0050 - acc: 1.0000
Test Accuracy: 57.500000</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f611118031887-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-1">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-2">Epoch 6/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-3">4s - loss: 0.0950 - acc: 0.9917</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-4">Epoch 7/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-5">4s - loss: 0.0355 - acc: 0.9983</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-6">Epoch 8/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-7">4s - loss: 0.0158 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-8">Epoch 9/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-9">4s - loss: 0.0080 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-10">Epoch 10/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-11">4s - loss: 0.0050 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f611118031887-12">Test Accuracy: 57.500000</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>It is possible to use pre-trained word vectors prepared on very large corpora of text data.</p>
<p>For example, both Google and Stanford provide pre-trained word 
vectors that you can download, trained with the efficient word2vec and 
GloVe methods respectively.</p>
<p>Let’s try to use pre-trained vectors in our model.</p>
<p>You can download <a href="https://nlp.stanford.edu/projects/glove/">pre-trained GloVe vectors</a> from the Stanford webpage. Specifically, vectors trained on Wikipedia data:</p>
<ul>
<li><a href="http://nlp.stanford.edu/data/glove.6B.zip">glove.6B.zip</a> (822 Megabyte download)</li>
</ul>
<p>Unzipping the file, you will find pre-trained embeddings for various 
different dimensions. We will load the 100 dimension version in the file
 ‘<em>glove.6B.100d.txt</em>‘</p>
<p>The Glove file does not contain a header file, so we do not need to 
skip the first line when loading the embedding into memory. The updated <em>load_embedding()</em> function is listed below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f612140093227" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load embedding as a dict
def load_embedding(filename):
	# load embedding into memory, skip first line
	file = open(filename,'r')
	lines = file.readlines()
	file.close()
	# create a map of words to vectors
	embedding = dict()
	for line in lines:
		parts = line.split()
		# key is string word, value is numpy array for vector
		embedding[parts[0]] = asarray(parts[1:], dtype='float32')
	return embedding</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f612140093227-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-1"><span class="crayon-p"># load embedding as a dict</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-2"><span class="crayon-e">def </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-3"><span class="crayon-h">	</span><span class="crayon-p"># load embedding into memory, skip first line</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-4"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-5"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">readlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-6"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-7"><span class="crayon-h">	</span><span class="crayon-p"># create a map of words to vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-8"><span class="crayon-h">	</span><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-9"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-10"><span class="crayon-h">		</span><span class="crayon-v">parts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-11"><span class="crayon-h">		</span><span class="crayon-p"># key is string word, value is numpy array for vector</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-12"><span class="crayon-h">		</span><span class="crayon-v">embedding</span><span class="crayon-sy">[</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f612140093227-13"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">embedding</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>It is possible that the loaded embedding does not contain all
 of the words in our chosen vocabulary. As such, when creating the 
Embedding weight matrix, we need to skip words that do not have a 
corresponding vector in the loaded GloVe data. Below is the updated, 
more defensive version of the <em>get_weight_matrix()</em> function.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f613411498881" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># create a weight matrix for the Embedding layer from a loaded embedding
def get_weight_matrix(embedding, vocab):
	# total vocabulary size plus 0 for unknown words
	vocab_size = len(vocab) + 1
	# define weight matrix dimensions with all 0
	weight_matrix = zeros((vocab_size, 100))
	# step vocab, store vectors using the Tokenizer's integer mapping
	for word, i in vocab.items():
		vector = embedding.get(word)
		if vector is not None:
			weight_matrix[i] = vector
	return weight_matrix</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f613411498881-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-1"><span class="crayon-p"># create a weight matrix for the Embedding layer from a loaded embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-2"><span class="crayon-e">def </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-3"><span class="crayon-h">	</span><span class="crayon-p"># total vocabulary size plus 0 for unknown words</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-4"><span class="crayon-h">	</span><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-5"><span class="crayon-h">	</span><span class="crayon-p"># define weight matrix dimensions with all 0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-6"><span class="crayon-h">	</span><span class="crayon-v">weight_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-7"><span class="crayon-h">	</span><span class="crayon-p"># step vocab, store vectors using the Tokenizer's integer mapping</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-8"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-9"><span class="crayon-h">		</span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-10"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">vector </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-11"><span class="crayon-h">			</span><span class="crayon-v">weight_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vector</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f613411498881-12"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">weight_matrix</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We can now load the GloVe embedding and create the Embedding layer as before.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f614262704291" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># load embedding from file
raw_embedding = load_embedding('glove.6B.100d.txt')
# get vectors in the right order
embedding_vectors = get_weight_matrix(raw_embedding, tokenizer.word_index)
# create the embedding layer
embedding_layer = Embedding(vocab_size, 100, weights=[embedding_vectors], input_length=max_length, trainable=False)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f614262704291-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f614262704291-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f614262704291-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f614262704291-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f614262704291-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f614262704291-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f614262704291-1"><span class="crayon-p"># load embedding from file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f614262704291-2"><span class="crayon-v">raw_embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-s">'glove.6B.100d.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f614262704291-3"><span class="crayon-p"># get vectors in the right order</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f614262704291-4"><span class="crayon-v">embedding_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">raw_embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f614262704291-5"><span class="crayon-p"># create the embedding layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f614262704291-6"><span class="crayon-v">embedding_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_vectors</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>We will use the same model as before.</p>
<p>The complete example is listed below.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f615082037315" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">from string import punctuation
from os import listdir
from numpy import array
from numpy import asarray
from numpy import zeros
from keras.preprocessing.text import Tokenizer
from keras.preprocessing.sequence import pad_sequences
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Flatten
from keras.layers import Embedding
from keras.layers.convolutional import Conv1D
from keras.layers.convolutional import MaxPooling1D

# load doc into memory
def load_doc(filename):
	# open the file as read only
	file = open(filename, 'r')
	# read all text
	text = file.read()
	# close the file
	file.close()
	return text

# turn a doc into clean tokens
def clean_doc(doc, vocab):
	# split into tokens by white space
	tokens = doc.split()
	# remove punctuation from each token
	table = str.maketrans('', '', punctuation)
	tokens = [w.translate(table) for w in tokens]
	# filter out tokens not in vocab
	tokens = [w for w in tokens if w in vocab]
	tokens = ' '.join(tokens)
	return tokens

# load all docs in a directory
def process_docs(directory, vocab, is_trian):
	documents = list()
	# walk through all files in the folder
	for filename in listdir(directory):
		# skip any reviews in the test set
		if is_trian and filename.startswith('cv9'):
			continue
		if not is_trian and not filename.startswith('cv9'):
			continue
		# create the full path of the file to open
		path = directory + '/' + filename
		# load the doc
		doc = load_doc(path)
		# clean doc
		tokens = clean_doc(doc, vocab)
		# add to list
		documents.append(tokens)
	return documents

# load embedding as a dict
def load_embedding(filename):
	# load embedding into memory, skip first line
	file = open(filename,'r')
	lines = file.readlines()
	file.close()
	# create a map of words to vectors
	embedding = dict()
	for line in lines:
		parts = line.split()
		# key is string word, value is numpy array for vector
		embedding[parts[0]] = asarray(parts[1:], dtype='float32')
	return embedding

# create a weight matrix for the Embedding layer from a loaded embedding
def get_weight_matrix(embedding, vocab):
	# total vocabulary size plus 0 for unknown words
	vocab_size = len(vocab) + 1
	# define weight matrix dimensions with all 0
	weight_matrix = zeros((vocab_size, 100))
	# step vocab, store vectors using the Tokenizer's integer mapping
	for word, i in vocab.items():
		vector = embedding.get(word)
		if vector is not None:
			weight_matrix[i] = vector
	return weight_matrix

# load the vocabulary
vocab_filename = 'vocab.txt'
vocab = load_doc(vocab_filename)
vocab = vocab.split()
vocab = set(vocab)

# load all training reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, True)
negative_docs = process_docs('txt_sentoken/neg', vocab, True)
train_docs = negative_docs + positive_docs

# create the tokenizer
tokenizer = Tokenizer()
# fit the tokenizer on the documents
tokenizer.fit_on_texts(train_docs)

# sequence encode
encoded_docs = tokenizer.texts_to_sequences(train_docs)
# pad sequences
max_length = max([len(s.split()) for s in train_docs])
Xtrain = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define training labels
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])

# load all test reviews
positive_docs = process_docs('txt_sentoken/pos', vocab, False)
negative_docs = process_docs('txt_sentoken/neg', vocab, False)
test_docs = negative_docs + positive_docs
# sequence encode
encoded_docs = tokenizer.texts_to_sequences(test_docs)
# pad sequences
Xtest = pad_sequences(encoded_docs, maxlen=max_length, padding='post')
# define test labels
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])

# define vocabulary size (largest integer value)
vocab_size = len(tokenizer.word_index) + 1

# load embedding from file
raw_embedding = load_embedding('glove.6B.100d.txt')
# get vectors in the right order
embedding_vectors = get_weight_matrix(raw_embedding, tokenizer.word_index)
# create the embedding layer
embedding_layer = Embedding(vocab_size, 100, weights=[embedding_vectors], input_length=max_length, trainable=False)

# define model
model = Sequential()
model.add(embedding_layer)
model.add(Conv1D(filters=128, kernel_size=5, activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(Flatten())
model.add(Dense(1, activation='sigmoid'))
print(model.summary())
# compile network
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
# fit network
model.fit(Xtrain, ytrain, epochs=10, verbose=2)
# evaluate
loss, acc = model.evaluate(Xtest, ytest, verbose=0)
print('Test Accuracy: %f' % (acc*100))</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f615082037315-143">143</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-1"><span class="crayon-e">from </span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-e">punctuation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-t">array</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">zeros</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-e">import </span><span class="crayon-e">Tokenizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">preprocessing</span><span class="crayon-sy">.</span><span class="crayon-e">sequence </span><span class="crayon-e">import </span><span class="crayon-e">pad_sequences</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-9"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-10"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Flatten</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-11"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-12"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-e">Conv1D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-13"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">convolutional </span><span class="crayon-e">import </span><span class="crayon-i">MaxPooling1D</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-15"><span class="crayon-p"># load doc into memory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-16"><span class="crayon-e">def </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-17"><span class="crayon-h">	</span><span class="crayon-p"># open the file as read only</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-18"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-19"><span class="crayon-h">	</span><span class="crayon-p"># read all text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-20"><span class="crayon-h">	</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-21"><span class="crayon-h">	</span><span class="crayon-p"># close the file</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-22"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-23"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">text</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-25"><span class="crayon-p"># turn a doc into clean tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-26"><span class="crayon-e">def </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-27"><span class="crayon-h">	</span><span class="crayon-p"># split into tokens by white space</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-28"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">doc</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-29"><span class="crayon-h">	</span><span class="crayon-p"># remove punctuation from each token</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-30"><span class="crayon-h">	</span><span class="crayon-v">table</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">str</span><span class="crayon-sy">.</span><span class="crayon-e">maketrans</span><span class="crayon-sy">(</span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">punctuation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-31"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">w</span><span class="crayon-sy">.</span><span class="crayon-e">translate</span><span class="crayon-sy">(</span><span class="crayon-v">table</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-32"><span class="crayon-h">	</span><span class="crayon-p"># filter out tokens not in vocab</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-33"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">tokens </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">w</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-34"><span class="crayon-h">	</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">' '</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-35"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">tokens</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-36">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-37"><span class="crayon-p"># load all docs in a directory</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-38"><span class="crayon-e">def </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">is_trian</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-39"><span class="crayon-h">	</span><span class="crayon-v">documents</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-40"><span class="crayon-h">	</span><span class="crayon-p"># walk through all files in the folder</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-41"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-42"><span class="crayon-h">		</span><span class="crayon-p"># skip any reviews in the test set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-43"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-44"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-45"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">is_trian </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">filename</span><span class="crayon-sy">.</span><span class="crayon-e">startswith</span><span class="crayon-sy">(</span><span class="crayon-s">'cv9'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-46"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-47"><span class="crayon-h">		</span><span class="crayon-p"># create the full path of the file to open</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-48"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">filename</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-49"><span class="crayon-h">		</span><span class="crayon-p"># load the doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-50"><span class="crayon-h">		</span><span class="crayon-v">doc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-51"><span class="crayon-h">		</span><span class="crayon-p"># clean doc</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-52"><span class="crayon-h">		</span><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">clean_doc</span><span class="crayon-sy">(</span><span class="crayon-v">doc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-53"><span class="crayon-h">		</span><span class="crayon-p"># add to list</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-54"><span class="crayon-h">		</span><span class="crayon-v">documents</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-55"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-56">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-57"><span class="crayon-p"># load embedding as a dict</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-58"><span class="crayon-e">def </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-59"><span class="crayon-h">	</span><span class="crayon-p"># load embedding into memory, skip first line</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-60"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-61"><span class="crayon-h">	</span><span class="crayon-v">lines</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">readlines</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-62"><span class="crayon-h">	</span><span class="crayon-v">file</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-63"><span class="crayon-h">	</span><span class="crayon-p"># create a map of words to vectors</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-64"><span class="crayon-h">	</span><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-65"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lines</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-66"><span class="crayon-h">		</span><span class="crayon-v">parts</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-67"><span class="crayon-h">		</span><span class="crayon-p"># key is string word, value is numpy array for vector</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-68"><span class="crayon-h">		</span><span class="crayon-v">embedding</span><span class="crayon-sy">[</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">parts</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">=</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-69"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-70">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-71"><span class="crayon-p"># create a weight matrix for the Embedding layer from a loaded embedding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-72"><span class="crayon-e">def </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-73"><span class="crayon-h">	</span><span class="crayon-p"># total vocabulary size plus 0 for unknown words</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-74"><span class="crayon-h">	</span><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-75"><span class="crayon-h">	</span><span class="crayon-p"># define weight matrix dimensions with all 0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-76"><span class="crayon-h">	</span><span class="crayon-v">weight_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-77"><span class="crayon-h">	</span><span class="crayon-p"># step vocab, store vectors using the Tokenizer's integer mapping</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-78"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-t">word</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">items</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-79"><span class="crayon-h">		</span><span class="crayon-v">vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedding</span><span class="crayon-sy">.</span><span class="crayon-e">get</span><span class="crayon-sy">(</span><span class="crayon-t">word</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-80"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">vector </span><span class="crayon-st">is</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-81"><span class="crayon-h">			</span><span class="crayon-v">weight_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">vector</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-82"><span class="crayon-e">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">weight</span><span class="crayon-sy">_</span>matrix</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-83">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-84"><span class="crayon-p"># load the vocabulary</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-85"><span class="crayon-v">vocab_filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'vocab.txt'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-86"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_doc</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-87"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-88"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-90"><span class="crayon-p"># load all training reviews</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-91"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-92"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-93"><span class="crayon-v">train_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-94">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-95"><span class="crayon-p"># create the tokenizer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-96"><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Tokenizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-97"><span class="crayon-p"># fit the tokenizer on the documents</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-98"><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_on_texts</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-99">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-100"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-101"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">train_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-102"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-103"><span class="crayon-v">max_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">max</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">train_docs</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-104"><span class="crayon-v">Xtrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-105"><span class="crayon-p"># define training labels</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-106"><span class="crayon-v">ytrain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">900</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-107">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-108"><span class="crayon-p"># load all test reviews</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-109"><span class="crayon-v">positive_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/pos'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-110"><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">process_docs</span><span class="crayon-sy">(</span><span class="crayon-s">'txt_sentoken/neg'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vocab</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-111"><span class="crayon-v">test_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">negative_docs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">positive</span><span class="crayon-sy">_</span>docs</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-112"><span class="crayon-p"># sequence encode</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-113"><span class="crayon-v">encoded_docs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-e">texts_to_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">test_docs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-114"><span class="crayon-p"># pad sequences</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-115"><span class="crayon-v">Xtest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pad_sequences</span><span class="crayon-sy">(</span><span class="crayon-v">encoded_docs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">maxlen</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">padding</span><span class="crayon-o">=</span><span class="crayon-s">'post'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-116"><span class="crayon-p"># define test labels</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-117"><span class="crayon-v">ytest</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-118">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-119"><span class="crayon-p"># define vocabulary size (largest integer value)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-120"><span class="crayon-v">vocab_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-121">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-122"><span class="crayon-p"># load embedding from file</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-123"><span class="crayon-v">raw_embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_embedding</span><span class="crayon-sy">(</span><span class="crayon-s">'glove.6B.100d.txt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-124"><span class="crayon-p"># get vectors in the right order</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-125"><span class="crayon-v">embedding_vectors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_weight_matrix</span><span class="crayon-sy">(</span><span class="crayon-v">raw_embedding</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tokenizer</span><span class="crayon-sy">.</span><span class="crayon-v">word_index</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-126"><span class="crayon-p"># create the embedding layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-127"><span class="crayon-v">embedding_layer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Embedding</span><span class="crayon-sy">(</span><span class="crayon-v">vocab_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-v">embedding_vectors</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_length</span><span class="crayon-o">=</span><span class="crayon-v">max_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainable</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-128">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-129"><span class="crayon-p"># define model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-130"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-131"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">embedding_layer</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-132"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Conv1D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-o">=</span><span class="crayon-cn">128</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_size</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-133"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">MaxPooling1D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-134"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-135"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-136"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-137"><span class="crayon-p"># compile network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-138"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-139"><span class="crayon-p"># fit network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-140"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">Xtrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytrain</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-141"><span class="crayon-p"># evaluate</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-142"><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">acc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">Xtest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ytest</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f615082037315-143"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Test Accuracy: %f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">acc*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>Running the example shows better performance.</p>
<p><strong>Note</strong>: Your <a href="https://machinelearningmastery.com/different-results-each-time-in-machine-learning/">results may vary</a>
 given the stochastic nature of the algorithm or evaluation procedure, 
or differences in numerical precision. Consider running the example a 
few times and compare the average outcome.</p>

<p>Again, the training dataset is easily learned and the model achieves 
76% accuracy on the test dataset. This is good, but not as good as using
 a learned Embedding layer.</p>
<p>This may be cause of the higher quality vectors trained on more data and/or using a slightly different training process.</p>
		<div id="urvanov-syntax-highlighter-6142081c0f616385057556" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">...
Epoch 6/10
2s - loss: 0.0278 - acc: 1.0000
Epoch 7/10
2s - loss: 0.0174 - acc: 1.0000
Epoch 8/10
2s - loss: 0.0117 - acc: 1.0000
Epoch 9/10
2s - loss: 0.0086 - acc: 1.0000
Epoch 10/10
2s - loss: 0.0068 - acc: 1.0000
Test Accuracy: 76.000000</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c0f616385057556-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-1">...</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-2">Epoch 6/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-3">2s - loss: 0.0278 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-4">Epoch 7/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-5">2s - loss: 0.0174 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-6">Epoch 8/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-7">2s - loss: 0.0117 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-8">Epoch 9/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-9">2s - loss: 0.0086 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-10">Epoch 10/10</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-11">2s - loss: 0.0068 - acc: 1.0000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c0f616385057556-12">Test Accuracy: 76.000000</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p>In this case, it seems that learning the embedding as part of
 the learning task may be a better direction than using a specifically 
trained embedding or a more general pre-trained embedding.</p>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking go deeper.</p>
<h3>Papers</h3>
<ul>
<li><a href="http://xxx.lanl.gov/abs/cs/0409058">A Sentimental Education: Sentiment Analysis Using Subjectivity Summarization Based on Minimum Cuts</a>, 2004.</li>
</ul>
<h3>APIs</h3>
<ul>
<li><a href="https://docs.python.org/3/library/collections.html">collections API – Container datatypes</a></li>
<li><a href="https://keras.io/preprocessing/text/#tokenizer">Tokenizer Keras API</a></li>
<li><a href="https://keras.io/layers/embeddings/">Embedding Keras API</a></li>
<li><a href="https://radimrehurek.com/gensim/models/word2vec.html">Gensim Word2Vec API</a></li>
<li><a href="https://radimrehurek.com/gensim/models/keyedvectors.html">Gensim WordVector API</a></li>
</ul>
<h3>Embedding Methods</h3>
<ul>
<li><a href="https://code.google.com/archive/p/word2vec/">word2vec on Google Code</a></li>
<li><a href="https://nlp.stanford.edu/projects/glove/">GloVe on Stanford</a></li>
</ul>
<h3>Related Posts</h3>
<ul>
<li><a href="https://blog.keras.io/using-pre-trained-word-embeddings-in-a-keras-model.html">Using pre-trained word embeddings in a Keras model</a>, 2016.</li>
<li><a href="http://www.wildml.com/2015/12/implementing-a-cnn-for-text-classification-in-tensorflow/">Implementing a CNN for Text Classification in TensorFlow</a>, 2015.</li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop word embeddings for the classification of movie reviews.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to prepare movie review text data for classification with deep learning methods.</li>
<li>How to learn a word embedding as part of fitting a deep learning model.</li>
<li>How to learn a standalone word embedding and how to use a pre-trained embedding in a neural network model.</li>
</ul>
<p>Do you have any questions?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<p><strong>Note</strong>: This post is an excerpt chapter from: “<a href="https://machinelearningmastery.com/deep-learning-for-nlp/">Deep Learning for Natural Language Processing</a>“.
 Take a look, if you want more step-by-step tutorials on getting the 
most out of deep learning methods when working with text data.</p>
<div class="widget_text awac-wrapper" id="custom_html-70"><div class="widget_text awac widget custom_html-70"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning models for Text Data Today!</h2>
<a href="https://machinelearningmastery.com/deep-learning-for-nlp/" rel="nofollow"><img style="border: 0;" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/DLFNLP-Cover-220.png" alt="Deep Learning for Natural Language Processing" width="220" height="311" align="left"></a>
<h4>Develop Your Own Text models in Minutes</h4>
<p>...with just a few lines of python code</p>

<p>Discover how in my new Ebook:<br>
<a href="https://machinelearningmastery.com/deep-learning-for-nlp/" rel="nofollow">Deep Learning for Natural Language Processing</a></p>

<p>It provides <strong>self-study tutorials</strong> on topics like:<br>
<em>Bag-of-Words, Word Embedding, Language Models, Caption Generation, Text Translation</em> and much more...</p>

<h4>Finally Bring Deep Learning to your Natural Language Processing Projects</h4>
<p>Skip the Academics. Just Results.</p>

<a href="https://machinelearningmastery.com/deep-learning-for-nlp/" class="woo-sc-button  red"><span class="woo-">See What's Inside</span></a>
<div class="woo-sc-hr"></div>
</div></div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-4401 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=Deep+Convolutional+Neural+Network+for+Sentiment+Analysis+%28Text+Classification%29&amp;url=https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" onclick="if (!window.__cfRLUnblockHandlers) return false; javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<div class="crp_related  "><h3>More On This Topic</h3><ul><li><a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" class="crp_link post-4375"><figure><img loading="lazy" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Deep-Learning-Bag-of-Words-Model-for-Predic.jpg" class="crp_thumb crp_featured" alt="How to Develop a Deep Learning Bag-of-Words Model for Sentiment Analysis (Text Classification)" title="How to Develop a Deep Learning Bag-of-Words Model for Sentiment Analysis (Text Classification)" width="150" height="150"></figure><span class="crp_title">How to Develop a Deep Learning Bag-of-Words Model…</span></a></li><li><a href="https://machinelearningmastery.com/prepare-movie-review-data-sentiment-analysis/" class="crp_link post-4369"><figure><img loading="lazy" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Prepare-Movie-Review-Data-for-Sentiment-Analysis-150x.jpg" class="crp_thumb crp_featured" alt="How to Prepare Movie Review Data for Sentiment Analysis  (Text Classification)" title="How to Prepare Movie Review Data for Sentiment Analysis  (Text Classification)" width="150" height="150"></figure><span class="crp_title">How to Prepare Movie Review Data for Sentiment…</span></a></li><li><a href="https://machinelearningmastery.com/predict-sentiment-movie-reviews-using-deep-learning/" class="crp_link post-2598"><figure><img loading="lazy" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/Predict-Sentiment-From-Movie-Reviews-Using-Deep-Learning-150.jpg" class="crp_thumb crp_featured" alt="How to Predict Sentiment From Movie Reviews Using Deep Learning (Text Classification)" title="How to Predict Sentiment From Movie Reviews Using Deep Learning (Text Classification)" width="150" height="150"></figure><span class="crp_title">How to Predict Sentiment From Movie Reviews Using…</span></a></li><li><a href="https://machinelearningmastery.com/review-of-architectural-innovations-for-convolutional-neural-networks-for-image-classification/" class="crp_link post-7462"><figure><img loading="lazy" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/Architecture-of-the-Residual-Network-for-Object-Photo-Class.webp" class="crp_thumb crp_featured" alt="Convolutional Neural Network Model Innovations for Image Classification" title="Convolutional Neural Network Model Innovations for Image Classification" width="150" height="150"></figure><span class="crp_title">Convolutional Neural Network Model Innovations for…</span></a></li><li><a href="https://machinelearningmastery.com/cnn-models-for-human-activity-recognition-time-series-classification/" class="crp_link post-6200"><figure><img loading="lazy" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/Histograms-of-each-variable-in-the-training-data-set-150x150.png" class="crp_thumb crp_featured" alt="1D Convolutional Neural Network Models for Human Activity Recognition" title="1D Convolutional Neural Network Models for Human Activity Recognition" width="150" height="150"></figure><span class="crp_title">1D Convolutional Neural Network Models for Human…</span></a></li><li><a href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/" class="crp_link post-6430"><figure><img loading="lazy" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/Plot-of-Multi-Headed-1D-CNN-for-Multivariate-Time-Series-Fo.webp" class="crp_thumb crp_featured" alt="How to Develop Convolutional Neural Network Models for Time Series Forecasting" title="How to Develop Convolutional Neural Network Models for Time Series Forecasting" width="150" height="150"></figure><span class="crp_title">How to Develop Convolutional Neural Network Models…</span></a></li></ul><div class="crp_clear"></div></div>	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a.png 2x" class="avatar avatar-80 photo" loading="lazy" width="80" height="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches 
developers how to get results with modern machine learning methods via 
hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="prev"><i class="fa fa-angle-left"></i> How to Use the Keras Functional API for Deep Learning</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/global-attention-for-encoder-decoder-recurrent-neural-networks/" rel="next">Gentle Introduction to Global Attention for Encoder-Decoder Recurrent Neural Networks <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">248 Responses to <em>Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-418478" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-418478" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a8a404e3ddf6be55ef21c4f4a1b5f77c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a8a404e3ddf6be55ef21c4f4a1b5f77c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander</span>
	                <span class="date">October 30, 2017 at 7:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for interest work.<br>
Jason, help me please.<br>
Imagine that we have an dataset which contains reviews with very 
different lengths (from just two words “good film” to long description 
“I remember the first work of this director….”.<br>
Which length should we choose when we talk about “pad_sequence”?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418478" data-commentid="418478" data-postid="4401" data-belowelement="comment-418478" data-respondelement="respond" data-replyto="Reply to Alexander" aria-label="Reply to Alexander">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418526" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418526" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 31, 2017 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418526" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>All reviews must be padded to the same length.</p>
<p>You can use the longest review, you can use the average length, etc. Try a few and see what works best.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418526" data-commentid="418526" data-postid="4401" data-belowelement="comment-418526" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418513" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418513" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/ec3c1db58c0d354e88c4a098fc2be505_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/ec3c1db58c0d354e88c4a098fc2be505.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">JingChunzhen</span>
	                <span class="date">October 31, 2017 at 2:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
I think it’s difficult to distinguish ”good” and “bad” using word2vec,  but it’s important in sentiment analysis anyway .<br>
Is there a good method to solve this ? Thank you and sorry for my poor English .</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418513" data-commentid="418513" data-postid="4401" data-belowelement="comment-418513" data-respondelement="respond" data-replyto="Reply to JingChunzhen" aria-label="Reply to JingChunzhen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418532" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418532" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 31, 2017 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally, the model will minimize a loss function. We want the loss to be low.</p>
<p>I agree, it feels like clustering to some degree.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418532" data-commentid="418532" data-postid="4401" data-belowelement="comment-418532" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418608" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-418608" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a8a404e3ddf6be55ef21c4f4a1b5f77c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a8a404e3ddf6be55ef21c4f4a1b5f77c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander</span>
	                <span class="date">October 31, 2017 at 10:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418608" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for feedback.<br>
Jason, sorry i don’t understand one thing. Help me please.<br>
I read you works about technique “Word Embeddings”. And I saw that when 
you use Embedding layer with Convolutional layer as feature extractor 
you always use 1D version.<br>
Since the machine sees the sentence in form of matrix why we don’t base on Conv2D?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418608" data-commentid="418608" data-postid="4401" data-belowelement="comment-418608" data-respondelement="respond" data-replyto="Reply to Alexander" aria-label="Reply to Alexander">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418631" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418631" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 1, 2017 at 5:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418631" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>A sequence of words is a one dimensions vector of integers. The 
embedding maps each integer onto a real vector, so now we have a 
sequence of vectors. It is still a one-dimensional sequence, it just so 
happens each item in the sequence has many features.</p>
<p>It is not like an image that has spatial relationships in two dimensions.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418631" data-commentid="418631" data-postid="4401" data-belowelement="comment-418631" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418687" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-418687" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a8a404e3ddf6be55ef21c4f4a1b5f77c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a8a404e3ddf6be55ef21c4f4a1b5f77c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander</span>
	                <span class="date">November 1, 2017 at 6:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418687" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank for clear explanation, Jason.<br>
I try to find an opportunity to use knowledges we have in Embedding layer the best way.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418687" data-commentid="418687" data-postid="4401" data-belowelement="comment-418687" data-respondelement="respond" data-replyto="Reply to Alexander" aria-label="Reply to Alexander">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418731" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-418731" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 2, 2017 at 5:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-418731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad it helped Alexander.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418731" data-commentid="418731" data-postid="4401" data-belowelement="comment-418731" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419049" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-419049" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/c35f435a9bd84ccf70bffe9267340b92_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/c35f435a9bd84ccf70bffe9267340b92.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ramesh Subrahmanyam</span>
	                <span class="date">November 5, 2017 at 9:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-419049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent post.  Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419049" data-commentid="419049" data-postid="4401" data-belowelement="comment-419049" data-respondelement="respond" data-replyto="Reply to Ramesh Subrahmanyam" aria-label="Reply to Ramesh Subrahmanyam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419103" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-419103" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 6, 2017 at 4:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-419103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419103" data-commentid="419103" data-postid="4401" data-belowelement="comment-419103" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-420104" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420104" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/36f88e5579f209ca739f0d765f0b2db3_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/36f88e5579f209ca739f0d765f0b2db3.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Amit Adesara</span>
	                <span class="date">November 15, 2017 at 9:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-420104" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for amazing posts. Eagerly waiting for your new book 
launch. I had one query on test,train split. Rather than defining a X 
and Y test/train, can’t we just use split model from sklearn. Doesn’t is
 automatically split the entire dataset into train and test? Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-420104" data-commentid="420104" data-postid="4401" data-belowelement="comment-420104" data-respondelement="respond" data-replyto="Reply to Amit Adesara" aria-label="Reply to Amit Adesara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420179" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-420179" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2017 at 10:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-420179" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Amit!</p>
<p>Yes, you can use sklearn if you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-420179" data-commentid="420179" data-postid="4401" data-belowelement="comment-420179" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423200" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-423200" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5eedf4f02c80308b2cf11d79da1f0db8_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5eedf4f02c80308b2cf11d79da1f0db8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abdur Rehman Nadeem</span>
	                <span class="date">December 15, 2017 at 8:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-423200" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason,</p>
<p>Sorry once again I am asking the same question which I mentioned in 
some other blog that what if I am using my own dataset. How can I make 
my dataset compatible to the above pre-built dataset ? I have a dataset 
of tweets so how can i make my dataset of positive and negative tweets 
and then use them as a test and train set ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423200" data-commentid="423200" data-postid="4401" data-belowelement="comment-423200" data-respondelement="respond" data-replyto="Reply to Abdur Rehman Nadeem" aria-label="Reply to Abdur Rehman Nadeem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423231" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-423231" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 15, 2017 at 3:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-423231" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The post above shows how to prepare data.</p>
<p>Also, this post shows how to clean text:<br>
<a href="https://machinelearningmastery.com/clean-text-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/clean-text-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423231" data-commentid="423231" data-postid="4401" data-belowelement="comment-423231" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427192" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-427192" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/04d1e6feb86036ca3bc8d606febe70af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/04d1e6feb86036ca3bc8d606febe70af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://silversurfer0.github.io/" rel="external nofollow ugc" class="url">Vladimir</a></span>
	                <span class="date">January 23, 2018 at 1:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-427192" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason for a valuable article! It is an exploration on it’s own.<br>
I also get better results if Embedding Layer is learned as part of the model, rather than using predifined embeddings.</p>
<p>First I was very much excited about using GloVe embeddings, yet it 
gives quite poor results. I think it is because real-world texts contain
 different word forms (for. example: cat, cats), while GloVe has 
embeddings only for a single form of each word (for. example: cat). And 
even a small deviation is considered as a different word, and thus 
ignored. Probably if this “word-forms” problem is solved, GloVe could 
show tremendous results…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-427192" data-commentid="427192" data-postid="4401" data-belowelement="comment-427192" data-respondelement="respond" data-replyto="Reply to Vladimir" aria-label="Reply to Vladimir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427251" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-427251" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2018 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-427251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You may be right in the general case. It is also critical that 
the vocab/word usage/etc is a good fit for the problem being solved.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-427251" data-commentid="427251" data-postid="4401" data-belowelement="comment-427251" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430622" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-430622" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/394dcd2124c28f78bbe8896f0428a77c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/394dcd2124c28f78bbe8896f0428a77c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michelle</span>
	                <span class="date">February 27, 2018 at 2:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-430622" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, </p>
<p>I am following this example to classify malicious urls. I am able to 
filter out words, encode and pad my training and testing data. However, 
when I apply the training data to the model, I get errors.</p>
<p>Do you have the code up on github? I’d like to run through the code to debug.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430622" data-commentid="430622" data-postid="4401" data-belowelement="comment-430622" data-respondelement="respond" data-replyto="Reply to Michelle" aria-label="Reply to Michelle">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430628" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-430628" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2018 at 2:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-430628" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot help you debug your code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430628" data-commentid="430628" data-postid="4401" data-belowelement="comment-430628" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432024" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432024" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/367b86b117b982953f94953db66458d6_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/367b86b117b982953f94953db66458d6.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">A.S</span>
	                <span class="date">March 13, 2018 at 7:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-432024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, This is very helpful thanks! Is there a java version of this please?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432024" data-commentid="432024" data-postid="4401" data-belowelement="comment-432024" data-respondelement="respond" data-replyto="Reply to A.S" aria-label="Reply to A.S">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432095" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432095" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-432095" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I do not have Java versions at this stage.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432095" data-commentid="432095" data-postid="4401" data-belowelement="comment-432095" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433102" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-433102" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1c868e5601a6dfc960cc529f0f0f45fe.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1c868e5601a6dfc960cc529f0f0f45fe_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pANTHER</span>
	                <span class="date">March 24, 2018 at 9:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-433102" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how this fucntion                                                                                                    </p>
<p> “encoded_docs = tokenizer.texts_to_sequences(test_docs)”</p>
<p>index test vocabs when we didn’t call </p>
<p> “tokenizer.fit_on_texts(train_docs)”</p>
<p>on test_docs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433102" data-commentid="433102" data-postid="4401" data-belowelement="comment-433102" data-respondelement="respond" data-replyto="Reply to pANTHER" aria-label="Reply to pANTHER">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433148" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-433148" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 25, 2018 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-433148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It uses the vocab learned from the training data to index words in test. If there are new works, they are marked as zero.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433148" data-commentid="433148" data-postid="4401" data-belowelement="comment-433148" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433777" class="comment even depth-3">

	      	<div id="li-comment-433777" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1c868e5601a6dfc960cc529f0f0f45fe.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1c868e5601a6dfc960cc529f0f0f45fe_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pANTHER</span>
	                <span class="date">April 1, 2018 at 1:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-433777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, really appreciate your help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433777" data-commentid="433777" data-postid="4401" data-belowelement="comment-433777" data-respondelement="respond" data-replyto="Reply to pANTHER" aria-label="Reply to pANTHER">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433124" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-433124" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1c868e5601a6dfc960cc529f0f0f45fe.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1c868e5601a6dfc960cc529f0f0f45fe_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pANTHER</span>
	                <span class="date">March 24, 2018 at 11:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-433124" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can we use CNN with multiclass problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433124" data-commentid="433124" data-postid="4401" data-belowelement="comment-433124" data-respondelement="respond" data-replyto="Reply to pANTHER" aria-label="Reply to pANTHER">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433152" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-433152" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 25, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-433152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433152" data-commentid="433152" data-postid="4401" data-belowelement="comment-433152" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594595" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-594595" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/fb19a7e4013222fcbbd9a3fc63b0dd49.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/fb19a7e4013222fcbbd9a3fc63b0dd49_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Harini V</span>
	                <span class="date">January 26, 2021 at 11:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-594595" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why use cnn because lots of deep learning algorithms are there</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-594595" data-commentid="594595" data-postid="4401" data-belowelement="comment-594595" data-respondelement="respond" data-replyto="Reply to Harini V" aria-label="Reply to Harini V">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-594659" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-594659" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2021 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-594659" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>CNN is effective for some problems, e.g. works very well for text classification tasks compared to other methods (on average).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-594659" data-commentid="594659" data-postid="4401" data-belowelement="comment-594659" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435662" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435662" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/52b1e04ebda32c0d51a3e04cf4601986_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/52b1e04ebda32c0d51a3e04cf4601986.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jin</span>
	                <span class="date">April 23, 2018 at 3:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-435662" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thanks for your sharing, For word embedding layer in 
keras, what is the window size? For example, in word2vec, we can set the
 window size to 5, but in keras embedding layer, there is no parameter 
for that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-435662" data-commentid="435662" data-postid="4401" data-belowelement="comment-435662" data-respondelement="respond" data-replyto="Reply to Jin" aria-label="Reply to Jin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435679" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-435679" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 23, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-435679" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The window size is the number of words around each word to consider, e.g. the context, when building the model.</p>
<p>Keras does not need this, as the embedding is built via 
back-propagating error during training, ideally using BPTT which builds 
up error over input time steps.</p>
<p>From my experiments, I find the Keras approach results in better 
skill than using a prebuilt model. It should be the other way around 
according to intuition, but not in my experience.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-435679" data-commentid="435679" data-postid="4401" data-belowelement="comment-435679" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435690" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-435690" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/52b1e04ebda32c0d51a3e04cf4601986_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/52b1e04ebda32c0d51a3e04cf4601986.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jin Zhou</span>
	                <span class="date">April 23, 2018 at 10:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-435690" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I read your blog about building language model with LSTM, and I 
tried work with pre-trained embedding weights, actually results in lower
 perplexity, but a little lower BLEU. So, it is hard for me to say which
 one is better.</p>
<p>Thanks for your blogs! I learned a lot from them.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-435690" data-commentid="435690" data-postid="4401" data-belowelement="comment-435690" data-respondelement="respond" data-replyto="Reply to Jin Zhou" aria-label="Reply to Jin Zhou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435700" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-435700" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 23, 2018 at 2:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-435700" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-435700" data-commentid="435700" data-postid="4401" data-belowelement="comment-435700" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436929" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436929" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7776166284a100b753b5c179a3a36443.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7776166284a100b753b5c179a3a36443_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow ugc" class="url">Anam</a></span>
	                <span class="date">May 8, 2018 at 4:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-436929" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,<br>
    In above post, you have used a CNN model after data preparation and 
embedding layer training tasks. Kindly, can you help that how I can 
perform<br>
(i) .Data Preparation<br>
(ii).Train Embedding Layer<br>
to use in LSTM Recurrent Neural Networks instead of CNN OR How can I use
 LSTM Recurrent Neural Networks instead of CNN after these two tasks?<br>
 Thanks for your time!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436929" data-commentid="436929" data-postid="4401" data-belowelement="comment-436929" data-respondelement="respond" data-replyto="Reply to Anam" aria-label="Reply to Anam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436978" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-436978" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2018 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-436978" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here is an example:<br>
<a href="https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/" rel="nofollow ugc">https://machinelearningmastery.com/sequence-classification-lstm-recurrent-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436978" data-commentid="436978" data-postid="4401" data-belowelement="comment-436978" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437015" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-437015" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7776166284a100b753b5c179a3a36443.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7776166284a100b753b5c179a3a36443_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://none/" rel="external nofollow ugc" class="url">Anam</a></span>
	                <span class="date">May 9, 2018 at 1:14 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-437015" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Sir, but I have an issue that, In the provided link 
training of embedding layer is not performed. Kindly can you guide me 
how to train embedding layer for LSTM RNN Model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437015" data-commentid="437015" data-postid="4401" data-belowelement="comment-437015" data-respondelement="respond" data-replyto="Reply to Anam" aria-label="Reply to Anam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437022" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-437022" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2018 at 2:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-437022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot prepare a specific case for you.</p>
<p>You can use a code example that shows how to use an embedding on the front end and combine it with the tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437022" data-commentid="437022" data-postid="4401" data-belowelement="comment-437022" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437024" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-437024" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7776166284a100b753b5c179a3a36443.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7776166284a100b753b5c179a3a36443_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anam</span>
	                <span class="date">May 9, 2018 at 2:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-437024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Sir for your guidance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437024" data-commentid="437024" data-postid="4401" data-belowelement="comment-437024" data-respondelement="respond" data-replyto="Reply to Anam" aria-label="Reply to Anam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437076" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-437076" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 10, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-437076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437076" data-commentid="437076" data-postid="4401" data-belowelement="comment-437076" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-440650" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-440650" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/d95cc0796f07e552a88f0c616c8a59aa_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/d95cc0796f07e552a88f0c616c8a59aa.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maryam</span>
	                <span class="date">June 13, 2018 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-440650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I am so grateful for the practical tutorial. I am a beginner at keras 
and deep learning. I applied a data set which is about 2 diseases. I 
wanna to train RNN via GloVe in order to classification but the output 
result is as follow :<br>
precision 0.0<br>
FPR 0.9999999999807433<br>
TPR 0.0<br>
FNR 0.999999999980609<br>
specificity 0.0<br>
accuracy 0.0<br>
F_score 0.0</p>
<p>I think just because GloVe did not pre-train for disease dataset???<br>
am I right ?? or it needs to train in many eopche?<br>
thank you for guiding me.<br>
Best<br>
Maram</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-440650" data-commentid="440650" data-postid="4401" data-belowelement="comment-440650" data-respondelement="respond" data-replyto="Reply to Maryam" aria-label="Reply to Maryam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-440688" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-440688" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 13, 2018 at 3:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-440688" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many possible reasons. Perhaps this framework will help you debug your model:<br>
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-440688" data-commentid="440688" data-postid="4401" data-belowelement="comment-440688" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441507" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-441507" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/37dc265632c5d360be81988b137f8c18.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/37dc265632c5d360be81988b137f8c18_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sarah</span>
	                <span class="date">June 21, 2018 at 9:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-441507" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
that was awesome like the others tutorials. I do not have a separate 
data set for  train dataset and test data set as I want to select test 
dataset randomly each time. so I have already done it by this statment:<br>
‘from sklearn.model_selection import train_test_split<br>
X_train, X_test, y_train, y_test = train_test_split(x_datasetpad,y_datasetpad,stratify=y_datasetpad,test_size=0.25)’<br>
according to your tutorial, you set ytest in this way :<br>
ytest = array([0 for _ in range(100)] + [1 for _ in range(100)])</p>
<p>I have already created x_dataset but I do not know how i can create ydataset??<br>
please guide me Jason, I realy need it.</p>
<p>Sarah</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-441507" data-commentid="441507" data-postid="4401" data-belowelement="comment-441507" data-respondelement="respond" data-replyto="Reply to Sarah" aria-label="Reply to Sarah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441537" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-441537" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2018 at 4:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-441537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The output will be the sentiment, or an integer representing the sentiment classes for each input review.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-441537" data-commentid="441537" data-postid="4401" data-belowelement="comment-441537" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441573" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-441573" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e45888fad95203963940b9a05719add5_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e45888fad95203963940b9a05719add5.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hegg</span>
	                <span class="date">June 21, 2018 at 11:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-441573" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>I was following your awesome tutorial but in the end I was asking 
myself: How can I predict a new sentence represented as a string for its
 sentiment? I think there will be some more people who would like to 
test their trained network for some example inputs. Could you maybe add 
such a section to this tutorial or give a short explanation on how to do
 this exactly? In such a way:</p>
<p>exampleSentence = ‘The weather is very good today’<br>
prediction = trainedModel.predict(exampleSentence)</p>
<p>print(sentimentForPrediction(prediction))</p>
<p>Kind regards</p>
<p>Hegg</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-441573" data-commentid="441573" data-postid="4401" data-belowelement="comment-441573" data-respondelement="respond" data-replyto="Reply to Hegg" aria-label="Reply to Hegg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441607" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-441607" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-441607" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can use:;</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6142081c1319e705880026" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">X = ...
yhat = model.predict(X)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c1319e705880026-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c1319e705880026-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c1319e705880026-1"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c1319e705880026-2"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-441607" data-commentid="441607" data-postid="4401" data-belowelement="comment-441607" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443724" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-443724" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e3089eec95dc2d5e060c1decf544479d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e3089eec95dc2d5e060c1decf544479d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Srijan Verma</span>
	                <span class="date">July 18, 2018 at 12:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-443724" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I tried implementing one of your codes for predicting the sentiment for a sentence.<br>
First i trained the model the way you have. I am getting an accuracy of 86% on test data.<br>
This is the function that i used for predicting on a new sentence.</p>
<p># classify a review as negative (0) or positive (1)<br>
def predict_sentiment(review, vocab, tokenizer, model):<br>
	# clean<br>
	tokens = clean_doc(review)<br>
	# filter by vocab<br>
	tokens = [w for w in tokens if w in vocab]<br>
	# convert to line<br>
	line = ‘ ‘.join(tokens)<br>
	#print(line)<br>
	# encode<br>
	tokenizer.fit_on_texts(line)<br>
	encoded = tokenizer.texts_to_sequences(line)<br>
	#print(encoded)<br>
	# prediction<br>
	max_length = max([len(s.split()) for s in line])<br>
	pred = pad_sequences(encoded, maxlen=1317, padding=’post’)<br>
	#print(pred)<br>
	yhat = model.predict(pred, verbose=0)<br>
	return round(yhat[0,0])</p>
<p># test positive text<br>
text = ‘this is a good movie’<br>
print(predict_sentiment(text, vocab, tokenizer, model))<br>
# test negative text<br>
text = ‘This is a bad movie.’<br>
print(predict_sentiment(text, vocab, tokenizer, model))</p>
<p>somehow, I am getting a ‘0’ in both the cases. I tried using other test cases as well, but it is always giving a zero.</p>
<p>I cant find where I am going wrong.</p>
<p>Any insights would be really helpful.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443724" data-commentid="443724" data-postid="4401" data-belowelement="comment-443724" data-respondelement="respond" data-replyto="Reply to Srijan Verma" aria-label="Reply to Srijan Verma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443756" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-443756" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2018 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-443756" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have the capacity to debug your code. Perhaps try stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443756" data-commentid="443756" data-postid="4401" data-belowelement="comment-443756" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443809" class="comment odd alt depth-5">

	      	<div id="li-comment-443809" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e3089eec95dc2d5e060c1decf544479d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e3089eec95dc2d5e060c1decf544479d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Srijan</span>
	                <span class="date">July 18, 2018 at 7:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-443809" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Let us say I have a raw text which I want to predict using model.predict().<br>
First step would be to assign the same index value (on which the model was trained on) to each of the words in the raw text .<br>
Then we would have to convert it to sequences (using texts_to_sequences())<br>
Then will be the padding (max_length would be the same of that of the training set)<br>
And then this will be given to the model.predict()</p>
<p>Is that correct ? ^</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-443853" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-443853" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 19, 2018 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-443853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. All preparation performed to training data must also be 
performed to any new data when you want to make a prediction with the 
trained model.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-529354" class="comment odd alt depth-5">

	      	<div id="li-comment-529354" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0de6ecb95adf485cd4e7c15c1cac5d69_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0de6ecb95adf485cd4e7c15c1cac5d69.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nanda Kishor M pai</span>
	                <span class="date">April 11, 2020 at 4:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-529354" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i tried to predict the same way as mentioned above and irrespective of review i am getting a value around 0.5100..what to do?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-529413" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-529413" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 12, 2020 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-529413" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try re-fitting the model from scratch?<br>
Perhaps try alternate configurations of the model or training?<br>
Perhaps try different data when making predictions?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442015" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-442015" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3d7083832b44ac93669e08b72660d02b_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3d7083832b44ac93669e08b72660d02b.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sara</span>
	                <span class="date">June 26, 2018 at 12:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-442015" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you so much for your great post. I always enjoy your work and they help me a lot. </p>
<p>My question is that how can I handle other features and text feature 
at the same time in my classification. I mean if I have other features 
like the number of words, the number of punctuation, category, etc for 
each review how can I use them in my classification. </p>
<p>Best</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-442015" data-commentid="442015" data-postid="4401" data-belowelement="comment-442015" data-respondelement="respond" data-replyto="Reply to Sara" aria-label="Reply to Sara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442050" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-442050" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 26, 2018 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-442050" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, perhaps a two-headed model would be appropriate. 
One head for text data and one with a vector summarizing the document.</p>
<p>This tutorial will help:<br>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow ugc">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-442050" data-commentid="442050" data-postid="4401" data-belowelement="comment-442050" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444816" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444816" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/92fcfd455d7d8cd85e39db40ff6c4987_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/92fcfd455d7d8cd85e39db40ff6c4987.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anjali Batra</span>
	                <span class="date">July 31, 2018 at 2:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-444816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, awesome article.  Can you please tell which python version can I use to run the code?<br>
As nltk wont work on pythong 2.7 and Keras is not available for python 3.6.</p>
<p>Looking forward to your response.</p>
<p>Thanks,<br>
Anjali Batra</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444816" data-commentid="444816" data-postid="4401" data-belowelement="comment-444816" data-respondelement="respond" data-replyto="Reply to Anjali Batra" aria-label="Reply to Anjali Batra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444840" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-444840" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 31, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-444840" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Python 3.5 or 3.6. I believe Python 2.7 would work too, perhaps with minor tweaks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444840" data-commentid="444840" data-postid="4401" data-belowelement="comment-444840" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444902" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-444902" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7efa7695483e220fa0a7730b0360605b_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7efa7695483e220fa0a7730b0360605b.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shreyas Jeet</span>
	                <span class="date">July 31, 2018 at 7:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-444902" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Great tutorial, helped a lot.<br>
I am working on a multi-class classification , could you help me on how I
 would have to tweak the network to facilitate a 8 class classifier.</p>
<p>Thank You</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444902" data-commentid="444902" data-postid="4401" data-belowelement="comment-444902" data-respondelement="respond" data-replyto="Reply to Shreyas Jeet" aria-label="Reply to Shreyas Jeet">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444953" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-444953" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2018 at 7:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-444953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Change the number of nodes in the output layer to 8, the transfer
 function to softmax and the loss function to categorical cross entropy.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444953" data-commentid="444953" data-postid="4401" data-belowelement="comment-444953" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447011" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447011" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/2f616360f6dccd2c34ed68fa3708edcd_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/2f616360f6dccd2c34ed68fa3708edcd.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alberto</span>
	                <span class="date">August 27, 2018 at 1:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-447011" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I’ve a question. To develop the vocab I’ve to use both training and testing reviews?<br>
Thanks a lot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447011" data-commentid="447011" data-postid="4401" data-belowelement="comment-447011" data-respondelement="respond" data-replyto="Reply to Alberto" aria-label="Reply to Alberto">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447025" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-447025" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-447025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ideally, you would just use training data to develop your vocab when evaluating the model.</p>
<p>You would use all data when preparing the final model.</p>
<p>It really comes down to your project goals.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447025" data-commentid="447025" data-postid="4401" data-belowelement="comment-447025" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-449393" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-449393" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0cd1af064c2a3ad46e1149f272407db.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0cd1af064c2a3ad46e1149f272407db_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arghyadeep Giri</span>
	                <span class="date">September 20, 2018 at 1:38 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-449393" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>Absolutely loved the tutorial. Nevertheless, I had a question 
regarding the convolution. You already answered a question regarding 
that, but I still have a doubt. You mentioned that the output of the 
embedding layer is a one-dimensional sequence.<br>
But the output shape of the embedding layer is (None, 1317, 100). I know
 the “None” refers to the batch size of the number of training examples.
 But, how is convolution possible with a (1317,100) shape with a 
one-dimensional filter size of 8. I want to get into the depth of it. 
How are these values getting multiplied? Since the output shape of the 
convoluted layer is (1310,32), the only way I can make sense is that for
 every filter there are 100 values which are getting multiplied with 
every sequence for a certain word. Kindly correct me if I am wrong.</p>
<p>Regards,<br>
Arghyadeep</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-449393" data-commentid="449393" data-postid="4401" data-belowelement="comment-449393" data-respondelement="respond" data-replyto="Reply to Arghyadeep Giri" aria-label="Reply to Arghyadeep Giri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449399" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-449399" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2018 at 2:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-449399" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the input is a sequence of integers. The output is a sequence of vectors.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-449399" data-commentid="449399" data-postid="4401" data-belowelement="comment-449399" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449400" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-449400" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0cd1af064c2a3ad46e1149f272407db.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0cd1af064c2a3ad46e1149f272407db_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arghyadeep Giri</span>
	                <span class="date">September 20, 2018 at 3:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-449400" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, absolutely! But I believe that is for the embedding layer.</p>
<p>But my question is about the convolution layer. How is the input shape (None, 1317, 100) getting converted to (None, 1310, 32)? </p>
<p>The 32 comes from the number of filters.<br>
1317 gets converted to 1310 for (1317-8+1) which is the kernel size.<br>
What about the number 100?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-449400" data-commentid="449400" data-postid="4401" data-belowelement="comment-449400" data-respondelement="respond" data-replyto="Reply to Arghyadeep Giri" aria-label="Reply to Arghyadeep Giri">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449446" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-449446" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 21, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-449446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The 100 is the length of each word vector.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-449446" data-commentid="449446" data-postid="4401" data-belowelement="comment-449446" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449466" class="comment odd alt depth-5">

	      	<div id="li-comment-449466" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0cd1af064c2a3ad46e1149f272407db.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0cd1af064c2a3ad46e1149f272407db_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arghyadeep Giri</span>
	                <span class="date">September 21, 2018 at 10:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-449466" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks 🙂</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455007" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455007" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/be41effb0730f26ea6698e19e4207fc5_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/be41effb0730f26ea6698e19e4207fc5.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ikib Kilam</span>
	                <span class="date">November 16, 2018 at 6:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, </p>
<p>In the ‘Training Embedding Layer’ code, why did you add a 1 to the 
size of vocabulary, before passing the size of the vocabulary to the 
Embedding? You say, ‘….plus one for unknown words…’ – but by definition 
there are no unknown words in the training data. When I run your code 
without adding the one, it croaks at the point when it is fitting the 
training data. It runs fine when I add the 1 to the vocabulary.  I am 
not certain why, and hoping you can elaborate.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455007" data-commentid="455007" data-postid="4401" data-belowelement="comment-455007" data-respondelement="respond" data-replyto="Reply to Ikib Kilam" aria-label="Reply to Ikib Kilam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455071" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-455071" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2018 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There can be unknown words when using the model, e.g. test data or new data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455071" data-commentid="455071" data-postid="4401" data-belowelement="comment-455071" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455101" class="comment even depth-3 parent">

	      	<div id="li-comment-455101" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/be41effb0730f26ea6698e19e4207fc5_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/be41effb0730f26ea6698e19e4207fc5.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ikib</span>
	                <span class="date">November 17, 2018 at 9:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455101" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. If I understood your response correctly…Unknown 
words in the test data or any new data, are not ascribed an integer 
encoding, because we are using the same tokenizer that was built for the
 training data, when working with these new data sets as well. So 
unknown words will not show up when we run these new datasets. I am 
still unsure why we need to add a 1, since again by definition the 
training data has no unknown words. I am missing something, esp. since 
when 1 is not added the code croaks at the fitting of training data 
stage, and well before we work with test/other datasets. One difference 
from your code is that I am using a MLP instead of CNN to train. I shall
 attempt to dig into this more, however if you have additional insight, 
please do reply.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455101" data-commentid="455101" data-postid="4401" data-belowelement="comment-455101" data-respondelement="respond" data-replyto="Reply to ikib" aria-label="Reply to ikib">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455224" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-455224" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455224" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. We add one because known words start at 1 not 0, e.g. 1-offset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455224" data-commentid="455224" data-postid="4401" data-belowelement="comment-455224" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455284" class="comment even thread-even depth-1">

	      	<div id="li-comment-455284" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/be41effb0730f26ea6698e19e4207fc5_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/be41effb0730f26ea6698e19e4207fc5.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ikib Kilam</span>
	                <span class="date">November 18, 2018 at 2:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you. Of course. I should have seen the offset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455284" data-commentid="455284" data-postid="4401" data-belowelement="comment-455284" data-respondelement="respond" data-replyto="Reply to Ikib Kilam" aria-label="Reply to Ikib Kilam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-455915" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455915" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/bb10f09d412efac99faccd244674394f_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/bb10f09d412efac99faccd244674394f.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Johnny</span>
	                <span class="date">November 23, 2018 at 2:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your sharing. I have trained a CNN model with pre-trained 
Glove vectors to do the text classification on resume data. I have the 
result in the vector forms and I wonder how could we transfer it back to
 text so that we could interpret it with actual meanings. Or is there 
better ways to do it?</p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455915" data-commentid="455915" data-postid="4401" data-belowelement="comment-455915" data-respondelement="respond" data-replyto="Reply to Johnny" aria-label="Reply to Johnny">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455971" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-455971" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-455971" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure I follow. You can plot words from the embedding, but it won’t tell you much about the resumes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455971" data-commentid="455971" data-postid="4401" data-belowelement="comment-455971" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456242" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-456242" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0d9c92ab687d49030dab9d06d4f73e03_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0d9c92ab687d49030dab9d06d4f73e03.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">chakib arsalan</span>
	                <span class="date">November 27, 2018 at 2:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-456242" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, i have two doubt ,<br>
– you explain the ( 3. Train Embedding Layer ) and ( 4. Train word2vec Embedding) ,<br>
we must chose on of those method or one complete the other ?</p>
<p>– Also , if i wan’t to give a new sentence and classify it (positive or negative), how can i do that ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456242" data-commentid="456242" data-postid="4401" data-belowelement="comment-456242" data-respondelement="respond" data-replyto="Reply to chakib arsalan" aria-label="Reply to chakib arsalan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456279" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-456279" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-456279" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use a final model to make a prediction as follows:</p>
<p>yhat = model.predict([asdasdasd])</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456279" data-commentid="456279" data-postid="4401" data-belowelement="comment-456279" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456561" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-456561" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0d9c92ab687d49030dab9d06d4f73e03_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0d9c92ab687d49030dab9d06d4f73e03.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">chakib arsalan</span>
	                <span class="date">November 29, 2018 at 10:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-456561" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When i do a predict for a new sentence for example :</p>
<p>phrase = “very bad feeling”<br>
tokens = tokenizer.texts_to_sequences([phrase])<br>
model.predict(np.array(tokens))</p>
<p>its give me :<br>
array([[0.99999934]], dtype=float32)</p>
<p>how can i now it about (positive or negative) sentiment ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456561" data-commentid="456561" data-postid="4401" data-belowelement="comment-456561" data-respondelement="respond" data-replyto="Reply to chakib arsalan" aria-label="Reply to chakib arsalan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456588" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-456588" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 2:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-456588" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use predict_class() to get the 0/1 value or you can interpret the probability directly.</p>
<p>I think values close to 0 is negative, values close to 1 is positive.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456588" data-commentid="456588" data-postid="4401" data-belowelement="comment-456588" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-458063" class="comment odd alt depth-5">

	      	<div id="li-comment-458063" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0d9c92ab687d49030dab9d06d4f73e03_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0d9c92ab687d49030dab9d06d4f73e03.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">chakib arsalan</span>
	                <span class="date">December 11, 2018 at 12:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-458063" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>is word2Vec great than Embedding Layer simple ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-458104" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-458104" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2018 at 7:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-458104" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are different, perhaps try both and see what works best for your specific dataset.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-460751" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-460751" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/2e59593e835e6fbe5986209efda56b72.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/2e59593e835e6fbe5986209efda56b72_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Avir</span>
	                <span class="date">December 30, 2018 at 8:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-460751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
Really good tutorial, but i need some clarifications.<br>
In this case you use word2vec model to use for the rnn model. That rnn 
model is used to predict the sentiments of words. Actually what is the 
exact use(purpose) of that word2vec model that you created? why these 
word embeddings really helpful for these analysis?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-460751" data-commentid="460751" data-postid="4401" data-belowelement="comment-460751" data-respondelement="respond" data-replyto="Reply to Avir" aria-label="Reply to Avir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-460830" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-460830" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 31, 2018 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-460830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It creates a distributed representation of words, more here:<br>
<a href="https://machinelearningmastery.com/what-are-word-embeddings/" rel="nofollow ugc">https://machinelearningmastery.com/what-are-word-embeddings/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-460830" data-commentid="460830" data-postid="4401" data-belowelement="comment-460830" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464041" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-464041" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/43ba2fdd095165c2627c82696a12321a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/43ba2fdd095165c2627c82696a12321a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam Donaldson</span>
	                <span class="date">January 18, 2019 at 9:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great writeup. I’m trying to get an intuitive 
understanding of how these higher dimensional representations 
effectively, cluster. It seems slightly magical at the moment. Is it 
because of the constant training to minimize the loss? And would 
backprop work downwards toward the embedding layer and modify the 
weights in those word vectors accordingly? If this correct, I’m to 
understand how this leads to clustering.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464041" data-commentid="464041" data-postid="4401" data-belowelement="comment-464041" data-respondelement="respond" data-replyto="Reply to Sam Donaldson" aria-label="Reply to Sam Donaldson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464049" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-464049" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 18, 2019 at 10:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The result is similar imports map to similar vectors or points in the n-dimensional space.</p>
<p>Training pushes similar things together as an efficiency – it is a lower cost to the loss function to group the vectors.</p>
<p>It is amazing. Truely!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464049" data-commentid="464049" data-postid="4401" data-belowelement="comment-464049" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464176" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-464176" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/43ba2fdd095165c2627c82696a12321a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/43ba2fdd095165c2627c82696a12321a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam Donaldson</span>
	                <span class="date">January 19, 2019 at 7:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Super helpful. Last few questions just to get a deeper understanding of what’s going on.</p>
<p>Question 1: In order for this magic to really work, the training 
examples must contain data related to one another? And some of this data
 needs to be shared across other training examples? I can envision a 
graph of data where similar data are already connected to each other and
 the algorithm is telling us how they’re clustered and their strengths 
by filling in the vector values by fitting a function. Am I on the right
 track?</p>
<p>Question 2: At a higher level, should we think of using embeddings 
when we want to find similarities or create clusters / groupings around 
data? I’m trying to understand when best to think of converting 
categorical fields to embeddings. For example, how would you treat dates
 or categories in structured data using deep learning? </p>
<p>Thanks Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464176" data-commentid="464176" data-postid="4401" data-belowelement="comment-464176" data-respondelement="respond" data-replyto="Reply to Sam Donaldson" aria-label="Reply to Sam Donaldson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464184" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-464184" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 19, 2019 at 8:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, generally richer training data is desired, more for the 
model to figure out. This is hard, so we solve it with volume, thousands
 or millions of examples.</p>
<p>Yes, when you want the model to learn how the categories should be 
grouped/best-grouped in the context of the problem that you’re solving. 
Days, months, stores, etc. These are really good examples where 
embeddings can help. It’s a new field, and few papers other than random 
kaggle write-ups. I hope to go deep on this later in the year.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464184" data-commentid="464184" data-postid="4401" data-belowelement="comment-464184" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464910" class="comment odd alt depth-5">

	      	<div id="li-comment-464910" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/43ba2fdd095165c2627c82696a12321a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/43ba2fdd095165c2627c82696a12321a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sam Donaldson</span>
	                <span class="date">January 25, 2019 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464910" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. Few more queries as I study more.</p>
<p>— The examples I’ve seen thus far to create embeddings have been in two forms:</p>
<p>1) A collaborative filtering (Netflix etc..) that take two 
embeddings, dot product them, and pass them throughs some layers with 
some output. The output is then compared to the label, and backprop 
works to fit the output by adjusting the embedding weights. </p>
<p>2) In this case, the task is to compute say some sales projection but
 the model takes in as input some embeddings that represent some 
categorical variables, like day of month or year etc..</p>
<p>I need some help understanding how meaningful weights are learnt in 
2) for the embeddings of these categorical variables. I ask because the 
loss function in 2) is directly related to the sales projection, as 
opposed to say 1) in which the objective is to get the dot product of 
the embeddings as close as possible to the label.</p>
<p>Can you shed some light on 2) and how these embeddings of categorical
 variables get learnt in more structured neural net problems? How do the
 weights become meaningful?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-464931" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-464931" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 25, 2019 at 8:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It learns how to best group the days or months based on the loss for the specific task. There’s not a lot to it.</p>
<p>Perhaps prototype an example and see how it goes?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464468" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-464468" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1b5041e8b43e0e6142a7cb9f95d7d948_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1b5041e8b43e0e6142a7cb9f95d7d948.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ratha</span>
	                <span class="date">January 21, 2019 at 10:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible to read indian languages to create word2vec</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464468" data-commentid="464468" data-postid="4401" data-belowelement="comment-464468" data-respondelement="respond" data-replyto="Reply to Ratha" aria-label="Reply to Ratha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464509" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-464509" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 22, 2019 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464509" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464509" data-commentid="464509" data-postid="4401" data-belowelement="comment-464509" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464563" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-464563" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1b5041e8b43e0e6142a7cb9f95d7d948_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1b5041e8b43e0e6142a7cb9f95d7d948.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ratha</span>
	                <span class="date">January 22, 2019 at 2:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you. Could you please share the code to create word2vec for
 other languages? Where should I need to change in Word2vec function?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464563" data-commentid="464563" data-postid="4401" data-belowelement="comment-464563" data-respondelement="respond" data-replyto="Reply to Ratha" aria-label="Reply to Ratha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464697" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-464697" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2019 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-464697" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It is the same code, just new training data.</p>
<p>Perhaps start here:<br>
<a href="https://machinelearningmastery.com/develop-word-embeddings-python-gensim/" rel="nofollow ugc">https://machinelearningmastery.com/develop-word-embeddings-python-gensim/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464697" data-commentid="464697" data-postid="4401" data-belowelement="comment-464697" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465232" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-465232" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Radifan</span>
	                <span class="date">January 27, 2019 at 6:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465232" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Mr. Jason</p>
<p>Your article is very useful for my study, so i would ask for question :</p>
<p>In section which use CNN with Conv1D layer after embedding layer in 
the model, what is result of Conv1D layer ? I mean whether result of 
this layer is value, pattern, sentiment or another ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465232" data-commentid="465232" data-postid="4401" data-belowelement="comment-465232" data-respondelement="respond" data-replyto="Reply to Radifan" aria-label="Reply to Radifan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465271" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-465271" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 28, 2019 at 7:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It will be a convolution of the distributed representation of the input.</p>
<p>Perhaps I don’t fully understand your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465271" data-commentid="465271" data-postid="4401" data-belowelement="comment-465271" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465415" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-465415" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Radifan</span>
	                <span class="date">January 29, 2019 at 3:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465415" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I mean, the convolution of the distributed representation of the 
input whether represent a sentiment feature of input tweet or something 
else ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465415" data-commentid="465415" data-postid="4401" data-belowelement="comment-465415" data-respondelement="respond" data-replyto="Reply to Radifan" aria-label="Reply to Radifan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465419" class="comment even depth-4">

	      	<div id="li-comment-465419" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Radifan</span>
	                <span class="date">January 29, 2019 at 4:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465419" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Oh sorry.. In my question that’s not input tweet but input text review</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465419" data-commentid="465419" data-postid="4401" data-belowelement="comment-465419" data-respondelement="respond" data-replyto="Reply to Radifan" aria-label="Reply to Radifan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-465478" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-465478" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2019 at 8:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the aggregate or concat of the distributed representation of
 each word would together be the “text”, on which the conv is applied. 
This does not really mean anything though.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465478" data-commentid="465478" data-postid="4401" data-belowelement="comment-465478" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465323" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-465323" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 28, 2019 at 7:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465323" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason:  The IMDB data set used in this tutorial is different from the IMDB data set from Stanford university?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465323" data-commentid="465323" data-postid="4401" data-belowelement="comment-465323" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465373" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-465373" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 29, 2019 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe it is the same data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465373" data-commentid="465373" data-postid="4401" data-belowelement="comment-465373" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465425" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-465425" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 29, 2019 at 6:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>But Stanford data has 50000 reviews, and this dataset has only 2000.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465425" data-commentid="465425" data-postid="4401" data-belowelement="comment-465425" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465480" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-465480" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2019 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465480" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps it is a subset, you can learn more here:<br>
<a href="https://keras.io/datasets/#imdb-movie-reviews-sentiment-classification" rel="nofollow ugc">https://keras.io/datasets/#imdb-movie-reviews-sentiment-classification</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465480" data-commentid="465480" data-postid="4401" data-belowelement="comment-465480" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465517" class="comment even depth-3 parent">

	      	<div id="li-comment-465517" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 30, 2019 at 1:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>“Reviews have been preprocessed, and each review is encoded as a 
sequence of word indexes (integers). For convenience, words are indexed 
by overall frequency in the dataset, so that for instance the integer 
“3” encodes the 3rd most frequent word in the data. ” Regarding “. 
Regarding this, I am wondering how to encode words with same 
frequencies, because in practice many words in a large corpus will occur
 the same times. But array index doesn’t allow duplicates. Any idea of 
how to deal with this in Keras?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465517" data-commentid="465517" data-postid="4401" data-belowelement="comment-465517" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465522" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-465522" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2019 at 2:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465522" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are still rank ordered and assigned unique integers.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465522" data-commentid="465522" data-postid="4401" data-belowelement="comment-465522" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465532" class="comment even depth-5">

	      	<div id="li-comment-465532" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 30, 2019 at 5:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@Jason, for instance, if two words ‘dog’ and ‘cat’ both occur 3 
times, they will each get a different index? But the doc says “word are 
indexed by overall frequency”. How can the same freq count ‘3’ index two
 different words? Still puzzled…</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-465595" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-465595" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 31, 2019 at 5:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465595" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, all instances of dog would have the same index in the vocab.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465427" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-465427" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 29, 2019 at 6:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>With the Glove embedding, I got 86% accuracy with slightly complex model and smaller batch size=8</p>
<p># define model<br>
model = Sequential()<br>
model.add(embedding_layer)<br>
model.add(Conv1D(filters=32, kernel_size=8, activation=’relu’))<br>
model.add(MaxPooling1D(pool_size=2))<br>
model.add(Dropout(0.2))<br>
model.add(Flatten())<br>
model.add(Dense(12, activation=’relu’))<br>
model.add(Dropout(0.4))<br>
model.add(Dense(1, activation=’sigmoid’))# compile network<br>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br>
# fit network<br>
model.fit(Xtrain, ytrain, epochs=10, batch_size=8, verbose=2)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465427" data-commentid="465427" data-postid="4401" data-belowelement="comment-465427" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465481" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-465481" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2019 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465481" data-commentid="465481" data-postid="4401" data-belowelement="comment-465481" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-465620" class="comment even depth-2 parent">

	      	<div id="li-comment-465620" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Congmin</span>
	                <span class="date">January 31, 2019 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>“No, all instances of dog would have the same index in the vocab.” What about dog’s index? it also occurs 3 times.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465620" data-commentid="465620" data-postid="4401" data-belowelement="comment-465620" data-respondelement="respond" data-replyto="Reply to Congmin" aria-label="Reply to Congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465692" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3 parent">

	      	<div id="li-comment-465692" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 31, 2019 at 2:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow, can you elaborate on your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465692" data-commentid="465692" data-postid="4401" data-belowelement="comment-465692" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465705" class="comment even depth-4 parent">

	      	<div id="li-comment-465705" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 31, 2019 at 3:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465705" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here:  if two words ‘dog’ and ‘cat’ both occur 3 times, they will
 each get a different index? But the doc says “word are indexed by 
overall frequency”. My question is, how are two different words with a 
same frequency  indexed?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465705" data-commentid="465705" data-postid="4401" data-belowelement="comment-465705" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465850" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-465850" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2019 at 5:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465850" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry for the confusion.</p>
<p>The frequency is calculated for each word, then words are rank ordered and assigned an index based on their rank ordering.</p>
<p>dog = 1<br>
cat = 2<br>
…</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465987" class="comment even depth-4 parent">

	      	<div id="li-comment-465987" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">February 1, 2019 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>dog = 1<br>
cat = 2</p>
<p>If both words has the same frequency, i.e. 100, are how are they ranked?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465987" data-commentid="465987" data-postid="4401" data-belowelement="comment-465987" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-466147" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-466147" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-466147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One before the other, but the specific order chosen by the 
sorting algorithm does not matter. Just like when sorting any list of 
things and two items have the same value. Some order must be chosen in 
the end and it’s usually whichever the sort algorithm encountered first.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465533" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-465533" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">congmin</span>
	                <span class="date">January 30, 2019 at 5:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>“ytest = array([0 for _ in range(100)] + [1 for _ in 
range(100)])”, @Jason, is it ‘0’ for positive and ‘1’ for negative? 
Usually it’s the other way. Just curious</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465533" data-commentid="465533" data-postid="4401" data-belowelement="comment-465533" data-respondelement="respond" data-replyto="Reply to congmin" aria-label="Reply to congmin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465596" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-465596" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 31, 2019 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-465596" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes in this case.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465596" data-commentid="465596" data-postid="4401" data-belowelement="comment-465596" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469154" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-469154" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6ff6777275d3623e10d60fd6aef417b8_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6ff6777275d3623e10d60fd6aef417b8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ratha</span>
	                <span class="date">February 18, 2019 at 4:13 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-469154" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How can i use word2vec and number of adjectives as features in CNN model? How can i add number of adjectives as a layer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469154" data-commentid="469154" data-postid="4401" data-belowelement="comment-469154" data-respondelement="respond" data-replyto="Reply to Ratha" aria-label="Reply to Ratha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469255" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-469255" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 19, 2019 at 7:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-469255" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps it would be a separate input that is merged with the word2vec output?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469255" data-commentid="469255" data-postid="4401" data-belowelement="comment-469255" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469160" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-469160" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6ff6777275d3623e10d60fd6aef417b8_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6ff6777275d3623e10d60fd6aef417b8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ratha</span>
	                <span class="date">February 18, 2019 at 4:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-469160" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for this wonderful tutorial.<br>
I tried your word2vec model for my dataset.<br>
I have a doubt in this line:</p>
<p># create the embedding layer<br>
embedding_layer = Embedding(vocab_size, 100, weights=[embedding_vectors], input_length=max_length, trainable=False)</p>
<p>Instead of weights=[embedding_vectors] i used fasttext model. I got 
same accuracy for both. Why is that? Obviously something went wrong. I 
used the same code as yours. </p>
<p>Moreover how can i use number of adjectives as features in addition to word2vec in CNN?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469160" data-commentid="469160" data-postid="4401" data-belowelement="comment-469160" data-respondelement="respond" data-replyto="Reply to Ratha" aria-label="Reply to Ratha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469257" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-469257" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 19, 2019 at 7:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-469257" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure why you’re getting the same results.</p>
<p>You can provide static variables as a separate input to the model, 
this tutorial will show you how to develop a multiple input model:<br>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow ugc">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469257" data-commentid="469257" data-postid="4401" data-belowelement="comment-469257" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469558" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-469558" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/9047c55a00c7709fcbb961ec5296bdb0_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Radifan</span>
	                <span class="date">February 20, 2019 at 11:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-469558" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr. Jason<br>
Thanks for this great explanation.</p>
<p>I’m currently working on sentiment analysis project which extract positive and negative sentiment on tweet from twitter.<br>
I tried to use tutorial above as guide for my project, i.e. use word 
embedding and convolutional neural network for tweet sentiment analysis.<br>
But when this applied on several datasets, the accuracy result is low i.e. about 66.6 %, 67.6%, and 69 %.<br>
the question, what should I do to improve accuracy for my project ? what changes must be made to improve its accuracy ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469558" data-commentid="469558" data-postid="4401" data-belowelement="comment-469558" data-respondelement="respond" data-replyto="Reply to Radifan" aria-label="Reply to Radifan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469642" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-469642" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 21, 2019 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-469642" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow ugc">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469642" data-commentid="469642" data-postid="4401" data-belowelement="comment-469642" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-471901" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-471901" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steve</span>
	                <span class="date">March 3, 2019 at 2:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-471901" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr. Jason,</p>
<p>Thanks!, this is a great tutorial.<br>
Need a small help with what I’m working right now.</p>
<p>I’m trying to build a neural network that predicts a score of 1 to 5 for a given review.<br>
The dataset what I’m currently uses has two fields – review text | rating.<br>
Rating is from a range of 1 to 5 (in floats)</p>
<p>I followed your steps but the y values are 1s and 0s in your instance. But my dataset has a range of 1 to 5 for the rating.<br>
My model should predict a single value from range of 1 to 5</p>
<p>Do you know the correct way that I should pass the y values to the model ? </p>
<p>I’m looking forward to hear from you.</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-471901" data-commentid="471901" data-postid="4401" data-belowelement="comment-471901" data-respondelement="respond" data-replyto="Reply to Steve" aria-label="Reply to Steve">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472072" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-472072" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 4, 2019 at 6:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-472072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try modeling it as regression and then try multi-class classification and compare performance?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472072" data-commentid="472072" data-postid="4401" data-belowelement="comment-472072" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472136" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-472136" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steve</span>
	                <span class="date">March 4, 2019 at 9:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-472136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr. Jason,</p>
<p>Just checking whether i’m doing things right, because when i predict with real data, I get all class 4 prediction 🙁<br>
The accuracy is really low – around 50 – 65<br>
Below is how I’ve configured.</p>
<p></p>
		<div id="urvanov-syntax-highlighter-6142081c12e97298142910" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover disable-anim" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="readonly" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">num_classes = 5
embedding_dim = 300
epochs = 10
batch_size = 128
max_len = 250

# converting points to classes for targets (y)
def points_to_class(self, points):
        if float(points) &lt; 1.5:
            return 0
        elif float(points) &lt; 2.5:
            return 1
        elif float(points) &lt; 3.5:
            return 2
        elif float(points) &lt; 4.5:
            return 3
        else:
            return 4

print('----classifying ratings to classes----')

classified_ratings = reviews_df['rating'].apply(self.points_to_class)
print(classified_ratings.value_counts())
y = to_categorical(classified_ratings, num_classes)


I'm using "glove.840B.300d.txt" as the pre-trained embeddings

embedding_layer = Embedding(len(word_index) + 1, embedding_dim, weights=[emb_matrix], input_length=max_len, trainable=False)


# define model

model = Sequential()
model.add(embedding_layer)
model.add(Conv1D(filters=128, kernel_size=5, activation='relu'))
model.add(MaxPooling1D(pool_size=2))
model.add(Flatten())
model.add(Dense(num_classes, activation='softmax'))

# compile network
        model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6142081c12e97298142910-42">42</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-1"><span class="crayon-v">num_classes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-2"><span class="crayon-v">embedding_dim</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">300</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-3"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-4"><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-5"><span class="crayon-v">max_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">250</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-7"><span class="crayon-p"># converting points to classes for targets (y)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-8"><span class="crayon-e">def </span><span class="crayon-e">points_to_class</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">points</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">1.5</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">elif </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">2.5</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">elif </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">3.5</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">elif </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">points</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">4.5</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'----classifying ratings to classes----'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-22"><span class="crayon-v">classified_ratings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reviews_df</span><span class="crayon-sy">[</span><span class="crayon-s">'rating'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">apply</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">points_to_class</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">classified_ratings</span><span class="crayon-sy">.</span><span class="crayon-e">value_counts</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-24"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">classified_ratings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num_classes</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-27"><span class="crayon-i">I</span><span class="crayon-s">'m using "glove.840B.300d.txt" as the pre-trained embeddings</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-29"><span class="crayon-s">embedding_layer = Embedding(len(word_index) + 1, embedding_dim, weights=[emb_matrix], input_length=max_len, trainable=False)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-32"><span class="crayon-s"># define model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-34"><span class="crayon-s">model = Sequential()</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-35"><span class="crayon-s">model.add(embedding_layer)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-36"><span class="crayon-s">model.add(Conv1D(filters=128, kernel_size=5, activation='</span><span class="crayon-i">relu</span><span class="crayon-s">'))</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-37"><span class="crayon-s">model.add(MaxPooling1D(pool_size=2))</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-38"><span class="crayon-s">model.add(Flatten())</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-39"><span class="crayon-s">model.add(Dense(num_classes, activation='</span><span class="crayon-i">softmax</span><span class="crayon-s">'))</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-41"><span class="crayon-s"># compile network</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6142081c12e97298142910-42"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;model.compile(loss='</span><span class="crayon-v">categorical</span><span class="crayon-sy">_</span>crossentropy<span class="crayon-s">', optimizer='</span><span class="crayon-i">adam</span><span class="crayon-s">', metrics=['</span><span class="crayon-i">accuracy</span>'<span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div><p></p>
<p>If you see anything that can be improved, please share 🙂 </p>
<p>I’m looking forward to hear from you.</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472136" data-commentid="472136" data-postid="4401" data-belowelement="comment-472136" data-respondelement="respond" data-replyto="Reply to Steve" aria-label="Reply to Steve">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472197" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-472197" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 4, 2019 at 2:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-472197" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions for diagnosing and improving your model performance here:<br>
<a href="https://machinelearningmastery.com/start-here/#better" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#better</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472197" data-commentid="472197" data-postid="4401" data-belowelement="comment-472197" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472223" class="comment even depth-3 parent">

	      	<div id="li-comment-472223" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steve</span>
	                <span class="date">March 4, 2019 at 4:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-472223" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Highly appreciated, will get back to you after modification 🙂<br>
Thanks ! 🙂</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472223" data-commentid="472223" data-postid="4401" data-belowelement="comment-472223" data-respondelement="respond" data-replyto="Reply to Steve" aria-label="Reply to Steve">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-475534" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-475534" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/6b690bfbb7c8cc0f3542540c57538adb_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steve</span>
	                <span class="date">March 20, 2019 at 10:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-475534" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Mr. Jason,</p>
<p>I’ve tried your suggestions and it was really helpful.<br>
Right now my model looks like below.</p>
<p>model = Sequential()<br>
model.add(Embedding(vocab_size, 100, input_length=max_length))<br>
model.add(Conv1D(filters=32, kernel_size=8, activation=’relu’))<br>
model.add(MaxPooling1D(pool_size=2))<br>
model.add(Flatten())<br>
model.add(Dense(100, activation=’relu’))<br>
model.add(Dropout(0.5))<br>
model.add(Dense(50, activation=’relu’))<br>
model.add(Dropout(0.5))<br>
model.add(Dense(5, activation=’softmax’))</p>
<p>model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])</p>
<p>callback = [PrintDot(), tensorboard]</p>
<p># fit network<br>
model.fit(final_X_train, final_Y_train, epochs=5, batch_size=128, validation_split=0.1, callbacks=callback)</p>
<p>*I’m building a model to output a rating (1-5) for a given review. 
I’m training the model on more than 400,000 reviews but after 
Downsampling it brings to 35,000 reviews per class.</p>
<p>*My Problem is, when i’m training, train acc is increasing and train 
loss is decreasing but though val_acc increases, the val_loss decreases 
after 2-3 epochs. This is one of the training records.</p>
<p>## 5 epochs – 128 batch size<br>
# loss: 1.0795 – acc: 0.5098 – val_loss: 0.8838 – val_acc: 0.6141<br>
# loss: 0.8516 – acc: 0.6331 – val_loss: 0.8025 – val_acc: 0.6596<br>
# loss: 0.7026 – acc: 0.7108 – val_loss: 0.7508 – val_acc: 0.7037<br>
# loss: 0.5383 – acc: 0.7922 – val_loss: 0.7744 – val_acc: 0.7265<br>
# loss: 0.4082 – acc: 0.8505 – val_loss: 0.8536 – val_acc: 0.7405<br>
# The total accuracy is :  0.6314016726089743</p>
<p>This is surely an overfitting behaviour.<br>
**But when i try to increase the data with another 200,000 data samples,
 the val_acc started to decrease after 2nd epoch as well.</p>
<p>Do you have any opinions for this issue, help is highly appreciated.</p>
<p>I’m looking forward to hear from you.</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-475534" data-commentid="475534" data-postid="4401" data-belowelement="comment-475534" data-respondelement="respond" data-replyto="Reply to Steve" aria-label="Reply to Steve">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-475650" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-475650" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 21, 2019 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-475650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You might have to try regularization methods to attack the overfitting.</p>
<p>I have tons of tutorials on this exact topic, start here:<br>
<a href="https://machinelearningmastery.com/start-here/#better" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#better</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472779" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-472779" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0ba4e78924b4ce9e98a2a62421d92334_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/0ba4e78924b4ce9e98a2a62421d92334.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Liangqun</span>
	                <span class="date">March 6, 2019 at 1:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-472779" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the example, the learned weights perform better than the 
pre-trained weights. Is there a way to get the learned weights from 
model? And how are they different via visualization?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472779" data-commentid="472779" data-postid="4401" data-belowelement="comment-472779" data-respondelement="respond" data-replyto="Reply to Liangqun" aria-label="Reply to Liangqun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472794" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-472794" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 6, 2019 at 2:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-472794" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can save the embedding layer and use it to get vectors for words.</p>
<p>They will be specific to the neural net model, e.g. targeted towards minimizing loss.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472794" data-commentid="472794" data-postid="4401" data-belowelement="comment-472794" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-475962" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-475962" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5935415f8fd4b13139c029f14abbf9df_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5935415f8fd4b13139c029f14abbf9df.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sun</span>
	                <span class="date">March 22, 2019 at 11:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-475962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>theano_compilation_error_qi7q8r0_</p>
<p>—————————————————————————</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-475962" data-commentid="475962" data-postid="4401" data-belowelement="comment-475962" data-respondelement="respond" data-replyto="Reply to sun" aria-label="Reply to sun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476014" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-476014" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 23, 2019 at 9:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-476014" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, perhaps this will help you setup your environment:<br>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow ugc">https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-476014" data-commentid="476014" data-postid="4401" data-belowelement="comment-476014" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476271" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-476271" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5935415f8fd4b13139c029f14abbf9df_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5935415f8fd4b13139c029f14abbf9df.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sun</span>
	                <span class="date">March 25, 2019 at 3:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-476271" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>WARNING (theano.gof.compilelock): Overriding existing lock by dead process ‘45020’ (I am process ‘13088’)</p>
<p>You can find the C code in this temporary file: C:\Users\DES\AppData\Local\Temp\theano_compilation_error_yr3062kk</p>
<p>—————————————————————————<br>
Exception                                 Traceback (most recent call last)<br>
 in ()<br>
    127 # define model<br>
    128 model = Sequential()<br>
–&gt; 129 model.add(embedding_layer)<br>
    130 model.add(Conv1D(filters=128, kernel_size=5, activation=’relu’))<br>
    131 model.add(MaxPooling1D(pool_size=2))</p>
<p>G:\anaconda\lib\site-packages\keras\engine\sequential.py in add(self, layer)<br>
    163                     # and create the node connecting the current layer<br>
    164                     # to the input layer we just created.<br>
–&gt; 165                     layer(x)<br>
    166                     set_inputs = True<br>
    167             else:</p>
<p>G:\anaconda\lib\site-packages\keras\engine\base_layer.py in __call__(self, inputs, **kwargs)<br>
    429                                          ‘You can build it manually via: ‘<br>
    430                                          ‘<code>layer.build(batch_input_shape)</code>‘)<br>
–&gt; 431                 self.build(unpack_singleton(input_shapes))<br>
    432                 self.built = True<br>
    433 </p>
<p>G:\anaconda\lib\site-packages\keras\layers\embeddings.py in build(self, input_shape)<br>
    107             regularizer=self.embeddings_regularizer,<br>
    108             constraint=self.embeddings_constraint,<br>
–&gt; 109             dtype=self.dtype)<br>
    110         self.built = True<br>
    111 </p>
<p>G:\anaconda\lib\site-packages\keras\legacy\interfaces.py in wrapper(*args, **kwargs)<br>
     89                 warnings.warn(‘Update your <code>' + object_name + '</code> call to the ‘ +<br>
     90                               ‘Keras 2 API: ‘ + signature, stacklevel=2)<br>
—&gt; 91             return func(*args, **kwargs)<br>
     92         wrapper._original_function = func<br>
     93         return wrapper</p>
<p>G:\anaconda\lib\site-packages\keras\engine\base_layer.py in 
add_weight(self, name, shape, dtype, initializer, regularizer, 
trainable, constraint)<br>
    247         if dtype is None:<br>
    248             dtype = K.floatx()<br>
–&gt; 249         weight = K.variable(initializer(shape),<br>
    250                             dtype=dtype,<br>
    251                             name=name,</p>
<p>G:\anaconda\lib\site-packages\keras\initializers.py in __call__(self, shape, dtype)<br>
    110     def __call__(self, shape, dtype=None):<br>
    111         return K.random_uniform(shape, self.minval, self.maxval,<br>
–&gt; 112                                 dtype=dtype, seed=self.seed)<br>
    113<br>
    114     def get_config(self):</p>
<p>G:\anaconda\lib\site-packages\keras\backend\theano_backend.py in random_uniform(shape, minval, maxval, dtype, seed)<br>
   2598         seed = np.random.randint(1, 10e6)<br>
   2599     rng = RandomStreams(seed=seed)<br>
-&gt; 2600     return rng.uniform(shape, low=minval, high=maxval, dtype=dtype)<br>
   2601<br>
   2602 </p>
<p>G:\anaconda\lib\site-packages\theano\sandbox\rng_mrg.py in uniform(self, size, low, high, ndim, dtype, nstreams, **kwargs)<br>
    870         if nstreams is None:<br>
    871             nstreams = self.n_streams(size)<br>
–&gt; 872         rstates = self.get_substream_rstates(nstreams, dtype)<br>
    873<br>
    874         d = {}</p>
<p>G:\anaconda\lib\site-packages\theano\configparser.py in res(*args, **kwargs)<br>
    115         def res(*args, **kwargs):<br>
    116             with self:<br>
–&gt; 117                 return f(*args, **kwargs)<br>
    118         return res<br>
    119 </p>
<p>G:\anaconda\lib\site-packages\theano\sandbox\rng_mrg.py in get_substream_rstates(self, n_streams, dtype, inc_rstate)<br>
    777         # If multMatVect.dot_modulo isn’t compiled, compile it.<br>
    778         if multMatVect.dot_modulo is None:<br>
–&gt; 779             multMatVect(rval[0], A1p72, M1, A2p72, M2)<br>
    780<br>
    781         # This way of calling the Theano fct is done to bypass Theano overhead.</p>
<p>G:\anaconda\lib\site-packages\theano\sandbox\rng_mrg.py in multMatVect(v, A, m1, B, m2)<br>
     60         o = DotModulo()(A_sym, s_sym, m_sym, A2_sym, s2_sym, m2_sym)<br>
     61         multMatVect.dot_modulo = function(<br>
—&gt; 62             [A_sym, s_sym, m_sym, A2_sym, s2_sym, m2_sym], o, profile=False)<br>
     63<br>
     64     # This way of calling the Theano fct is done to bypass Theano overhead.</p>
<p>G:\anaconda\lib\site-packages\theano\compile\function.py in 
function(inputs, outputs, mode, updates, givens, no_default_updates, 
accept_inplace, name, rebuild_strict, allow_input_downcast, profile, 
on_unused_input)<br>
    315                    on_unused_input=on_unused_input,<br>
    316                    profile=profile,<br>
–&gt; 317                    output_keys=output_keys)<br>
    318     return fn</p>
<p>G:\anaconda\lib\site-packages\theano\compile\pfunc.py in 
pfunc(params, outputs, mode, updates, givens, no_default_updates, 
accept_inplace, name, rebuild_strict, allow_input_downcast, profile, 
on_unused_input, output_keys)<br>
    484                          accept_inplace=accept_inplace, name=name,<br>
    485                          profile=profile, on_unused_input=on_unused_input,<br>
–&gt; 486                          output_keys=output_keys)<br>
    487<br>
    488 </p>
<p>G:\anaconda\lib\site-packages\theano\compile\function_module.py in 
orig_function(inputs, outputs, mode, accept_inplace, name, profile, 
on_unused_input, output_keys)<br>
   1839                   name=name)<br>
   1840         with theano.change_flags(compute_test_value=”off”):<br>
-&gt; 1841             fn = m.create(defaults)<br>
   1842     finally:<br>
   1843         t2 = time.time()</p>
<p>G:\anaconda\lib\site-packages\theano\compile\function_module.py in create(self, input_storage, trustme, storage_map)<br>
   1713             theano.config.traceback.limit = theano.config.traceback.compile_limit<br>
   1714             _fn, _i, _o = self.linker.make_thunk(<br>
-&gt; 1715                 input_storage=input_storage_lists, storage_map=storage_map)<br>
   1716         finally:<br>
   1717             theano.config.traceback.limit = limit_orig</p>
<p>G:\anaconda\lib\site-packages\theano\gof\link.py in make_thunk(self, input_storage, output_storage, storage_map)<br>
    697         return self.make_all(input_storage=input_storage,<br>
    698                              output_storage=output_storage,<br>
–&gt; 699                              storage_map=storage_map)[:3]<br>
    700<br>
    701     def make_all(self, input_storage, output_storage):</p>
<p>G:\anaconda\lib\site-packages\theano\gof\vm.py in make_all(self, profiler, input_storage, output_storage, storage_map)<br>
   1089                                                  compute_map,<br>
   1090                                                  [],<br>
-&gt; 1091                                                  impl=impl))<br>
   1092                 linker_make_thunk_time[node] = time.time() – thunk_start<br>
   1093                 if not hasattr(thunks[-1], ‘lazy’):</p>
<p>G:\anaconda\lib\site-packages\theano\gof\op.py in make_thunk(self, node, storage_map, compute_map, no_recycling, impl)<br>
    953             try:<br>
    954                 return self.make_c_thunk(node, storage_map, compute_map,<br>
–&gt; 955                                          no_recycling)<br>
    956             except (NotImplementedError, utils.MethodNotDefined):<br>
    957                 # We requested the c code, so don’t catch the error.</p>
<p>G:\anaconda\lib\site-packages\theano\gof\op.py in make_c_thunk(self, node, storage_map, compute_map, no_recycling)<br>
    856         _logger.debug(‘Trying CLinker.make_thunk’)<br>
    857         outputs = cl.make_thunk(input_storage=node_input_storage,<br>
–&gt; 858                                 output_storage=node_output_storage)<br>
    859         thunk, node_input_filters, node_output_filters = outputs<br>
    860 </p>
<p>G:\anaconda\lib\site-packages\theano\gof\cc.py in make_thunk(self, input_storage, output_storage, storage_map, keep_lock)<br>
   1215         cthunk, module, in_storage, out_storage, error_storage = self.__compile__(<br>
   1216             input_storage, output_storage, storage_map,<br>
-&gt; 1217             keep_lock=keep_lock)<br>
   1218<br>
   1219         res = _CThunk(cthunk, init_tasks, tasks, error_storage, module)</p>
<p>G:\anaconda\lib\site-packages\theano\gof\cc.py in __compile__(self, input_storage, output_storage, storage_map, keep_lock)<br>
   1155                                             output_storage,<br>
   1156                                             storage_map,<br>
-&gt; 1157                                             keep_lock=keep_lock)<br>
   1158         return (thunk,<br>
   1159                 module,</p>
<p>G:\anaconda\lib\site-packages\theano\gof\cc.py in 
cthunk_factory(self, error_storage, in_storage, out_storage, 
storage_map, keep_lock)<br>
   1618                 node.op.prepare_node(node, storage_map, None, ‘c’)<br>
   1619             module = get_module_cache().module_from_key(<br>
-&gt; 1620                 key=key, lnk=self, keep_lock=keep_lock)<br>
   1621<br>
   1622         vars = self.inputs + self.outputs + self.orphans</p>
<p>G:\anaconda\lib\site-packages\theano\gof\cmodule.py in module_from_key(self, key, lnk, keep_lock)<br>
   1179             try:<br>
   1180                 location = dlimport_workdir(self.dirname)<br>
-&gt; 1181                 module = lnk.compile_cmodule(location)<br>
   1182                 name = module.__file__<br>
   1183                 assert name.startswith(location)</p>
<p>G:\anaconda\lib\site-packages\theano\gof\cc.py in compile_cmodule(self, location)<br>
   1521                 lib_dirs=self.lib_dirs(),<br>
   1522                 libs=libs,<br>
-&gt; 1523                 preargs=preargs)<br>
   1524         except Exception as e:<br>
   1525             e.args += (str(self.fgraph),)</p>
<p>G:\anaconda\lib\site-packages\theano\gof\cmodule.py in 
compile_str(module_name, src_code, location, include_dirs, lib_dirs, 
libs, preargs, py_module, hide_symbols)<br>
   2386             # difficult to read.<br>
   2387             raise Exception(‘Compilation failed (return status=%s): %s’ %<br>
-&gt; 2388                             (status, compile_stderr.replace(‘\n’, ‘. ‘)))<br>
   2389         elif config.cmodule.compilation_warning and compile_stderr:<br>
   2390             # Print errors just below the command line.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-476271" data-commentid="476271" data-postid="4401" data-belowelement="comment-476271" data-respondelement="respond" data-replyto="Reply to sun" aria-label="Reply to sun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476365" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-476365" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2019 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-476365" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this error before, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-476365" data-commentid="476365" data-postid="4401" data-belowelement="comment-476365" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476272" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-476272" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5935415f8fd4b13139c029f14abbf9df_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5935415f8fd4b13139c029f14abbf9df.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sun</span>
	                <span class="date">March 25, 2019 at 3:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-476272" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>i am getting above error i copy pasted your code</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-476272" data-commentid="476272" data-postid="4401" data-belowelement="comment-476272" data-respondelement="respond" data-replyto="Reply to sun" aria-label="Reply to sun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-482537" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-482537" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7388e67aa405147233574e27e08f6cab.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7388e67aa405147233574e27e08f6cab_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Drew</span>
	                <span class="date">April 25, 2019 at 3:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-482537" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, great article. </p>
<p>I am getting the below type error when I copy and paste the code for 
creating an array for defining the class labels. Any way you can help:) 
I’m using Python 3. </p>
<p>from array import array<br>
from __future__ import unicode_literals</p>
<p># define training labels<br>
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])</p>
<p>—————————————————————————<br>
TypeError                                 Traceback (most recent call last)<br>
 in ()<br>
      3<br>
      4 # define training labels<br>
—-&gt; 5 ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])</p>
<p>TypeError: must be a unicode character, not list</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-482537" data-commentid="482537" data-postid="4401" data-belowelement="comment-482537" data-respondelement="respond" data-replyto="Reply to Drew" aria-label="Reply to Drew">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482647" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-482647" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2019 at 8:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-482647" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to hear that, I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-482647" data-commentid="482647" data-postid="4401" data-belowelement="comment-482647" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-489644" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-489644" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/892c1a10d00e550effcb93b021c8884a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/892c1a10d00e550effcb93b021c8884a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Avinash</span>
	                <span class="date">June 21, 2019 at 12:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-489644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p># define training labels<br>
ytrain = array([0 for _ in range(900)] + [1 for _ in range(900)])<br>
what is this line doing??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-489644" data-commentid="489644" data-postid="4401" data-belowelement="comment-489644" data-respondelement="respond" data-replyto="Reply to Avinash" aria-label="Reply to Avinash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-489681" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-489681" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2019 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-489681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Creating class labels for the samples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-489681" data-commentid="489681" data-postid="4401" data-belowelement="comment-489681" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490165" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-490165" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8ea1d49059c74db9c33960dd83dfc6ff.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8ea1d49059c74db9c33960dd83dfc6ff_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jeffrey</span>
	                <span class="date">June 25, 2019 at 12:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-490165" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>I am trying to use this to classify product reviews stored in 
multiple individual text files as having positive or negative sentiment.
 How do I use the pre-trained model to implement this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-490165" data-commentid="490165" data-postid="4401" data-belowelement="comment-490165" data-respondelement="respond" data-replyto="Reply to Jeffrey" aria-label="Reply to Jeffrey">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490205" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-490205" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 25, 2019 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-490205" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post shows how to use a pre-trained word embedding:<br>
<a href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" rel="nofollow ugc">https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-490205" data-commentid="490205" data-postid="4401" data-belowelement="comment-490205" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494083" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494083" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a79b28d2f89484afb334174aabcae29c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a79b28d2f89484afb334174aabcae29c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sixto Robayo</span>
	                <span class="date">July 24, 2019 at 3:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-494083" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, congratulations good tutorial. Help me Please, I must do a
 sentiment analysis on global warming, taking the data from Twitter, say
 10,000 tweets. How this approach might apply, that is, pre-trained word
 embedding to determine the polarity of sentiment, positive, neutral and
 negative. Thanks in advance.</p>
<p>Best regards.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-494083" data-commentid="494083" data-postid="4401" data-belowelement="comment-494083" data-respondelement="respond" data-replyto="Reply to Sixto Robayo" aria-label="Reply to Sixto Robayo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494148" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-494148" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 25, 2019 at 7:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-494148" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The model described in this post would be a good approach.</p>
<p>Start by collecting and cleaning the dataset:<br>
<a href="https://machinelearningmastery.com/clean-text-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/clean-text-machine-learning-python/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-494148" data-commentid="494148" data-postid="4401" data-belowelement="comment-494148" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494306" class="comment even depth-3 parent">

	      	<div id="li-comment-494306" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a79b28d2f89484afb334174aabcae29c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a79b28d2f89484afb334174aabcae29c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sixto Robayo</span>
	                <span class="date">July 26, 2019 at 2:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-494306" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Thanks a lot for the link.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-494306" data-commentid="494306" data-postid="4401" data-belowelement="comment-494306" data-respondelement="respond" data-replyto="Reply to Sixto Robayo" aria-label="Reply to Sixto Robayo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494358" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-494358" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 27, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-494358" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-494358" data-commentid="494358" data-postid="4401" data-belowelement="comment-494358" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494583" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-494583" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a79b28d2f89484afb334174aabcae29c_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a79b28d2f89484afb334174aabcae29c.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sixto Robayo</span>
	                <span class="date">July 29, 2019 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-494583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sr. Jason,</p>
<p>What tool do you suggest me or the procedure to follow to obtain the 
polarity or sentiment  score of the tweets, to continue with the 
Sentiment Analysis. I have collected 10,000 tweets and cleaned them 
following the good advice of: <a href="https://machinelearningmastery.com/clean-text-machine-learning-python/" rel="nofollow ugc">https://machinelearningmastery.com/clean-text-machine-learning-python/</a>.</p>
<p>Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-494583" data-commentid="494583" data-postid="4401" data-belowelement="comment-494583" data-respondelement="respond" data-replyto="Reply to Sixto Robayo" aria-label="Reply to Sixto Robayo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494609" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-494609" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2019 at 2:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-494609" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The above tutorial would be a good start.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-494609" data-commentid="494609" data-postid="4401" data-belowelement="comment-494609" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-497824" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-497824" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/c43cb83073f2426f94b614862a08e62b.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/c43cb83073f2426f94b614862a08e62b_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arjun Bali</span>
	                <span class="date">August 22, 2019 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-497824" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, I wanted to check with you on how to feed the 
Embeddings developed from word2vec into a classifier other than Neural 
nets. I gave it a thought maybe we need to represent every document as a
 single vector so for that we would either need to avrage out the word 
embedding from the ones we have generated or maybe do a weighted average
 using tf idf weights.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-497824" data-commentid="497824" data-postid="4401" data-belowelement="comment-497824" data-respondelement="respond" data-replyto="Reply to Arjun Bali" aria-label="Reply to Arjun Bali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-497856" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-497856" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-497856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The embedding vectors for your inputs are concatenated with other inputs and fed to the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-497856" data-commentid="497856" data-postid="4401" data-belowelement="comment-497856" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-501068" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-501068" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/c1dfec151d56696468cda6ce6707d3e0_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/c1dfec151d56696468cda6ce6707d3e0.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rango</span>
	                <span class="date">September 12, 2019 at 2:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-501068" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>First of all, let me thank you for your amazing article.Let me 
ask some question.If we train word2vec model on larger dataset than the 
label training set, can we get the generalization power for new words 
these are not in the label training set.<br>
For Example…<br>
In training set the words “My Puppies are small” are present.<br>
The test sample “I have two little puppies”.<br>
The word “little” is not in the training set but is in word2vec 
vocabulary.As the word “little” has similar meaning with “small” can we 
get similar result for two sentences.If we can get similar result can 
you explain why??<br>
Thank in advance!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-501068" data-commentid="501068" data-postid="4401" data-belowelement="comment-501068" data-respondelement="respond" data-replyto="Reply to Rango" aria-label="Reply to Rango">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-501111" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-501111" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 12, 2019 at 5:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-501111" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No. The model must see the words during training. They must be part of the known vocab.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-501111" data-commentid="501111" data-postid="4401" data-belowelement="comment-501111" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-510833" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-510833" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 16, 2019 at 7:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-510833" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I was keep reading this atricle multiple times, still I did not 
understand the different between the section of train embedding layer 
and the section of word2vec. I mean is not word2vec is ac training an 
embedding layer or not?<br>
I hope my question is clear<br>
thanks prof.Jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-510833" data-commentid="510833" data-postid="4401" data-belowelement="comment-510833" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511040" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511040" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2019 at 7:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511040" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>word2vec is the general method and the name of a specific algorithm. </p>
<p>We can use the word2vec algorithm or a neural net to learn the vectors.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511040" data-commentid="511040" data-postid="4401" data-belowelement="comment-511040" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511156" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-511156" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 17, 2019 at 7:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511156" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you mean that section 3-train embedding layer has the same 
purpose of both sections 4- train word2vec embedding and 5-use 
pre-trained embedding?<br>
when you said (or a neural net) is it the third section ( 3-train embedding layer)?<br>
thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511156" data-commentid="511156" data-postid="4401" data-belowelement="comment-511156" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511249" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511249" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2019 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many ways to develop a word embedding, such as standalone algorithm or as part of a neural net.</p>
<p>Perhaps I don’t understand your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511249" data-commentid="511249" data-postid="4401" data-belowelement="comment-511249" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511261" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-511261" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 18, 2019 at 7:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511261" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>which section of the above article represents a standalone algorithm and which one represents l network?as apart of neural?<br>
thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511261" data-commentid="511261" data-postid="4401" data-belowelement="comment-511261" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511305" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511305" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2019 at 1:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511305" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The section titled “Train Embedding Layer” shows how to train an embedding layer as part of the network.</p>
<p>The section titled “Train word2vec Embedding” shows how to fit a 
word2vec standalone model, then section “Use Pre-trained Embedding” 
shows how to use it in a network.</p>
<p>Perhaps re-read the tutorial? It’s all spelled out for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511305" data-commentid="511305" data-postid="4401" data-belowelement="comment-511305" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511348" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-511348" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 18, 2019 at 6:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511348" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I already read it many times but I am confused in which sections I
 can use them independently (because they have the same purpose) and 
compare between the results, Now I confirmed my understanding by your 
last answer..which show that section 3 is independent from both section 4
 and 5  whcih must combined to compare the result with section 3.<br>
thank you so much Prof. Json</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511348" data-commentid="511348" data-postid="4401" data-belowelement="comment-511348" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511446" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511446" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2019 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511446" data-commentid="511446" data-postid="4401" data-belowelement="comment-511446" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511403" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-511403" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 19, 2019 at 1:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511403" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>why in this section of code positive_lines and positive_docs differs?<br>
# load training data<br>
positive_lines = process_docs(‘txt_sentoken/pos’, vocab, True)<br>
negative_lines = process_docs(‘txt_sentoken/neg’, vocab, True)<br>
sentences = negative_docs + positive_docs</p>
<p>the same thing for negative_lines  and negative_docs, it seems that it should have the same name… am I right?</p>
<p>I mean like this<br>
# load training data<br>
positive_docs= process_docs(‘txt_sentoken/pos’, vocab, True)<br>
negative_docs = process_docs(‘txt_sentoken/neg’, vocab, True)<br>
sentences = negative_docs + positive_docs</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511403" data-commentid="511403" data-postid="4401" data-belowelement="comment-511403" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511454" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511454" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2019 at 7:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We are calling the same code, but loading from different source directories.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511454" data-commentid="511454" data-postid="4401" data-belowelement="comment-511454" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511564" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-511564" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 19, 2019 at 10:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>maybe you misunderstood the question<br>
# load training data<br>
positive_lines = process_docs(‘txt_sentoken/pos’, vocab, True)<br>
negative_lines = process_docs(‘txt_sentoken/neg’, vocab, True)<br>
sentences = negative_docs + positive_docs</p>
<p>an error appears for negative_docs and positive_docs because they are
 undefined, given that I copied the entire code without any changes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511564" data-commentid="511564" data-postid="4401" data-belowelement="comment-511564" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511617" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511617" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2019 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511617" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, fixed!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511617" data-commentid="511617" data-postid="4401" data-belowelement="comment-511617" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511772" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-511772" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8a24233ac4fd2ea62f6ce85d6ae9c4f5_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8a24233ac4fd2ea62f6ce85d6ae9c4f5.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fabien</span>
	                <span class="date">November 21, 2019 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511772" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I’m using sequence of numeric values coming from product description that I preprocessed via tokenization.<br>
I’m trying to set up a RNN model based on regression to predict the price of the product<br>
For now, I only added a LSTM layer and a Dense(1) layer for the output.<br>
How would you set up this kind of model regarding the different layers ?<br>
Moreover, which metric would you use in the configururation of the model for training?</p>
<p>Sorry if my questions are a bit confuse<br>
Thank you</p>
<p>PS : I have other features than product description but I don’t know 
how I can manage them (concatenate them together to have a complete 
feature to use as input for the model ? or only some of them ?)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511772" data-commentid="511772" data-postid="4401" data-belowelement="comment-511772" data-respondelement="respond" data-replyto="Reply to Fabien" aria-label="Reply to Fabien">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511791" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511791" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 21, 2019 at 1:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511791" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend testing many different models and many different configurations and use results to guide the exploration.</p>
<p>For regression, MSE or RMSE are a good start. Also scaling data prior to fitting may help.</p>
<p>If you have descriptions, e.g. text, a bag of words model can encode 
the text and be fed to the model by a separate input, e.g. see this:<br>
<a href="https://machinelearningmastery.com/keras-functional-api-deep-learning/" rel="nofollow ugc">https://machinelearningmastery.com/keras-functional-api-deep-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511791" data-commentid="511791" data-postid="4401" data-belowelement="comment-511791" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-511935" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-511935" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/070be68e6e594dcbed196bac4955792d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">martin</span>
	                <span class="date">November 22, 2019 at 6:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511935" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In this example, tokenizer.fit_on_texts does the ‘one hot encoding’ internally? Users don’t need to worry about the encoding.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511935" data-commentid="511935" data-postid="4401" data-belowelement="comment-511935" data-respondelement="respond" data-replyto="Reply to martin" aria-label="Reply to martin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-511983" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-511983" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2019 at 6:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-511983" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Integer encoding. Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-511983" data-commentid="511983" data-postid="4401" data-belowelement="comment-511983" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512595" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-512595" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/85c86f283d8927eb02950ba09eba7686.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/85c86f283d8927eb02950ba09eba7686_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.biology.lu.se/nikolay-oskolkov" rel="external nofollow ugc" class="url">Nikolay Oskolkov</a></span>
	                <span class="date">November 27, 2019 at 8:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-512595" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, why is the Dense network here <a href="https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/" rel="nofollow ugc">https://machinelearningmastery.com/deep-learning-bag-of-words-model-sentiment-analysis/</a> outperforms the CNN in this tutorial for the movie review sentiment analysis data set?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512595" data-commentid="512595" data-postid="4401" data-belowelement="comment-512595" data-respondelement="respond" data-replyto="Reply to Nikolay Oskolkov" aria-label="Reply to Nikolay Oskolkov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512624" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512624" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 27, 2019 at 1:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-512624" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question!</p>
<p>The models are for demonstration (e.g. here’s how you could implement
 the approach), neither are optimized to best solve the problem.</p>
<p>In fact, this applies to all code on the blog.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512624" data-commentid="512624" data-postid="4401" data-belowelement="comment-512624" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512843" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-512843" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 28, 2019 at 10:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-512843" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>1-Google word2vec used CBOW and skip-gram to build their model, what did we use here to build our pre-trained model?</p>
<p>2- I wonder why Glove has its model as .txt format file while Google 
word2vec is .bin format? and if I used one of these formats does it 
affect on the code I mean if I used google word2vec instead of Golve 
should I make variant changes on the code?</p>
<p>3- Does the .bin and .txt model formats have the same purpose? if 
they have the same purpose but only different formats which one is 
better?</p>
<p>Thanks, prof.Jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512843" data-commentid="512843" data-postid="4401" data-belowelement="comment-512843" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512892" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-512892" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2019 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-512892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We learned the embedding as part of the model directly.</p>
<p>Different formats – no idea. Researcher preference. Format does not matter.</p>
<p>Yes, both contain word vectors.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512892" data-commentid="512892" data-postid="4401" data-belowelement="comment-512892" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512979" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-512979" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">November 29, 2019 at 7:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-512979" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I understand from my reading on the Gensim website that .txt format model is called KeyedVectors, is my understanding right?<br>
<a href="https://radimrehurek.com/gensim/models/keyedvectors.html" rel="nofollow ugc">https://radimrehurek.com/gensim/models/keyedvectors.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-512979" data-commentid="512979" data-postid="4401" data-belowelement="comment-512979" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-513026" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-513026" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 30, 2019 at 6:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-513026" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I guess so.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-513026" data-commentid="513026" data-postid="4401" data-belowelement="comment-513026" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516919" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-516919" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3f704b0e9996c442674813c370b25e4d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3f704b0e9996c442674813c370b25e4d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Makhloufi lyes</span>
	                <span class="date">January 2, 2020 at 9:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-516919" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason, thank you for this tutorial. I have a trouble when I 
pass my vocabulary into Word2Vec model the size of learned words is 
dramatically decreasing, can you enlighten me on this please.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516919" data-commentid="516919" data-postid="4401" data-belowelement="comment-516919" data-respondelement="respond" data-replyto="Reply to Makhloufi lyes" aria-label="Reply to Makhloufi lyes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516920" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-516920" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3f704b0e9996c442674813c370b25e4d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3f704b0e9996c442674813c370b25e4d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lyes Makhloufi</span>
	                <span class="date">January 2, 2020 at 9:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-516920" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I 28830 as initial vocabulary size, I get only 119 as learned words after Word2Vec.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516920" data-commentid="516920" data-postid="4401" data-belowelement="comment-516920" data-respondelement="respond" data-replyto="Reply to Lyes Makhloufi" aria-label="Reply to Lyes Makhloufi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516957" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-516957" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 3, 2020 at 7:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-516957" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps your words are not in the pre-trained model. In that 
case, you may need to change your words or train your own embedding.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516957" data-commentid="516957" data-postid="4401" data-belowelement="comment-516957" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516956" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-516956" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 3, 2020 at 7:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-516956" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow. Sorry, what is the problem exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-516956" data-commentid="516956" data-postid="4401" data-belowelement="comment-516956" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517023" class="comment even depth-3 parent">

	      	<div id="li-comment-517023" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3f704b0e9996c442674813c370b25e4d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3f704b0e9996c442674813c370b25e4d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lyes Makhloufi</span>
	                <span class="date">January 4, 2020 at 3:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-517023" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I’m trying to train my word2vec model as you did.</p>
<p>model = Word2Vec(sentences, size=100, window=5, workers=8, min_count=1)</p>
<p>My sentences variable sentences contain 28830 but my vocab length is 119.</p>
<p>words = list(model.wv.vocab)<br>
print(‘Vocabulary size: %d’ % len(words)) *** this line print 119 ***</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517023" data-commentid="517023" data-postid="4401" data-belowelement="comment-517023" data-respondelement="respond" data-replyto="Reply to Lyes Makhloufi" aria-label="Reply to Lyes Makhloufi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517058" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-517058" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 4, 2020 at 8:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-517058" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you don’t have many words in your dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517058" data-commentid="517058" data-postid="4401" data-belowelement="comment-517058" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-517606" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-517606" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/80cab38e66638e60627054049d51403e.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/80cab38e66638e60627054049d51403e_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prashant Gavali</span>
	                <span class="date">January 11, 2020 at 12:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-517606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for such great post. I have a question. If I am using 
RNN for sentence sentiment classification, whether embedding layer is 
again required or we can pass pre-trained word vector for each word at 
each timestamp. If we have to use embedding layer, what should be the 
size of input_length? One or any other. Thank you in advanced</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517606" data-commentid="517606" data-postid="4401" data-belowelement="comment-517606" data-respondelement="respond" data-replyto="Reply to Prashant Gavali" aria-label="Reply to Prashant Gavali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-517629" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-517629" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 11, 2020 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-517629" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps test different lengths and see what works best for your dataset.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-517629" data-commentid="517629" data-postid="4401" data-belowelement="comment-517629" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-519211" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-519211" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/79b9cd0b0ecf1f37a51840aaed2702ef_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/79b9cd0b0ecf1f37a51840aaed2702ef.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eric</span>
	                <span class="date">January 25, 2020 at 5:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-519211" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>First of all, I praise your hard word. Your content has been of immense help to me every single day since I started this path. </p>
<p>And I have a question as well. Is there a reason not to specify a 
batch-size? I’ve seen that’s like the standard practice in all books, 
however in this case I don’t see it and I am curious about it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-519211" data-commentid="519211" data-postid="4401" data-belowelement="comment-519211" data-respondelement="respond" data-replyto="Reply to Eric" aria-label="Reply to Eric">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-519267" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-519267" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 26, 2020 at 5:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-519267" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>Yes. I often use the default batch size of 32.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-519267" data-commentid="519267" data-postid="4401" data-belowelement="comment-519267" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-519741" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-519741" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">January 30, 2020 at 2:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-519741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Traceback (most recent call last):</p>
<p>    raw_embedding = load_embedding(‘glove.6B/glove.6B/glove.6B.100d.txt’)</p>
<p>    embedding[parts[0]] = asarray(parts[1:], dtype=’float32′)</p>
<p>    return array(a, dtype, copy=False, order=order)<br>
ValueError: could not convert string to float: ‘ng’</p>
<p>could anyone help me why this error appears although I copied and paste the same code?<br>
The code  run only if I remove dtype=’float32′</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-519741" data-commentid="519741" data-postid="4401" data-belowelement="comment-519741" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-519766" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-519766" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2020 at 6:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-519766" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, this might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-519766" data-commentid="519766" data-postid="4401" data-belowelement="comment-519766" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-519859" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-519859" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">January 31, 2020 at 1:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-519859" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>simply, the solution of previous mentioned issue is to fix this line of code</p>
<p>file = open(filename,’r’)</p>
<p>to make it<br>
file = open(filename,encoding=”utf8″)<br>
this may help anyone who has the same issue of me,<br>
thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-519859" data-commentid="519859" data-postid="4401" data-belowelement="comment-519859" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-519898" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-519898" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 31, 2020 at 7:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-519898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice, thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-519898" data-commentid="519898" data-postid="4401" data-belowelement="comment-519898" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-521716" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-521716" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/d9194b28b59270cf152168d37a2ff953.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/d9194b28b59270cf152168d37a2ff953_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rony Sharma</span>
	                <span class="date">February 15, 2020 at 1:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-521716" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason Brownlee,<br>
I am Use in Your Code Its a great for me. But I have many problems, like
 When I am using 700 training data and test data 300 there is a problem 
shows that: </p>
<p>ValueError: Input arrays should have the same number of samples as 
target arrays. Found 2700 input samples and 2100 target samples.</p>
<p>How to Solved this problem? Please help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-521716" data-commentid="521716" data-postid="4401" data-belowelement="comment-521716" data-respondelement="respond" data-replyto="Reply to Rony Sharma" aria-label="Reply to Rony Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-521753" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-521753" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2020 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-521753" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you split the input, you must also split the output/target array in the same way.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-521753" data-commentid="521753" data-postid="4401" data-belowelement="comment-521753" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-521822" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-521822" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">February 15, 2020 at 11:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-521822" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I wonder why I should use the vocabulary text file in the classification part?<br>
we used it in the feature extraction part (when we built our pre-trained
 model) to save most frequent words in the corpus, but why we used it in
 the model construction part for classification when we read any dataset
 to classify it according to the pre-trained model features?<br>
given that when I removed the vocab file from the classification part, I
 got better f1-score, then I start wondering why we should use it in the
 classification part??</p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-521822" data-commentid="521822" data-postid="4401" data-belowelement="comment-521822" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-521857" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-521857" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 16, 2020 at 6:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-521857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We use it to trim the data down to the pre-defined vocab – I believe.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-521857" data-commentid="521857" data-postid="4401" data-belowelement="comment-521857" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522494" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-522494" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/b8b83a722f995f12770bd3763efc8221.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/b8b83a722f995f12770bd3763efc8221_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rony Sharma</span>
	                <span class="date">February 21, 2020 at 12:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-522494" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Brownlee,</p>
<p>How are You?  Hopefully,  You are well.  How to implement the RNN 
model in this embedding layer code. Give me some Suggestions. Also, any 
link on how to implement the embedding layer with RNN. It will be 
grateful for me </p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522494" data-commentid="522494" data-postid="4401" data-belowelement="comment-522494" data-respondelement="respond" data-replyto="Reply to Rony Sharma" aria-label="Reply to Rony Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522562" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-522562" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 21, 2020 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-522562" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have many examples, perhaps start here:<br>
<a href="https://machinelearningmastery.com/start-here/#nlp" rel="nofollow ugc">https://machinelearningmastery.com/start-here/#nlp</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522562" data-commentid="522562" data-postid="4401" data-belowelement="comment-522562" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-522938" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-522938" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">February 23, 2020 at 11:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-522938" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How I can upload image to clarify my question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522938" data-commentid="522938" data-postid="4401" data-belowelement="comment-522938" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522979" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-522979" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 24, 2020 at 7:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-522979" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are many places on the web where you can upload images. Blog, social, github, imgur, etc.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522979" data-commentid="522979" data-postid="4401" data-belowelement="comment-522979" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-522992" class="comment even depth-3 parent">

	      	<div id="li-comment-522992" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/20e0808880e4602df7c24282d02736af_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HSA</span>
	                <span class="date">February 24, 2020 at 9:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-522992" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>mmm I do not know if you understand my question, I want to upload
 image in the comments section of your article to ask questions depend 
on the image?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-522992" data-commentid="522992" data-postid="4401" data-belowelement="comment-522992" data-respondelement="respond" data-replyto="Reply to HSA" aria-label="Reply to HSA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523001" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-523001" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 24, 2020 at 1:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-523001" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. The answer is to upload it elsewhere and link to it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-523001" data-commentid="523001" data-postid="4401" data-belowelement="comment-523001" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-523316" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-523316" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/97f7ccf1db8455d5050dfad304f977c7.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/97f7ccf1db8455d5050dfad304f977c7_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Md. Asraful Islam</span>
	                <span class="date">February 26, 2020 at 5:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-523316" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Brownlee,</p>
<p>How are you? hope you are fine. </p>
<p>Sir, I need your help. I need to create a glove file for my sentiment
 analysis but I don’t know to create a glove file. I saw your website 
where you use the pre-trained glove code that is ” glove.6B.100d.txt ” 
file. But I need to create glove file for my dataset. Could you give me a
 suggestion or code how I can create my own glove.txt file.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-523316" data-commentid="523316" data-postid="4401" data-belowelement="comment-523316" data-respondelement="respond" data-replyto="Reply to Md. Asraful Islam" aria-label="Reply to Md. Asraful Islam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-523394" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-523394" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">February 27, 2020 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-523394" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have an exampel of creating a glove embedding.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-523394" data-commentid="523394" data-postid="4401" data-belowelement="comment-523394" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-526481" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-526481" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/21c5b86e94591bfb0c344df739efb9d0_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/21c5b86e94591bfb0c344df739efb9d0.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Saifur Rahman</span>
	                <span class="date">March 23, 2020 at 12:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-526481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason Brownlee,<br>
Which type of plot used in this CNN model? Give me some suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526481" data-commentid="526481" data-postid="4401" data-belowelement="comment-526481" data-respondelement="respond" data-replyto="Reply to Saifur Rahman" aria-label="Reply to Saifur Rahman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526516" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-526516" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 23, 2020 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-526516" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t understand. What would you plot exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526516" data-commentid="526516" data-postid="4401" data-belowelement="comment-526516" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526612" class="comment even depth-3 parent">

	      	<div id="li-comment-526612" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/21c5b86e94591bfb0c344df739efb9d0_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/21c5b86e94591bfb0c344df739efb9d0.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Saifur Rahman</span>
	                <span class="date">March 24, 2020 at 12:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-526612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Scatter plot .</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526612" data-commentid="526612" data-postid="4401" data-belowelement="comment-526612" data-respondelement="respond" data-replyto="Reply to Saifur Rahman" aria-label="Reply to Saifur Rahman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-526650" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-526650" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 24, 2020 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-526650" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know how you might plot a model using a scatter plot.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-526650" data-commentid="526650" data-postid="4401" data-belowelement="comment-526650" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-527030" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-527030" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/b8b83a722f995f12770bd3763efc8221.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/b8b83a722f995f12770bd3763efc8221_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rony Sharma</span>
	                <span class="date">March 27, 2020 at 12:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-527030" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>How to get f1-score in these models or code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-527030" data-commentid="527030" data-postid="4401" data-belowelement="comment-527030" data-respondelement="respond" data-replyto="Reply to Rony Sharma" aria-label="Reply to Rony Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-527083" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-527083" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 27, 2020 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-527083" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this tutorial for using f1 with keras:<br>
<a href="https://machinelearningmastery.com/how-to-calculate-precision-recall-f1-and-more-for-deep-learning-models/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-calculate-precision-recall-f1-and-more-for-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-527083" data-commentid="527083" data-postid="4401" data-belowelement="comment-527083" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-529615" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-529615" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/21c5b86e94591bfb0c344df739efb9d0_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/21c5b86e94591bfb0c344df739efb9d0.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Saifur Rahman</span>
	                <span class="date">April 14, 2020 at 1:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-529615" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello sir,<br>
in this code for how to get confusion matrix value? Please help me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529615" data-commentid="529615" data-postid="4401" data-belowelement="comment-529615" data-respondelement="respond" data-replyto="Reply to Saifur Rahman" aria-label="Reply to Saifur Rahman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-529658" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-529658" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2020 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-529658" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This tutorial will show you how:<br>
<a href="https://machinelearningmastery.com/how-to-calculate-precision-recall-f1-and-more-for-deep-learning-models/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-calculate-precision-recall-f1-and-more-for-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-529658" data-commentid="529658" data-postid="4401" data-belowelement="comment-529658" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530855" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-530855" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8d67e1fe659c67d1b88b212bd6220220.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8d67e1fe659c67d1b88b212bd6220220_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow ugc" class="url">Michael Szczepaniak</a></span>
	                <span class="date">April 22, 2020 at 3:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-530855" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Assuming each review is 0 if negative and 1 if positive, is there
 a straightforward way to see the probabilities the model assigns to 
each review?</p>
<p>I’ll be using pre-trained embeddings and after the model is trained 
on a set of documents, I need to be able to get send the model a 
document and have it give me a probability if it’s relevant wrt my 
training data (close to 1 if it is, close to 0 if it isn’t).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530855" data-commentid="530855" data-postid="4401" data-belowelement="comment-530855" data-respondelement="respond" data-replyto="Reply to Michael Szczepaniak" aria-label="Reply to Michael Szczepaniak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530856" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-530856" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8d67e1fe659c67d1b88b212bd6220220.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8d67e1fe659c67d1b88b212bd6220220_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow ugc" class="url">Michael Szczepaniak</a></span>
	                <span class="date">April 22, 2020 at 3:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-530856" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think your 2018-11-29 reply to chkib arslan is what I was looking for.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530856" data-commentid="530856" data-postid="4401" data-belowelement="comment-530856" data-respondelement="respond" data-replyto="Reply to Michael Szczepaniak" aria-label="Reply to Michael Szczepaniak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530916" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-530916" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 22, 2020 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-530916" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great!</p>
<p>Also see this:<br>
<a href="https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-make-classification-and-regression-predictions-for-deep-learning-models-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530916" data-commentid="530916" data-postid="4401" data-belowelement="comment-530916" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530915" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-530915" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 22, 2020 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-530915" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, calling model.predict() gives the probability.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530915" data-commentid="530915" data-postid="4401" data-belowelement="comment-530915" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-530857" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-530857" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8d67e1fe659c67d1b88b212bd6220220.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8d67e1fe659c67d1b88b212bd6220220_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/michaelszczepaniak" rel="external nofollow ugc" class="url">Michael Szczepaniak</a></span>
	                <span class="date">April 22, 2020 at 3:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-530857" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there a way to save the CNN model itself after it’s been 
trained?  I need to create lots of these and eventually version control 
them, but now, I just need to be able to save the weights and the 
configuration that I can reconstitute later.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530857" data-commentid="530857" data-postid="4401" data-belowelement="comment-530857" data-respondelement="respond" data-replyto="Reply to Michael Szczepaniak" aria-label="Reply to Michael Szczepaniak">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-530917" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-530917" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 22, 2020 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-530917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see this:<br>
<a href="https://machinelearningmastery.com/save-load-keras-deep-learning-models/" rel="nofollow ugc">https://machinelearningmastery.com/save-load-keras-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-530917" data-commentid="530917" data-postid="4401" data-belowelement="comment-530917" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-533254" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-533254" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/01f395a61b3b96f0647eb36267e1d4c7.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/01f395a61b3b96f0647eb36267e1d4c7_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ibrahim</span>
	                <span class="date">May 5, 2020 at 3:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-533254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In your model, How you handle OOV(out of Vocab) words?<br>
I am looking for implementing Character level word embedding to handle 
OOV word. And I find 1D CNN in kim,s paper. But I don’t understand how i
 train them. And how i find embedding matrics. Could you help me?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533254" data-commentid="533254" data-postid="4401" data-belowelement="comment-533254" data-respondelement="respond" data-replyto="Reply to Ibrahim" aria-label="Reply to Ibrahim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-533293" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-533293" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 5, 2020 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-533293" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We remove them during pre-processing or map them to index 0 for “unknown”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-533293" data-commentid="533293" data-postid="4401" data-belowelement="comment-533293" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-534894" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-534894" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/25db5e399a68b3ef98a42e7ad0cb661a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/25db5e399a68b3ef98a42e7ad0cb661a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammad</span>
	                <span class="date">May 16, 2020 at 4:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-534894" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>First, thanks for your great post! </p>
<p>I have a question. Imagine that I have a dataset, including about 
2000 reviews, and only 200 of them are regarded as negative, which means
 the rest of the reviews demonstrate positive sentiment. </p>
<p>If I train the model on all data, the accuracy is about 97 percent, 
which I think is a little imaginary! However, if I select 200 negatives 
and 200 random positive reviews and fit the model on 400 data, the 
accuracy decreases to 85 percent. Which approach is more academic, 
scientific, and accurate?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534894" data-commentid="534894" data-postid="4401" data-belowelement="comment-534894" data-respondelement="respond" data-replyto="Reply to Mohammad" aria-label="Reply to Mohammad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534930" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-534930" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 16, 2020 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-534930" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Don’t use accuracy:<br>
<a href="https://machinelearningmastery.com/failure-of-accuracy-for-imbalanced-class-distributions/" rel="nofollow ugc">https://machinelearningmastery.com/failure-of-accuracy-for-imbalanced-class-distributions/</a></p>
<p>Select a better metric:<br>
<a href="https://machinelearningmastery.com/tour-of-evaluation-metrics-for-imbalanced-classification/" rel="nofollow ugc">https://machinelearningmastery.com/tour-of-evaluation-metrics-for-imbalanced-classification/</a></p>
<p>Perhaps explore class weighting to lift model skill:<br>
<a href="https://machinelearningmastery.com/cost-sensitive-neural-network-for-imbalanced-classification/" rel="nofollow ugc">https://machinelearningmastery.com/cost-sensitive-neural-network-for-imbalanced-classification/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534930" data-commentid="534930" data-postid="4401" data-belowelement="comment-534930" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-534941" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-534941" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/25db5e399a68b3ef98a42e7ad0cb661a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/25db5e399a68b3ef98a42e7ad0cb661a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammad</span>
	                <span class="date">May 16, 2020 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-534941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason! Those were really helpful.</p>
<p>I got another question. I’ve found this post for text encoding needed for the embedding layer of a CNN.</p>
<p><a href="https://machinelearningmastery.com/how-to-prepare-categorical-data-for-deep-learning-in-python/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-prepare-categorical-data-for-deep-learning-in-python/</a></p>
<p>What’s the difference between one-hot encoding and Word2Vec function? And which one is more powerful?</p>
<p>Thanks a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534941" data-commentid="534941" data-postid="4401" data-belowelement="comment-534941" data-respondelement="respond" data-replyto="Reply to Mohammad" aria-label="Reply to Mohammad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-534948" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-534948" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 16, 2020 at 10:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-534948" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are both a distributed representation.</p>
<p>The one-hot is sparse and specific. The embedding is learned and more
 flexible – capable of adapting to the specifics of your data and model.
 Yes, it can be more useful/powerful.</p>
<p>Try each method and use whatever gives the best performance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-534948" data-commentid="534948" data-postid="4401" data-belowelement="comment-534948" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535254" class="comment even depth-3 parent">

	      	<div id="li-comment-535254" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/25db5e399a68b3ef98a42e7ad0cb661a_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/25db5e399a68b3ef98a42e7ad0cb661a.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohammad</span>
	                <span class="date">May 18, 2020 at 6:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-535254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks,</p>
<p>Can I use Word2Vec for non_English texts or captions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-535254" data-commentid="535254" data-postid="4401" data-belowelement="comment-535254" data-respondelement="respond" data-replyto="Reply to Mohammad" aria-label="Reply to Mohammad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-535328" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-535328" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 19, 2020 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-535328" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-535328" data-commentid="535328" data-postid="4401" data-belowelement="comment-535328" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-538217" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-538217" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/deda87a5010b1d1ab728f0e61c58559b.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/deda87a5010b1d1ab728f0e61c58559b_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dilani</span>
	                <span class="date">June 5, 2020 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-538217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I’m using LSTM and glove pre trained word embeddings to build a 
sentiment analysis model and the code is almost similar to the one you 
have written here. Currently I’m struggling to find a way to use this 
model to predict the sentiment when we give a row text as the input.I’m 
loading the model which was saved as .h5 file and I’m doing the same 
pre-processing process to the text which i did while training the model.
 Apart from that what else I should do before calling model.predict 
method.</p>
<p>I’m new to machine learning so desperately looking for an answer to 
this. Couldn’t find any proper solution even though i googled. I would 
really appreciate if you can guide me on this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-538217" data-commentid="538217" data-postid="4401" data-belowelement="comment-538217" data-respondelement="respond" data-replyto="Reply to Dilani" aria-label="Reply to Dilani">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-538291" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-538291" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 6, 2020 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-538291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The data prep objects should be saved with the model, e.g. identical to what was used to prepare the training set.</p>
<p>Beyond that, it sounds like you’re on the right track. Perhaps you need to step through your code/debug.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-538291" data-commentid="538291" data-postid="4401" data-belowelement="comment-538291" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-540272" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-540272" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/b7e998cbe64f709067e160ea054bc78d.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/b7e998cbe64f709067e160ea054bc78d_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jay</span>
	                <span class="date">June 20, 2020 at 3:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-540272" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Suppose that I train a model using the pretrained GLove or 
Word2Vec. But when testing on a completely new value shouldn’t i need to
 get the word vectors of the given input ?? So i will have to update the
 embedding ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540272" data-commentid="540272" data-postid="4401" data-belowelement="comment-540272" data-respondelement="respond" data-replyto="Reply to Jay" aria-label="Reply to Jay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-540333" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-540333" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2020 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-540333" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If text contains a word not known to the embedding, it is mapped to the value 0 which means “unknown”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-540333" data-commentid="540333" data-postid="4401" data-belowelement="comment-540333" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-592534" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-592534" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/ec380d6ee6717665be601fb1ecf29929.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/ec380d6ee6717665be601fb1ecf29929_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmad</span>
	                <span class="date">January 10, 2021 at 11:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-592534" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your great post! </p>
<p>how can I detect emotion recognition in the text using ML algorithms in Python?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-592534" data-commentid="592534" data-postid="4401" data-belowelement="comment-592534" data-respondelement="respond" data-replyto="Reply to Ahmad" aria-label="Reply to Ahmad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-592543" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-592543" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">January 10, 2021 at 1:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-592543" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with a dataset that you can use to train a model on the emotions you’re interested in identifying.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-592543" data-commentid="592543" data-postid="4401" data-belowelement="comment-592543" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-602041" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-602041" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/f574f6c7b37412352a59528043eb4fb7_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/f574f6c7b37412352a59528043eb4fb7.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SK</span>
	                <span class="date">March 26, 2021 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602041" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your great post!</p>
<p>on your post, you utilized supervised neural network model to 
automatically classify movie reviews as Positive or Negative. I was 
wondering how to we classify or cluster unlabled movie reviews as 
Positive or Negative, this is unsupervised method.</p>
<p>Also, do you have the information about “Positive and Negative Words 
Databases” which contain English words associated with a sentiment score
 included between -1 (most negative) and 1 (most positive). If so, which
 one do you recommend mostly. Is it free or have to buy? </p>
<p>Thank you!!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602041" data-commentid="602041" data-postid="4401" data-belowelement="comment-602041" data-respondelement="respond" data-replyto="Reply to SK" aria-label="Reply to SK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-602428" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-602428" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2021 at 5:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have historical examples with class labels, you can train a
 model on available data, then use that model to classify new examples 
as one of the two labels.</p>
<p>If you do not have labels, perhaps you can label them manually?</p>
<p>If you don’t need/want labels then it will be an unsupervised learning problem, I guess.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602428" data-commentid="602428" data-postid="4401" data-belowelement="comment-602428" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-602398" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-602398" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5a3aac3eda7f66f5010782c7380f18d8_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5a3aac3eda7f66f5010782c7380f18d8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sudhakar Vankamamidi</span>
	                <span class="date">March 29, 2021 at 2:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602398" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Code samples depicting sentiment analysis would have been more helpful</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602398" data-commentid="602398" data-postid="4401" data-belowelement="comment-602398" data-respondelement="respond" data-replyto="Reply to Sudhakar Vankamamidi" aria-label="Reply to Sudhakar Vankamamidi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-602479" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-602479" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2021 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602479" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The above examples is exactly this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602479" data-commentid="602479" data-postid="4401" data-belowelement="comment-602479" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-602493" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-602493" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/f574f6c7b37412352a59528043eb4fb7_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/f574f6c7b37412352a59528043eb4fb7.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SK</span>
	                <span class="date">March 29, 2021 at 7:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for your reply. No, you have not historical examples with 
class labels and I prefer not to label them in considering of subjective
 bias.</p>
<p>Yes, I recon it will be an unsupervised learning problem and the 
method of clustering and that is why I was wondering if have the 
information about “Positive and Negative Words Databases” which contain 
English words associated with a sentiment score included between -1 
(most negative) and 1 (most positive). If so, which one do you recommend
 mostly. Is it free or have to buy? Then I can cluster these documents 
according to their distribution of sentiment scores of words from 
document. Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602493" data-commentid="602493" data-postid="4401" data-belowelement="comment-602493" data-respondelement="respond" data-replyto="Reply to SK" aria-label="Reply to SK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-602600" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-602600" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2021 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you do not have labelled data and do not want to label it, then it does sound like a clustering problem.</p>
<p>If you want to use sentiment of already classified data, then this 
sounds like a straight programming problem – not machine learning.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602600" data-commentid="602600" data-postid="4401" data-belowelement="comment-602600" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-602511" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-602511" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/da3963b5f23c260986e85d1a1ea3a5f5.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/da3963b5f23c260986e85d1a1ea3a5f5_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali Al Bataineh</span>
	                <span class="date">March 29, 2021 at 11:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602511" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
Nice article like always.<br>
You have use tokenizer to mapping of words to integers, which is I 
clearly understand it because the embedding layer expects the input to 
be in integer form. In case of tf-idf or one-hot encoding approaches, do
 they also except the input to be in integer form before using them? 
Last question is that the embedding layer also require all inputs to be 
in the same length; does other approaches like tf-idf also require the 
same?</p>
<p>Thank you so much! You’re the best in the west!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602511" data-commentid="602511" data-postid="4401" data-belowelement="comment-602511" data-respondelement="respond" data-replyto="Reply to Ali Al Bataineh" aria-label="Reply to Ali Al Bataineh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-602602" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-602602" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">March 30, 2021 at 5:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-602602" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Typically bag of words and one hot encoding methods allow you to convert text to integer vectors directly.</p>
<p>Embedding layers assume inputs are integers, e.g. ordinal encoded words/categories.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-602602" data-commentid="602602" data-postid="4401" data-belowelement="comment-602602" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-603446" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-603446" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7101ab71fed5e423aba266f9e45b953d_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/7101ab71fed5e423aba266f9e45b953d.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.populatech.com/" rel="external nofollow ugc" class="url">Emran</a></span>
	                <span class="date">April 5, 2021 at 2:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-603446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Sir, </p>
<p>Thanks for this precious article.</p>
<p>However, I have a question that if I want to split the dataset into 
80% for training and 20% for test. Therefore, how can I adapt the code. </p>
<p>I tried to do the following, but it doesn’t work!</p>
<p>def process_docs(directory, vocab, is_trian):<br>
	documents = list()<br>
	# walk through all files in the folder<br>
	for filename in listdir(directory):<br>
		# skip any reviews in the test set<br>
		if is_trian and filename.startswith(‘cv8’) and filename.startswith(‘cv9’):<br>
			continue<br>
		if not is_trian and not filename.startswith(‘cv8’) and not filename.startswith(‘cv9’):<br>
			continue<br>
		# create the full path of the file to open<br>
		path = directory + ‘/’ + filename<br>
		# load the doc<br>
		doc = load_doc(path)<br>
		# clean doc<br>
		tokens = clean_doc(doc, vocab)<br>
		# add to list<br>
		documents.append(tokens)<br>
	return documents</p>
<p># define training labels<br>
ytrain = array([0 for _ in range(800)] + [1 for _ in range(800)])<br>
# define test labels<br>
ytest = array([0 for _ in range(200)] + [1 for _ in range(200)])</p>
<p>I shall be thankful to you for your assistance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603446" data-commentid="603446" data-postid="4401" data-belowelement="comment-603446" data-respondelement="respond" data-replyto="Reply to Emran" aria-label="Reply to Emran">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-603482" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-603482" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 5, 2021 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-603482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can change the code so 000 to 799 are used for train and 800 onwards are used for test.</p>
<p>Sorry, I don’t have the capacity to review your code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603482" data-commentid="603482" data-postid="4401" data-belowelement="comment-603482" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-603844" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-603844" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/19267b0c4254cc9322570891596c54c7_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/19267b0c4254cc9322570891596c54c7.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Eslam Khodair</span>
	                <span class="date">April 7, 2021 at 12:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-603844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for your clear explanation,<br>
can we use a non-sqaure kernel size for this task?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603844" data-commentid="603844" data-postid="4401" data-belowelement="comment-603844" data-respondelement="respond" data-replyto="Reply to Eslam Khodair" aria-label="Reply to Eslam Khodair">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-603886" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-603886" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 7, 2021 at 5:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-603886" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-603886" data-commentid="603886" data-postid="4401" data-belowelement="comment-603886" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-606991" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-606991" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/636b5c2be40529f57ffcfec5de68dc49.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/636b5c2be40529f57ffcfec5de68dc49_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sona Joseph</span>
	                <span class="date">April 25, 2021 at 8:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-606991" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir,<br>
 Thanks for your great article! We were used this code for classify the 
text of different authors in our college project. It shows the accuracy 
for embedding layer. But in case of word2vec, it does not print any 
accuracy. It shows nan value for loss function. Can you please tell the 
reason for that. It would be a great help for us.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-606991" data-commentid="606991" data-postid="4401" data-belowelement="comment-606991" data-respondelement="respond" data-replyto="Reply to Sona Joseph" aria-label="Reply to Sona Joseph">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-607027" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-607027" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2021 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-607027" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>That sounds like a great project!</p>
<p>Sorry to hear that you are having an error perhaps the tips here will help you debug your code:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/can-you-read-review-or-debug-my-code</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-607027" data-commentid="607027" data-postid="4401" data-belowelement="comment-607027" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608135" class="comment even depth-3 parent">

	      	<div id="li-comment-608135" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/636b5c2be40529f57ffcfec5de68dc49.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/636b5c2be40529f57ffcfec5de68dc49_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sona Joseph</span>
	                <span class="date">May 5, 2021 at 11:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-608135" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much sir for your great help. I will check and reply after that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-608135" data-commentid="608135" data-postid="4401" data-belowelement="comment-608135" data-respondelement="respond" data-replyto="Reply to Sona Joseph" aria-label="Reply to Sona Joseph">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608176" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-608176" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 6, 2021 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-608176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-608176" data-commentid="608176" data-postid="4401" data-belowelement="comment-608176" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-616402" class="comment even depth-5">

	      	<div id="li-comment-616402" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/636b5c2be40529f57ffcfec5de68dc49.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/636b5c2be40529f57ffcfec5de68dc49_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sona Joseph</span>
	                <span class="date">July 13, 2021 at 7:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-616402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sir,<br>
By using the tips that you had given we get 66 accuracy. We had 
classified the text of nine authors. By increasing the number of 
documents, and by some change in hidden layers now it shows 100 for test
 accuracy. Sir my question is, Is that accuracy is an error or is 100 
accuracy is possible for a model? For getting accuracy of train and test
 we had used the same code that you had given above.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-616457" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-616457" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2021 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-616457" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, perhaps this will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/what-does-it-mean-if-i-have-0-error-or-100-accuracy" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/what-does-it-mean-if-i-have-0-error-or-100-accuracy</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-608420" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-608420" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e689e0fa51264067c44c8ed5aca34f1c.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/e689e0fa51264067c44c8ed5aca34f1c_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">May 8, 2021 at 10:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-608420" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this post!</p>
<p>I want to ask you about how we can calculate vocabulary coverage for pre-trained transfer learning models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-608420" data-commentid="608420" data-postid="4401" data-belowelement="comment-608420" data-respondelement="respond" data-replyto="Reply to Ali" aria-label="Reply to Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-608502" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-608502" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2021 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-608502" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure what you mean exactly. Perhaps a count of the words in your vocab vs the words in the existing models vocab?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-608502" data-commentid="608502" data-postid="4401" data-belowelement="comment-608502" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-610470" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-610470" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5dce0e34a3890947359236d2feb490c8_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/5dce0e34a3890947359236d2feb490c8.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">SURAJ TR</span>
	                <span class="date">May 23, 2021 at 7:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-610470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am unable to open the dataset link. Please help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-610470" data-commentid="610470" data-postid="4401" data-belowelement="comment-610470" data-respondelement="respond" data-replyto="Reply to SURAJ TR" aria-label="Reply to SURAJ TR">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-610539" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-610539" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">May 24, 2021 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-610539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can download all of the datasets from here:<br>
<a href="https://github.com/jbrownlee/Datasets" rel="nofollow ugc">https://github.com/jbrownlee/Datasets</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-610539" data-commentid="610539" data-postid="4401" data-belowelement="comment-610539" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-613072" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-613072" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8a23ad91d3eaa472c364f5a5d9f2c6bb.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/8a23ad91d3eaa472c364f5a5d9f2c6bb_002.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Okkes</span>
	                <span class="date">June 13, 2021 at 8:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-613072" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I get the following error:</p>
<p>    ValueError: Input 0 of layer dense is incompatible with the 
layer: expected axis -1 of input shape to have value 342272 but received
 input with shape (None, 49888)</p>
<p>Here is the model summary:<br>
_________________________________________________________________<br>
Layer (type)                 Output Shape              Param #<br>
=================================================================<br>
embedding (Embedding)        (None, 21400, 32)         1912864<br>
_________________________________________________________________<br>
conv1d (Conv1D)              (None, 21393, 32)         8224<br>
_________________________________________________________________<br>
max_pooling1d (MaxPooling1D) (None, 10696, 32)         0<br>
_________________________________________________________________<br>
flatten (Flatten)            (None, 342272)            0<br>
_________________________________________________________________<br>
dense (Dense)                (None, 10)                3422730<br>
_________________________________________________________________<br>
dense_1 (Dense)              (None, 1)                 11<br>
=================================================================<br>
Total params: 5,343,829<br>
Trainable params: 5,343,829<br>
Non-trainable params: 0</p>
<p>What could cause this error? Can you please help me?</p>
<p>Thanks in advance,<br>
OKkes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613072" data-commentid="613072" data-postid="4401" data-belowelement="comment-613072" data-respondelement="respond" data-replyto="Reply to Okkes" aria-label="Reply to Okkes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613110" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-613110" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 14, 2021 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-613110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, perhaps some of these tips will help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613110" data-commentid="613110" data-postid="4401" data-belowelement="comment-613110" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-613247" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-613247" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/88d965888fd2f64e8db1d2aca74490e2_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/88d965888fd2f64e8db1d2aca74490e2.jpeg 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aklilu</span>
	                <span class="date">June 15, 2021 at 7:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-613247" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>please, I have a project, I need help to get a sample code with the title called “text clustering using Deep Learning”.<br>
I have been reading and searching your books and different sites, that 
are related to my topic, but unfortunately, I got mostly what is related
 to text classification only. I couldn’t get samples that may help me 
with my project, </p>
<p>additional question: How develop Word Embedding with CNN to clustering sample datasets?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613247" data-commentid="613247" data-postid="4401" data-belowelement="comment-613247" data-respondelement="respond" data-replyto="Reply to Aklilu" aria-label="Reply to Aklilu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-613302" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-613302" class="comment-container">

					                <div class="avatar"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_003.png" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a0942b56b07831ac15d4a168a750e34a_002.png 2x" class="avatar avatar-40 photo" loading="lazy" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 16, 2021 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#comment-613302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have any examples of text clustering.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-613302" data-commentid="613302" data-postid="4401" data-belowelement="comment-613302" data-respondelement="respond" data-replyto="Reply to Jason Brownlee" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="4401" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="578bc2ae65"></p><textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100" style="display: none !important;"></textarea><input type="hidden" id="ak_js" name="ak_js" value="1632154725419"></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt="" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1d75d46040c28497f0dee5d8e100db37_002.jpeg" srcset="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/1d75d46040c28497f0dee5d8e100db37.jpeg 2x" class="avatar avatar-88 photo" loading="lazy" width="88" height="88"></span>
<p><strong>Welcome!</strong><br>
I'm <em>Jason Brownlee</em> PhD <br>
and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="https://machinelearningmastery.com/about">Read more</a></p>
<div class="fix"></div>
</div><div id="custom_html-89_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 10px; width: 306.333px; height: 68.7px; visibility: hidden;"></div><div id="custom_html-89" class="widget_text widget widget_custom_html" style="top: 10px; width: 306.333px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/small_icon_blue_linkedin3.webp" alt="LinkedIn" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://twitter.com/TeachTheMachine"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/small_icon_blue_twitter3.webp" alt="Twitter" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/small_icon_blue_facebook3.webp" alt="Facebook" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/newsletter/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/small_icon_blue_email3.webp" alt="Email Newsletter" width="30" height="30"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/small_icon_blue_rss3.webp" alt="RSS Feed" width="30" height="30"></a>
</div></div></div><div id="custom_html-30_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 108.7px; width: 306.333px; height: 434.2px; visibility: hidden;"></div><div id="custom_html-30" class="widget_text widget widget_custom_html" style="top: 108.7px; width: 306.333px; position: fixed;"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/example-150x150.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photo of a dog at the beach." loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/" rel="nofollow">How to Develop a Deep Learning Photo Caption Generator from Scratch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Use-Word-Embedding-Layers-for-Deep-Learning-with-Kera.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Use Word Embedding Layers for Deep Learning with Keras" loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" rel="nofollow">How to Use Word Embedding Layers for Deep Learning with Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Neural-Machine-Translation-System-in-Keras-.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop a Neural Machine Translation System in Keras" loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" rel="nofollow">How to Develop a Neural Machine Translation System from Scratch</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Word-Level-Neural-Language-Model-and-Use-it.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop a Word-Level Neural Language Model and Use it to Generate Text" loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-word-level-neural-language-model-in-keras/" rel="nofollow">How to Develop a Word-Level Neural Language Model and Use it to Generate Text</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/"><img src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/How-to-Develop-a-Word-Embedding-Model-for-Predicting-Mov_003.jpg" class="attachment-thumbnail size-thumbnail wp-post-image" alt="How to Develop a Word Embedding Model for Predicting Movie Review Sentiment" loading="lazy" width="150" height="150"></a> <a class="title" href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/" rel="nofollow">Deep Convolutional Neural Network for Sentiment Analysis (Text Classification)</a></div></div></div></div><div id="custom_html-16_clone" class="widget_text widget widget_custom_html q2w3-widget-clone-primary" style="top: 572.9px; width: 306.333px; height: 139.233px; visibility: hidden;"></div><div id="custom_html-16" class="widget_text widget widget_custom_html" style="top: 572.9px; width: 306.333px; position: fixed;"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p></p><h4>Loving the Tutorials?</h4><p></p>

<p>The <a href="https://machinelearningmastery.com/deep-learning-for-nlp/" rel="nofollow">Deep Learning for NLP</a> EBook is <br>where you'll find the <strong><i>Really Good</i></strong> stuff.</p>

<a href="https://machinelearningmastery.com/deep-learning-for-nlp/" class="woo-sc-button  red"><span class="woo-">&gt;&gt; See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2021 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br>
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="https://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="https://machinelearningmastery.com/newsletter/">Newsletter</a> |
<a href="https://machinelearningmastery.com/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap/">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script data-cfasync="false" type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip -->

<script type="text/javascript" id="rocket-browser-checker-js-after">
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var RocketBrowserCompatibilityChecker=function(){function RocketBrowserCompatibilityChecker(options){_classCallCheck(this,RocketBrowserCompatibilityChecker),this.passiveSupported=!1,this._checkPassiveOption(this),this.options=!!this.passiveSupported&&options}return _createClass(RocketBrowserCompatibilityChecker,[{key:"_checkPassiveOption",value:function(self){try{var options={get passive(){return!(self.passiveSupported=!0)}};window.addEventListener("test",null,options),window.removeEventListener("test",null,options)}catch(err){self.passiveSupported=!1}}},{key:"initRequestIdleCallback",value:function(){!1 in window&&(window.requestIdleCallback=function(cb){var start=Date.now();return setTimeout(function(){cb({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-start))}})},1)}),!1 in window&&(window.cancelIdleCallback=function(id){return clearTimeout(id)})}},{key:"isDataSaverModeOn",value:function(){return"connection"in navigator&&!0===navigator.connection.saveData}},{key:"supportsLinkPrefetch",value:function(){var elem=document.createElement("link");return elem.relList&&elem.relList.supports&&elem.relList.supports("prefetch")&&window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype}},{key:"isSlowConnection",value:function(){return"connection"in navigator&&"effectiveType"in navigator.connection&&("2g"===navigator.connection.effectiveType||"slow-2g"===navigator.connection.effectiveType)}}]),RocketBrowserCompatibilityChecker}();
</script>
<script type="text/javascript" id="rocket-delay-js-js-after">
(function() {
"use strict";var e=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function r(e,t){n(this,r),this.attrName="data-rocketlazyloadscript",this.browser=t,this.options=this.browser.options,this.triggerEvents=e,this.userEventListener=this.triggerListener.bind(this)}return e(r,[{key:"init",value:function(){this._addEventListener(this)}},{key:"reset",value:function(){this._removeEventListener(this)}},{key:"_addEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.addEventListener(e,t.userEventListener,t.options)})}},{key:"_removeEventListener",value:function(t){this.triggerEvents.forEach(function(e){return window.removeEventListener(e,t.userEventListener,t.options)})}},{key:"_loadScriptSrc",value:function(){var r=this,e=document.querySelectorAll("script["+this.attrName+"]");0!==e.length&&Array.prototype.slice.call(e).forEach(function(e){var t=e.getAttribute(r.attrName);e.setAttribute("src",t),e.removeAttribute(r.attrName)}),this.reset()}},{key:"triggerListener",value:function(){this._loadScriptSrc(),this._removeEventListener(this)}}],[{key:"run",value:function(){RocketBrowserCompatibilityChecker&&new r(["keydown","mouseover","touchmove","touchstart","wheel"],new RocketBrowserCompatibilityChecker({passive:!0})).init()}}]),r}();t.run();
}());
</script>
<script type="text/javascript" id="rocket-preload-links-js-extra">
/* <![CDATA[ */
var RocketPreloadLinksConfig = {"excludeUris":"\/register\/machine-learning-university\/|\/courses\/\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/|\/courses\/course-get-started\/lessons\/holding-back-goals\/|\/courses\/course-get-started\/lessons\/why-machine-learning-does-not-have-to-be-so-hard\/|\/courses\/course-get-started\/lessons\/how-to-think-about-machine-learning\/|\/courses\/course-get-started\/lessons\/find-your-machine-learning-tribe\/|\/courses\/step-by-step-process\/|\/courses\/probability-for-machine-learning\/|\/account\/|\/register\/|\/courses\/|\/machine-learning-mastery-university-registration\/|\/register\/|\/newsletter\/|\/(.+\/)?feed\/?.+\/?|\/(?:.+\/)?embed\/|\/(index\\.php\/)?wp\\-json(\/.*|$)|\/wp-admin\/|\/logout\/|\/login\/","usesTrailingSlash":"1","imageExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif","fileExt":"jpg|jpeg|gif|png|tiff|bmp|webp|avif|php|pdf|html|htm","siteUrl":"https:\/\/machinelearningmastery.com","onHoverDelay":"100","rateThrottle":"3"};
/* ]]> */
</script>
<script type="text/javascript" id="rocket-preload-links-js-after">
(function() {
"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var t=function(){function n(e,t){i(this,n),this.browser=e,this.config=t,this.options=this.browser.options,this.prefetched=new Set,this.eventTime=null,this.threshold=1111,this.numOnHover=0}return e(n,[{key:"init",value:function(){!this.browser.supportsLinkPrefetch()||this.browser.isDataSaverModeOn()||this.browser.isSlowConnection()||(this.regex={excludeUris:RegExp(this.config.excludeUris,"i"),images:RegExp(".("+this.config.imageExt+")$","i"),fileExt:RegExp(".("+this.config.fileExt+")$","i")},this._initListeners(this))}},{key:"_initListeners",value:function(e){-1<this.config.onHoverDelay&&document.addEventListener("mouseover",e.listener.bind(e),e.listenerOptions),document.addEventListener("mousedown",e.listener.bind(e),e.listenerOptions),document.addEventListener("touchstart",e.listener.bind(e),e.listenerOptions)}},{key:"listener",value:function(e){var t=e.target.closest("a"),n=this._prepareUrl(t);if(null!==n)switch(e.type){case"mousedown":case"touchstart":this._addPrefetchLink(n);break;case"mouseover":this._earlyPrefetch(t,n,"mouseout")}}},{key:"_earlyPrefetch",value:function(t,e,n){var i=this,r=setTimeout(function(){if(r=null,0===i.numOnHover)setTimeout(function(){return i.numOnHover=0},1e3);else if(i.numOnHover>i.config.rateThrottle)return;i.numOnHover++,i._addPrefetchLink(e)},this.config.onHoverDelay);t.addEventListener(n,function e(){t.removeEventListener(n,e,{passive:!0}),null!==r&&(clearTimeout(r),r=null)},{passive:!0})}},{key:"_addPrefetchLink",value:function(i){return this.prefetched.add(i.href),new Promise(function(e,t){var n=document.createElement("link");n.rel="prefetch",n.href=i.href,n.onload=e,n.onerror=t,document.head.appendChild(n)}).catch(function(){})}},{key:"_prepareUrl",value:function(e){if(null===e||"object"!==(void 0===e?"undefined":r(e))||!1 in e||-1===["http:","https:"].indexOf(e.protocol))return null;var t=e.href.substring(0,this.config.siteUrl.length),n=this._getPathname(e.href,t),i={original:e.href,protocol:e.protocol,origin:t,pathname:n,href:t+n};return this._isLinkOk(i)?i:null}},{key:"_getPathname",value:function(e,t){var n=t?e.substring(this.config.siteUrl.length):e;return n.startsWith("/")||(n="/"+n),this._shouldAddTrailingSlash(n)?n+"/":n}},{key:"_shouldAddTrailingSlash",value:function(e){return this.config.usesTrailingSlash&&!e.endsWith("/")&&!this.regex.fileExt.test(e)}},{key:"_isLinkOk",value:function(e){return null!==e&&"object"===(void 0===e?"undefined":r(e))&&(!this.prefetched.has(e.href)&&e.origin===this.config.siteUrl&&-1===e.href.indexOf("?")&&-1===e.href.indexOf("#")&&!this.regex.excludeUris.test(e.href)&&!this.regex.images.test(e.href))}}],[{key:"run",value:function(){"undefined"!=typeof RocketPreloadLinksConfig&&new n(new RocketBrowserCompatibilityChecker({capture:!0,passive:!0}),RocketPreloadLinksConfig).init()}}]),n}();t.run();
}());
</script>



<script type="text/javascript">window.lazyLoadOptions={elements_selector:"iframe[data-lazy-src]",data_src:"lazy-src",data_srcset:"lazy-srcset",data_sizes:"lazy-sizes",class_loading:"lazyloading",class_loaded:"lazyloaded",threshold:300,callback_loaded:function(element){if(element.tagName==="IFRAME"&&element.dataset.rocketLazyload=="fitvidscompatible"){if(element.classList.contains("lazyloaded")){if(typeof window.jQuery!="undefined"){if(jQuery.fn.fitVids){jQuery(element).parent().fitVids()}}}}}};window.addEventListener('LazyLoad::Initialized',function(e){var lazyLoadInstance=e.detail.instance;if(window.MutationObserver){var observer=new MutationObserver(function(mutations){var image_count=0;var iframe_count=0;var rocketlazy_count=0;mutations.forEach(function(mutation){for(i=0;i<mutation.addedNodes.length;i++){if(typeof mutation.addedNodes[i].getElementsByTagName!=='function'){continue}
if(typeof mutation.addedNodes[i].getElementsByClassName!=='function'){continue}
images=mutation.addedNodes[i].getElementsByTagName('img');is_image=mutation.addedNodes[i].tagName=="IMG";iframes=mutation.addedNodes[i].getElementsByTagName('iframe');is_iframe=mutation.addedNodes[i].tagName=="IFRAME";rocket_lazy=mutation.addedNodes[i].getElementsByClassName('rocket-lazyload');image_count+=images.length;iframe_count+=iframes.length;rocketlazy_count+=rocket_lazy.length;if(is_image){image_count+=1}
if(is_iframe){iframe_count+=1}}});if(image_count>0||iframe_count>0||rocketlazy_count>0){lazyLoadInstance.update()}});var b=document.getElementsByTagName("body")[0];var config={childList:!0,subtree:!0};observer.observe(b,config)}},!1)</script><script async="" data-no-minify="1" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/lazyload.js" type="text/javascript"></script><script src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/3ddf854585a3f3a3c4042a094a6999be.js" data-minify="1" defer="defer" type="text/javascript"></script>

<div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab bottom right no-image classic">
    <div id="drip-header-2211" class="drip-header">
      <a href="#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Start Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -617px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Start Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
              
            </div>
            <dl class="no-labels">
                  <dt class="label-for-type-email">
    Email Address
      <span title="Required"> *</span>
  </dt>
  <dd>
    <input type="email" name="fields[email]" placeholder="Email Address" class="drip-text-field" id="drip-email-field-2211" tabindex="0">
<div id="drip-errors-for-email-2211" class="drip-errors"></div>

  </dd>

                  <dt class="label-for-type-eu_consent">
    
  </dt>
  <dd>
      <div class="classic--checkbox" data-container="eu-checkbox">
    <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-2211-denied" value="denied">
    <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent-2211" value="granted">
    <label for="drip-field-eu_consent-2211">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
  </div>

  </dd>

                <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/)." tabindex="-1">

              <div style="display: none;" aria-hidden="true">
  <dt for="website">Website</dt>
  <dd>
    <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false">
  </dd>
</div>

            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
            <div id="drip-errors-for-base-2211" class="drip-errors dfwid-error"></div>

          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix drip-form-success-message" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>
    </div>
  </div>
</div><div style="position: absolute; inset: 0px; z-index: 2147483646; background: black none repeat scroll 0% 0%; width: 100%; opacity: 0.5; display: none; height: 84679px;"></div><iframe src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/a.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: medium none; z-index: 2147483647; height: 898px;"></iframe><iframe scrolling="no" allowtransparency="true" src="Deep%20Convolutional%20Neural%20Network%20for%20Sentiment%20Analysis%20(Text%20Classification)_fichiers/widget_iframe.html" title="Twitter settings iframe" style="display: none;" frameborder="0"></iframe><iframe id="rufous-sandbox" scrolling="no" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: medium none;" title="Twitter analytics iframe" frameborder="0"></iframe></body></html>
<!-- This website is like a Rocket, isn't it? Performance optimized by WP Rocket. Learn more: https://wp-rocket.me -->